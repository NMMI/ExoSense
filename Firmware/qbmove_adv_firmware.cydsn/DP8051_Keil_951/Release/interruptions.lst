C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE INTERRUPTIONS
OBJECT MODULE PLACED IN .\DP8051_Keil_951\Release\interruptions.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\3.3\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -.\interruptions.c NOIV LARGE MODDP2 OMF2 VB(1) NOIP INCDIR(.,Generated_Source\PSoC3) FF(3) DB DF(NDEBUG) WL(2) PR(.\DP80
                    -51_Keil_951\Release/interruptions.lst) CD OT(8,SPEED) OJ(.\DP8051_Keil_951\Release\interruptions.obj)

line level    source

*** MESSAGE C286 IN LINE 0 OF (null): license limits optimization to level 5
   1          // ----------------------------------------------------------------------------
   2          // BSD 3-Clause License
   3          
   4          // Copyright (c) 2016, qbrobotics
   5          // Copyright (c) 2017, Centro "E.Piaggio"
   6          // All rights reserved.
   7          
   8          // Redistribution and use in source and binary forms, with or without
   9          // modification, are permitted provided that the following conditions are met:
  10          
  11          // * Redistributions of source code must retain the above copyright notice, this
  12          //   list of conditions and the following disclaimer.
  13          
  14          // * Redistributions in binary form must reproduce the above copyright notice,
  15          //   this list of conditions and the following disclaimer in the documentation
  16          //   and/or other materials provided with the distribution.
  17          
  18          // * Neither the name of the copyright holder nor the names of its
  19          //   contributors may be used to endorse or promote products derived from
  20          //   this software without specific prior written permission.
  21          
  22          // THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  23          // AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  24          // IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  25          // DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
  26          // FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  27          // DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
  28          // SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
  29          // CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  30          // OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  31          // OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  32          // POSSIBILITY OF SUCH DAMAGE.
  33          // ----------------------------------------------------------------------------
  34          /**
  35          * \file         interruptions.c
  36          *
  37          * \brief        Interruption functions are in this file.
  38          * \date         May 13, 2015
  39          * \author       qbrobotics
  40          * \copyright    (C) 2012-2016 qbrobotics. All rights reserved.
  41          * \copyright    (C) 2017 Centro "E.Piaggio". All rights reserved.
  42          */
  43          
  44          
  45          //=================================================================     includes
  46          #include <interruptions.h>
  47          #include <command_processing.h>
  48          
  49          #include "globals.h"
  50          #include "utils.h"
  51          
  52          //==============================================================================
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 2   

  53          //                                                            WATCHDOG INTERRUPT
  54          //==============================================================================
  55          
  56          CY_ISR(ISR_WATCHDOG_Handler){
  57   1      
  58   1          // Set WDT flag
  59   1          
  60   1          watchdog_flag = TRUE;
  61   1      
  62   1      }
  63          
  64          //==============================================================================
  65          //                                                            RS485 RX INTERRUPT
  66          //==============================================================================
  67          
  68          CY_ISR(ISR_RS485_RX_ExInterrupt) {
  69   1      
  70   1          // Set RS485 flag
  71   1          
  72   1          interrupt_flag = TRUE;
  73   1           
  74   1      }
  75          
  76          //==============================================================================
  77          //                                                             INTERRUPT MANAGER
  78          //==============================================================================
  79          // Manage interrupt from RS485 
  80          //==============================================================================
  81          // Processing RS-485 data frame:
  82          //
  83          // - WAIT_START:    Waits for beginning characters;
  84          // - WAIT_ID:       Waits for ID;
  85          // - WAIT_LENGTH:   Data length;
  86          // - RECEIVE:       Receive all bytes;
  87          // - UNLOAD:        Wait for another device end of transmission;
  88          //
  89          //==============================================================================
  90          
  91          void interrupt_manager(){
  92   1          
  93   1          //===========================================     local variables definition
  94   1      
  95   1          static uint8 CYDATA state = WAIT_START;                      // state
  96   1          
  97   1          //------------------------------------------------- local data packet
  98   1          static uint8 CYDATA data_packet_index;
  99   1          static uint8 CYDATA data_packet_length;
 100   1          static uint8 data_packet_buffer[128];                     
 101   1          static uint8 CYDATA rx_queue[3];                    // last 2 bytes received
 102   1          //-------------------------------------------------
 103   1      
 104   1          uint8 CYDATA    rx_data;                            // RS485 UART rx data
 105   1          CYBIT           rx_data_type;                       // my id?
 106   1          uint8 CYDATA    package_count = 0;                     
 107   1      
 108   1          //======================================================     receive routine
 109   1          
 110   1          // Get data until buffer is not empty 
 111   1          
 112   1          while(UART_RS485_GetRxBufferSize() && (package_count < 6)){  
 113   2              // 6 stima di numero massimo di pacchetti che riesco a leggere senza bloccare l'esecuzione del fir
             -mware
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 3   

 114   2              
 115   2              // Get next char
 116   2              rx_data = UART_RS485_GetChar();
 117   2              
 118   2              switch (state) {
 119   3                  //-----     wait for frame start     -------------------------------
 120   3                  case WAIT_START:
 121   3                  
 122   3                      rx_queue[0] = rx_queue[1];
 123   3                      rx_queue[1] = rx_queue[2];
 124   3                      rx_queue[2] = rx_data;
 125   3                      
 126   3                      // Check for header configuration package
 127   3                      if ((rx_queue[1] == 58) && (rx_queue[2] == 58)) {
 128   4                          rx_queue[0] = 0;
 129   4                          rx_queue[1] = 0;
 130   4                          rx_queue[2] = 0;
 131   4                          state       = WAIT_ID;                    
 132   4                      }else
 133   3                          if ((rx_queue[0] == 63) &&      //ASCII - ?
 134   3                              (rx_queue[1] == 13) &&      //ASCII - CR
 135   3                              (rx_queue[2] == 10))        //ASCII - LF)
 136   3                              infoGet(INFO_ALL);
 137   3                      break;
 138   3      
 139   3                  //-----     wait for id     ----------------------------------------
 140   3                  case  WAIT_ID:
 141   3      
 142   3                      // packet is for my ID or is broadcast
 143   3                      if (rx_data == c_mem.id || rx_data == 0)
 144   3                          rx_data_type = FALSE;
 145   3                      else                //packet is for others
 146   3                          rx_data_type = TRUE;
 147   3                      
 148   3                      data_packet_length = 0;
 149   3                      state = WAIT_LENGTH;
 150   3                      break;
 151   3      
 152   3                  //-----     wait for length     ------------------------------------
 153   3                  case  WAIT_LENGTH:
 154   3      
 155   3       
 156   3                      data_packet_length = rx_data;
 157   3                      // check validity of pack length
 158   3                      if (data_packet_length <= 1) {
 159   4                          data_packet_length = 0;
 160   4                          state = WAIT_START;
 161   4                      } else if (data_packet_length > 128) {
 162   4                          data_packet_length = 0;
 163   4                          state = WAIT_START;
 164   4                      } else {
 165   4                          data_packet_index = 0;
 166   4                          
 167   4                          if(rx_data_type == FALSE)
 168   4                              state = RECEIVE;          // packet for me or broadcast
 169   4                          else
 170   4                              state = UNLOAD;           // packet for others
 171   4                      }
 172   3                      break;
 173   3      
 174   3                  //-----     receiving     -------------------------------------------
 175   3                  case RECEIVE:
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 4   

 176   3      
 177   3                      data_packet_buffer[data_packet_index] = rx_data;
 178   3                      data_packet_index++;
 179   3                      
 180   3                      // check end of transmission
 181   3                      if (data_packet_index >= data_packet_length) {
 182   4                          // verify if frame ID corresponded to the device ID
 183   4                          if (rx_data_type == FALSE) {
 184   5                              // copying data from buffer to global packet
 185   5                              memcpy(g_rx.buffer, data_packet_buffer, data_packet_length);
 186   5                              g_rx.length = data_packet_length;
 187   5                              g_rx.ready  = 1;
 188   5                              commProcess();
 189   5                          }
 190   4                          
 191   4                          data_packet_index  = 0;
 192   4                          data_packet_length = 0;
 193   4                          state              = WAIT_START;
 194   4                          package_count++;
 195   4                      
 196   4                      }
 197   3                      break;
 198   3      
 199   3                  //-----     other device is receving     ---------------------------
 200   3                  case UNLOAD:
 201   3                      if (!(--data_packet_length)) {
 202   4                          data_packet_index  = 0;
 203   4                          data_packet_length = 0;
 204   4                          RS485_CTS_Write(1);
 205   4                          RS485_CTS_Write(0);
 206   4                          state              = WAIT_START;
 207   4                          package_count++;
 208   4                      }
 209   3                      break;
 210   3              }
 211   2          }
 212   1      }
 213          //==============================================================================
 214          //                                                            FUNCTION SCHEDULER
 215          //==============================================================================
 216          // Call all the function with the right frequency
 217          //==============================================================================
 218          // Base frequency 1000 Hz
 219          //==============================================================================
 220          
 221          void function_scheduler(void) {
 222   1      
 223   1          static uint16 counter_calibration = DIV_INIT_VALUE;
 224   1      
 225   1          timer_value0 = (uint32)MY_TIMER_ReadCounter();
 226   1      
 227   1          // Start ADC Conversion, SOC = 1
 228   1      
 229   1          ADC_SOC_Write(0x01); 
 230   1          
 231   1          // Check Interrupt 
 232   1      
 233   1          if (interrupt_flag){
 234   2              interrupt_flag = FALSE;
 235   2              interrupt_manager();
 236   2          }
 237   1        
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 5   

 238   1          //---------------------------------- Get Encoders
 239   1      
 240   1          encoder_reading(0); 
 241   1          
 242   1          // Check Interrupt     
 243   1          
 244   1          if (interrupt_flag){
 245   2              interrupt_flag = FALSE;
 246   2              interrupt_manager();
 247   2          }   
 248   1          
 249   1          encoder_reading(1);
 250   1          
 251   1          // Check Interrupt 
 252   1          
 253   1          if (interrupt_flag){
 254   2              interrupt_flag = FALSE;
 255   2              interrupt_manager();
 256   2          }
 257   1          
 258   1          encoder_reading(2);
 259   1          
 260   1          // Check Interrupt 
 261   1          
 262   1          if (interrupt_flag){
 263   2              interrupt_flag = FALSE;
 264   2              interrupt_manager();
 265   2          }
 266   1      
 267   1          encoder_reading(3);
 268   1          
 269   1          // Check Interrupt 
 270   1          
 271   1          if (interrupt_flag){
 272   2              interrupt_flag = FALSE;
 273   2              interrupt_manager();
 274   2          }
 275   1          
 276   1          encoder_reading(4);
 277   1          
 278   1          // Check Interrupt 
 279   1          
 280   1          if (interrupt_flag){
 281   2              interrupt_flag = FALSE;
 282   2              interrupt_manager();
 283   2          }
 284   1          
 285   1          encoder_reading(5);
 286   1          
 287   1          // Check Interrupt 
 288   1          
 289   1          if (interrupt_flag){
 290   2              interrupt_flag = FALSE;
 291   2              interrupt_manager();
 292   2          }
 293   1          
 294   1          //---------------------------------- Control Motors
 295   1          
 296   1          motor_control(0);
 297   1      
 298   1          // Check Interrupt 
 299   1      
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 6   

 300   1          if (interrupt_flag){
 301   2              interrupt_flag = FALSE;
 302   2              interrupt_manager();
 303   2          }
 304   1          
 305   1          motor_control(1);
 306   1          
 307   1          // Check Interrupt 
 308   1          
 309   1          if (interrupt_flag){
 310   2              interrupt_flag = FALSE;
 311   2              interrupt_manager();
 312   2          }
 313   1      
 314   1          //---------------------------------- Read conversion buffer - LOCK function
 315   1      
 316   1          analog_read_end();
 317   1      
 318   1          //---------------------------------- Calibration 
 319   1      
 320   1          // Divider 100, freq = 10 Hz
 321   1          if (!(calibration_flag == STOP)) {
 322   2              if (counter_calibration == CALIBRATION_DIV) {
 323   3                  calibration();
 324   3                  counter_calibration = 0;
 325   3              }
 326   2              counter_calibration++;
 327   2          }
 328   1          // Check Interrupt 
 329   1          
 330   1          if (interrupt_flag){
 331   2              interrupt_flag = FALSE;
 332   2              interrupt_manager();
 333   2          }
 334   1         
 335   1          //---------------------------------- Update States
 336   1          
 337   1          // Load k-1 state
 338   1          memcpy( &g_measOld, &g_meas, sizeof(g_meas) );
 339   1          memcpy( &g_refOld, &g_ref, sizeof(g_ref) );
 340   1      
 341   1          // Load k+1 state
 342   1          memcpy( &g_ref, &g_refNew, sizeof(g_ref) );
 343   1      
 344   1          if (interrupt_flag){
 345   2              interrupt_flag = FALSE;
 346   2              interrupt_manager();
 347   2          }
 348   1      
 349   1          timer_value = (uint32)MY_TIMER_ReadCounter();
 350   1          MY_TIMER_WriteCounter(5000000);
 351   1      }
 352          
 353          
 354          //==============================================================================
 355          //                                                                MOTORS CONTROL
 356          //==============================================================================
 357          
 358          void motor_control(const uint8 idx) {
 359   1      
 360   1          uint8 CYDATA index = idx;
 361   1      
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 7   

 362   1          int32 CYDATA curr_ref;
 363   1      
 364   1          int32 CYDATA pwm_input = 0;
 365   1      
 366   1          int32 CYDATA pos_error;
 367   1          int32 CYDATA curr_error;
 368   1          int32 CYDATA defl_input[NUM_OF_MOTORS];
 369   1      
 370   1          int32 CYDATA k_p = c_mem.k_p;  
 371   1          int32 CYDATA k_i = c_mem.k_i; 
 372   1          int32 CYDATA k_d = c_mem.k_d; 
 373   1      
 374   1          int32 CYDATA k_p_c = c_mem.k_p_c;  
 375   1          int32 CYDATA k_i_c = c_mem.k_i_c; 
 376   1          int32 CYDATA k_d_c = c_mem.k_d_c; 
 377   1      
 378   1          int32 CYDATA k_p_dl = c_mem.k_p_dl;  
 379   1          int32 CYDATA k_i_dl = c_mem.k_i_dl; 
 380   1          int32 CYDATA k_d_dl = c_mem.k_d_dl; 
 381   1      
 382   1          int32 CYDATA k_p_c_dl = c_mem.k_p_c_dl;  
 383   1          int32 CYDATA k_i_c_dl = c_mem.k_i_c_dl; 
 384   1          int32 CYDATA k_d_c_dl = c_mem.k_d_c_dl; 
 385   1      
 386   1          static CYBIT dirM0, dirM1;
 387   1      
 388   1          static int32 pos_error_sum[NUM_OF_MOTORS];
 389   1          static int32 curr_error_sum[NUM_OF_MOTORS];
 390   1          static int32 prev_curr_err[NUM_OF_MOTORS];
 391   1      
 392   1          // check index value
 393   1          if (index >= NUM_OF_MOTORS)
 394   1              return;
 395   1          // --------------- USE THIRD ENCODER AS INPUT FOR BOTH MOTORS --------------
 396   1          if (c_mem.input_mode == INPUT_MODE_ENCODER3) {
 397   2      
 398   2              g_ref.pos[index] = g_measOld.pos[2];
 399   2      
 400   2              // position limit
 401   2              if (c_mem.pos_lim_flag) {
 402   3                  if (g_ref.pos[index] < c_mem.pos_lim_inf[index]) 
 403   3                      g_ref.pos[index] = c_mem.pos_lim_inf[index];
 404   3                  if (g_ref.pos[index] > c_mem.pos_lim_sup[index]) 
 405   3                      g_ref.pos[index] = c_mem.pos_lim_sup[index];
 406   3              }
 407   2          }
 408   1      
 409   1          switch(c_mem.control_mode) {
 410   2              case CONTROL_ANGLE:
 411   2              case DEFLECTION_CONTROL:
 412   2              
 413   2                  if(c_mem.control_mode == DEFLECTION_CONTROL){
 414   3                                      //for deflection control the shaft position must be summed to reference
 415   3                                      //but the qbmove_adv has the shaft position with the opposite sign in relation
 416   3                                      //to the motors one.
 417   3                      defl_input[index] = -(g_ref.pos[index] - g_meas.pos[2]);
 418   3                      pos_error = defl_input[index] - g_meas.pos[index];
 419   3                  }
 420   2                  else 
 421   2                      // position error
 422   2                      pos_error = g_ref.pos[index] - g_meas.pos[index]; //g_ref.pos[index] 
 423   2         
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 8   

 424   2                  // error sum for integral
 425   2                  pos_error_sum[index] += pos_error;
 426   2      
 427   2                  if (interrupt_flag){
 428   3                      interrupt_flag = FALSE;
 429   3                      interrupt_manager();
 430   3                  }
 431   2      
 432   2                  //anti wind-up
 433   2                  if (pos_error_sum[index] > POS_INTEGRAL_SAT_LIMIT)
 434   2                      pos_error_sum[index] = POS_INTEGRAL_SAT_LIMIT;
 435   2                  else{
 436   3                      if (pos_error_sum[index] < -POS_INTEGRAL_SAT_LIMIT)
 437   3                          pos_error_sum[index] = -POS_INTEGRAL_SAT_LIMIT;
 438   3                  }
 439   2                    
 440   2                  if (interrupt_flag){
 441   3                      interrupt_flag = FALSE;
 442   3                      interrupt_manager();
 443   3                  }
 444   2                  // pwm_input init
 445   2                  pwm_input = 0;
 446   2                  // Proportional
 447   2                  if (k_p != 0) {
 448   3                          
 449   3                      if ((pos_error > 131072) || (pos_error < -131072))  //if grater than 2^17
 450   3                          pwm_input = (int32)(k_p * (pos_error >> 8)) >> 8;
 451   3                      else
 452   3                          pwm_input = (int32)(k_p * pos_error) >> 16;
 453   3                  }
 454   2                  
 455   2                  if (interrupt_flag){
 456   3                      interrupt_flag = FALSE;
 457   3                      interrupt_manager();
 458   3                  }
 459   2                            
 460   2                  // Integral
 461   2                  if (k_i != 0) 
 462   2                      pwm_input += (int32)((k_i >> 6) * pos_error_sum[index]) >> 10;
 463   2                  
 464   2                  // Derivative
 465   2                  if (k_d != 0)
 466   2                      pwm_input += (int32)(k_d * (g_measOld.pos[index] - g_meas.pos[index])) >> 16;
 467   2               
 468   2          
 469   2                  if (interrupt_flag){
 470   3                      interrupt_flag = FALSE;
 471   3                      interrupt_manager();
 472   3                  }
 473   2      
 474   2                  if (index == 0){
 475   3                      if (pwm_input >= 0)
 476   3                          dirM0 = 1;
 477   3                          //direction |= 0x01;
 478   3                      else
 479   3                          dirM0 = 0;
 480   3                          //direction &= 0xFE;
 481   3                  }else{ // index == 1
 482   3                      if (pwm_input >= 0)
 483   3                          dirM1 = 1;
 484   3                         // direction |= 0x02;
 485   3                      else
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 9   

 486   3                          dirM1 = 0;
 487   3                          //direction &= 0xFD;
 488   3                  }
 489   2                  
 490   2                  break;
 491   2      
 492   2              case CURR_AND_POS_CONTROL:
 493   2              case DEFL_CURRENT_CONTROL:
 494   2      
 495   2                  if(c_mem.control_mode == DEFL_CURRENT_CONTROL){
 496   3                      //for deflection control the shaft position must be summed to reference
 497   3                      //but the qbmove_adv has the shaft position with the opposite sign in relation
 498   3                      //to the motors one.
 499   3                      defl_input[index] = -(g_ref.pos[index] - g_meas.pos[2]);
 500   3                      pos_error = defl_input[index] - g_meas.pos[index];
 501   3                  }
 502   2                  else 
 503   2                      pos_error = g_ref.pos[index] - g_meas.pos[index];
 504   2         
 505   2                  if (interrupt_flag){
 506   3                      interrupt_flag = FALSE;
 507   3                      interrupt_manager();
 508   3                  }
 509   2      
 510   2                  pos_error_sum[index] += pos_error;
 511   2      
 512   2                  if (pos_error_sum[index] > POS_INTEGRAL_SAT_LIMIT)
 513   2                      pos_error_sum[index] = POS_INTEGRAL_SAT_LIMIT;
 514   2                  else{
 515   3                      if (pos_error_sum[index] < -POS_INTEGRAL_SAT_LIMIT)
 516   3                          pos_error_sum[index] = -POS_INTEGRAL_SAT_LIMIT;
 517   3                  }
 518   2      
 519   2                  // ------ position PID control -----
 520   2      
 521   2                  curr_ref = 0;
 522   2      
 523   2                  // Proportional
 524   2                  if (k_p_dl != 0) {
 525   3                      if ((pos_error > 131072) || (pos_error < -131072))
 526   3                          curr_ref += (int32)(k_p_dl * (pos_error >> 8)) >> 8;
 527   3                      else
 528   3                          curr_ref += (int32)(k_p_dl * pos_error) >> 16;
 529   3                  }
 530   2      
 531   2                  // Integral
 532   2                  if (k_i_dl != 0)
 533   2                      curr_ref += (int32)(k_i_dl * pos_error_sum[index]) >> 16;
 534   2                  
 535   2                  // Derivative
 536   2                  if (k_d_dl != 0)
 537   2                      curr_ref += (int32)(k_d_dl * (g_measOld.pos[index] - g_meas.pos[index])) >> 16;
 538   2               
 539   2                  if (interrupt_flag){
 540   3                      interrupt_flag = FALSE;
 541   3                      interrupt_manager();
 542   3                  }
 543   2      
 544   2                  // saturate max current
 545   2                  if (curr_ref > c_mem.current_limit)
 546   2                      curr_ref = c_mem.current_limit;
 547   2                  else {
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 10  

 548   3                      if (curr_ref < -c_mem.current_limit)
 549   3                          curr_ref = -c_mem.current_limit;
 550   3                  }
 551   2      
 552   2                  // current error and error sum
 553   2                  curr_error = curr_ref - g_meas.curr[index];
 554   2                  curr_error_sum[index] += curr_error;
 555   2      
 556   2                  if (curr_error_sum[index] > CURR_INTEGRAL_SAT_LIMIT)
 557   2                      curr_error_sum[index] = CURR_INTEGRAL_SAT_LIMIT;
 558   2                  else{
 559   3                      if (curr_error_sum[index] < -CURR_INTEGRAL_SAT_LIMIT)
 560   3                          curr_error_sum[index] = -CURR_INTEGRAL_SAT_LIMIT;
 561   3                  }
 562   2      
 563   2                  if (interrupt_flag){
 564   3                      interrupt_flag = FALSE;
 565   3                      interrupt_manager();
 566   3                  }
 567   2      
 568   2                  // ----- current PID control -----
 569   2      
 570   2                  pwm_input = 0;
 571   2      
 572   2                  // Proportional
 573   2                  if (k_p_c_dl != 0)
 574   2                      pwm_input += (int32)(k_p_c_dl * curr_error) >> 16;
 575   2                  
 576   2                  // Integral
 577   2                  if (k_i_c_dl != 0)
 578   2                      pwm_input += (int32)(k_i_c_dl * curr_error_sum[index]) >> 16;
 579   2                  
 580   2                  // Derivative
 581   2                  if (k_d_c_dl != 0)
 582   2                      pwm_input += (int32)(k_d_c_dl * (g_measOld.curr[index] - g_meas.curr[index])) >> 16;
 583   2      
 584   2                  if (interrupt_flag){
 585   3                      interrupt_flag = FALSE;
 586   3                      interrupt_manager();
 587   3                  }           
 588   2      
 589   2      
 590   2                  if (index == 0) {
 591   3                      if (pwm_input >= 0)
 592   3                          dirM0 = 1;
 593   3                          //direction |= 0x01;
 594   3                      else
 595   3                          dirM0 = 0;
 596   3                          //direction &= 0xFE;
 597   3                  }
 598   2                  else { // index == 1
 599   3                      if (pwm_input >= 0)
 600   3                          dirM1 = 1;
 601   3                         // direction |= 0x02;
 602   3                      else
 603   3                          dirM1 = 0;
 604   3                          //direction &= 0xFD;
 605   3                  }
 606   2      
 607   2                  if (interrupt_flag){
 608   3                      interrupt_flag = FALSE;
 609   3                      interrupt_manager();
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 11  

 610   3                  } 
 611   2      
 612   2                  // pwm_input saturation
 613   2                  if (pwm_input < -PWM_MAX_VALUE)
 614   2                      pwm_input = -PWM_MAX_VALUE;
 615   2                  else{
 616   3                      if (pwm_input > PWM_MAX_VALUE)
 617   3                          pwm_input = PWM_MAX_VALUE;
 618   3                  }
 619   2      
 620   2                  break;
 621   2      
 622   2              case CONTROL_CURRENT:
 623   2      
 624   2                  if(g_ref.onoff && tension_valid) {
 625   3      
 626   3                      // Current ref from pos ref
 627   3                      curr_ref = g_ref.curr[index];
 628   3      
 629   3                      // saturate max current
 630   3                      if (curr_ref > c_mem.current_limit) {
 631   4                          curr_ref = c_mem.current_limit;
 632   4                      }
 633   3                      else {
 634   4                          if (curr_ref < -c_mem.current_limit)
 635   4                              curr_ref = -c_mem.current_limit;
 636   4                      }
 637   3      
 638   3                      if (interrupt_flag){
 639   4                          interrupt_flag = FALSE;
 640   4                          interrupt_manager();
 641   4                      }
 642   3      
 643   3                      // Current error
 644   3                      curr_error = (curr_ref) - g_meas.curr[index];
 645   3      
 646   3                      // Error sum for integral
 647   3                      curr_error_sum[index] += curr_error;
 648   3      
 649   3                      //anti wind-up
 650   3                      if (curr_error_sum[index] > CURR_INTEGRAL_SAT_LIMIT) {
 651   4                          curr_error_sum[index] = CURR_INTEGRAL_SAT_LIMIT;
 652   4                      } 
 653   3                      else {
 654   4                          if (curr_error_sum[index] < -CURR_INTEGRAL_SAT_LIMIT) 
 655   4                              curr_error_sum[index] = -CURR_INTEGRAL_SAT_LIMIT;
 656   4                      }
 657   3      
 658   3                      if (interrupt_flag){
 659   4                          interrupt_flag = FALSE;
 660   4                          interrupt_manager();
 661   4                      }
 662   3      
 663   3                      // pwm_input init
 664   3                      pwm_input = 0;
 665   3      
 666   3                      // Proportional
 667   3                      if (k_p_c != 0)
 668   3                          pwm_input += (int32)(k_p_c * curr_error) >> 16;
 669   3      
 670   3                      // Integral
 671   3                      if (k_i_c != 0)
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 12  

 672   3                          pwm_input += (int32)(k_i_c * (curr_error_sum[index] >> 6)) >> 10;
 673   3      
 674   3                      // Derivative
 675   3                      if (k_d_c != 0)
 676   3                          pwm_input += (int32)(k_d_c * (curr_error - prev_curr_err[index])) >> 16;
 677   3                      
 678   3                      if (interrupt_flag){
 679   4                          interrupt_flag = FALSE;
 680   4                          interrupt_manager();
 681   4                      }
 682   3      
 683   3                      // Update measure
 684   3                      prev_curr_err[index] = curr_error;
 685   3      
 686   3                      if (index == 0) {
 687   4                          if (pwm_input >= 0)
 688   4                              dirM0 = 1;
 689   4                              //direction |= 0x01;
 690   4                          else
 691   4                              dirM0 = 0;
 692   4                              //direction &= 0xFE;
 693   4                      }
 694   3                      else { // index == 1
 695   4                          if (pwm_input >= 0)
 696   4                              dirM1 = 1;
 697   4                             // direction |= 0x02;
 698   4                          else
 699   4                              dirM1 = 0;
 700   4                              //direction &= 0xFD;
 701   4                      }
 702   3      
 703   3                      if (interrupt_flag){
 704   4                          interrupt_flag = FALSE;
 705   4                          interrupt_manager();
 706   4                      }
 707   3                  }
 708   2      
 709   2                  break;
 710   2      
 711   2              case CONTROL_PWM:
 712   2                  // Direct PWM value
 713   2                  pwm_input = g_ref.pwm[index];
 714   2      
 715   2      
 716   2                  if (index == 0){
 717   3                      if (pwm_input >= 0)
 718   3                          dirM0 = 1;
 719   3                          //direction |= 0x01;
 720   3                      else
 721   3                          dirM0 = 0;
 722   3                          //direction &= 0xFE;
 723   3                  }
 724   2                  else { // index == 1
 725   3                      if (pwm_input >= 0)
 726   3                          dirM1 = 1;
 727   3                         // direction |= 0x02;
 728   3                      else
 729   3                          dirM1 = 0;
 730   3                          //direction &= 0xFD;
 731   3                  }
 732   2      
 733   2                  break;
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 13  

 734   2              default:
 735   2                  break;
 736   2          }
 737   1      
 738   1          if (interrupt_flag){
 739   2              interrupt_flag = FALSE;
 740   2              interrupt_manager();
 741   2          }
 742   1              
 743   1          // abs(pwm_input) must be lower or equal to PWM_MAX_VALUE
 744   1          if(pwm_input >  PWM_MAX_VALUE) 
 745   1              pwm_input =  PWM_MAX_VALUE;
 746   1          if(pwm_input < -PWM_MAX_VALUE) 
 747   1              pwm_input = -PWM_MAX_VALUE;
 748   1          
 749   1          if (interrupt_flag){
 750   2              interrupt_flag = FALSE;
 751   2              interrupt_manager();
 752   2          }   
 753   1      
 754   1          // remap pwm_input on pwm_limit based on input tension to have maximum 8 volts
 755   1          if (c_mem.control_mode != CONTROL_PWM)
 756   1              pwm_input = (((pwm_input << 10) / PWM_MAX_VALUE) * dev_pwm_limit) >> 10;
 757   1      
 758   1          // drive direction and pwm duty cycle
 759   1      
 760   1          if (dirM0){
 761   2              if (dirM1)
 762   2                  MOTOR_DIR_Write(0x03);
 763   2              else
 764   2                  MOTOR_DIR_Write(0x01);
 765   2          }
 766   1          else{
 767   2              if (dirM1)
 768   2                  MOTOR_DIR_Write(0x02);
 769   2              else
 770   2                  MOTOR_DIR_Write(0x00);
 771   2          }
 772   1      
 773   1          if (interrupt_flag){
 774   2              interrupt_flag = FALSE;
 775   2              interrupt_manager();
 776   2          }
 777   1          
 778   1          if (index == 0) {
 779   2              pwm_sign[0] = SIGN(pwm_input);
 780   2              PWM_MOTORS_WriteCompare1(abs(pwm_input));
 781   2          }
 782   1          else { // index == 1
 783   2              pwm_sign[1] = SIGN(pwm_input);
 784   2              PWM_MOTORS_WriteCompare2(abs(pwm_input));
 785   2          }
 786   1      
 787   1          if (interrupt_flag){
 788   2              interrupt_flag = FALSE;
 789   2              interrupt_manager();
 790   2          }
 791   1      }
 792          
 793          //==============================================================================
 794          //                                                           ANALOG MEASUREMENTS
 795          //==============================================================================
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 14  

 796          
 797          void analog_read_end() {
 798   1             
 799   1          /* =========================================================================
 800   1          /   Ideal formulation to calculate tension and current
 801   1          /
 802   1          /   tension = ((read_value_mV - offset) * 101) / gain -> [mV]
 803   1          /   current = ((read_value_mV - offset) * 375) / (gain * resistor) -> [mA]
 804   1          /
 805   1          /   Definition:
 806   1          /   read_value_mV = counts_read / 0.819 -> conversion from counts to mV
 807   1          /   offset = 2000 -> hardware amplifier bias in mV
 808   1          /   gain = 8.086 -> amplifier gain
 809   1          /   resistor = 18 -> resistor of voltage divider in KOhm 
 810   1          /
 811   1          /   Real formulation: tradeoff in good performance and accurancy, ADC_buf[] 
 812   1          /   and offset unit of measurment is counts, instead dev_tension and
 813   1          /   g_meas.curr[] are converted in properly unit.
 814   1          /  =========================================================================
 815   1          */
 816   1          
 817   1          // Wait for conversion end
 818   1          while(!ADC_STATUS_Read()){
 819   2              if (interrupt_flag){
 820   3                  interrupt_flag = FALSE;
 821   3                  interrupt_manager();
 822   3              }
 823   2          }
 824   1          
 825   1          // Convert tension read
 826   1          dev_tension = ((int32)(ADC_buf[0] - 1638) * 1952) >> 7;
 827   1          
 828   1          if (interrupt_flag){
 829   2              interrupt_flag = FALSE;
 830   2              interrupt_manager();
 831   2          }
 832   1      
 833   1          // Until there is no valid input tension repeat this measurement
 834   1          
 835   1          if (dev_tension > 0){
 836   2              
 837   2              POWER_ON_LED_REG_Write(1);
 838   2              
 839   2              // Set PWM depends on tension
 840   2              pwm_limit_search();
 841   2              
 842   2              // Check Interrupt 
 843   2          
 844   2              if (interrupt_flag){
 845   3                  interrupt_flag = FALSE;
 846   3                  interrupt_manager();
 847   3              }
 848   2      
 849   2              // Filter and Set currents
 850   2              g_meas.curr[0] = filter_i1((int16) pwm_sign[0] * (((int32)(ADC_buf[1] - 1638) * 25771) >> 13));
 851   2              
 852   2              // Check Interrupt 
 853   2          
 854   2              if (interrupt_flag){
 855   3                  interrupt_flag = FALSE;
 856   3                  interrupt_manager();
 857   3              }
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 15  

 858   2              g_meas.curr[1] = filter_i2((int16) pwm_sign[1] * (((int32)(ADC_buf[2] - 1638) * 25771) >> 13));
 859   2              
 860   2              // Check Interrupt 
 861   2          
 862   2              if (interrupt_flag){
 863   3                  interrupt_flag = FALSE;
 864   3                  interrupt_manager();
 865   3              }
 866   2              tension_valid = TRUE; 
 867   2          }
 868   1          else {
 869   2              
 870   2              POWER_ON_LED_REG_Write(0);
 871   2              
 872   2              g_meas.curr[0] = 0;
 873   2              g_meas.curr[1] = 0;
 874   2          }
 875   1      }
 876          
 877          //==============================================================================
 878          //                                                               ENCODER READING
 879          //==============================================================================
 880          
 881          
 882          void encoder_reading(const uint8 idx)
 883          {
 884   1          uint8 CYDATA index = idx;
 885   1          
 886   1          uint8 jj;
 887   1          
 888   1          uint32 data_encoder;
 889   1          int32 value_encoder;
 890   1          int32 aux;
 891   1      
 892   1          static int32 last_value_encoder[NUM_OF_SENSORS];
 893   1      
 894   1          static uint8 error[NUM_OF_SENSORS];
 895   1          
 896   1          static CYBIT only_first_time = TRUE;
 897   1      
 898   1          // static int32 l_value[NUM_OF_SENSORS];   //last value for vel
 899   1          // static int32 ll_value[NUM_OF_SENSORS];  //last last value for vel
 900   1          // static int32 lll_value[NUM_OF_SENSORS];  //last last last value for vel
 901   1      
 902   1          if(index >= NUM_OF_SENSORS)
 903   1              return;
 904   1      
 905   1          if(reset_last_value_flag) {
 906   2              for (jj = NUM_OF_SENSORS; jj--;)
 907   2                  last_value_encoder[jj] = 0;
 908   2              reset_last_value_flag = 0;
 909   2          } 
 910   1      
 911   1      
 912   1          //======================================================     reading sensors
 913   1              
 914   1          //Shift right 1 bit to erase dummy bit of chain   
 915   1          switch(index) {
 916   2              case 0:
 917   2                  data_encoder = (SHIFTREG_ENC_1_ReadData() >> 1) & 0x3FFFF;
 918   2                  break;
 919   2              case 1:
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 16  

 920   2                  data_encoder = (SHIFTREG_ENC_2_ReadData() >> 1) & 0x3FFFF;
 921   2                  break;
 922   2              case 2:
 923   2                  data_encoder = (SHIFTREG_ENC_3_ReadData() >> 1) & 0x3FFFF;
 924   2                  break;
 925   2              case 3:
 926   2                  data_encoder = (SHIFTREG_ENC_4_ReadData() >> 1) & 0x3FFFF;
 927   2                  break;
 928   2              case 4:
 929   2                  data_encoder = (SHIFTREG_ENC_5_ReadData() >> 1) & 0x3FFFF;
 930   2                  break;
 931   2              case 5:
 932   2                  data_encoder = (SHIFTREG_ENC_6_ReadData() >> 1) & 0x3FFFF;
 933   2                  break;
 934   2          }
 935   1          
 936   1      
 937   1          if(check_enc_data(&data_encoder)) {
 938   2      
 939   2              value_encoder = (int32) (((data_encoder & 0x3FFC0) - 0x20000) >> 2);
 940   2      
 941   2              //Add offset and crop to 16bit
 942   2              value_encoder = (int16)(value_encoder + g_mem.m_off[index]);
 943   2              
 944   2              // Initialize last_value_encoder
 945   2              if (only_first_time) {
 946   3                  last_value_encoder[index] = value_encoder;
 947   3                  
 948   3                  if (index == (NUM_OF_SENSORS - 1))
 949   3                      only_first_time = 0;
 950   3              }
 951   2      
 952   2              // Take care of rotations
 953   2              aux = value_encoder - last_value_encoder[index];
 954   2      
 955   2              // ====================== 1 TURN ======================
 956   2              // -32768                    0                    32767 -32768                   0                
             -     32767
 957   2              // |-------------------------|-------------------------|-------------------------|----------------
             ----------|
 958   2              //              |                         |      |           |      |                         |
 959   2              //           -16384                     16383    |           |   -16384                     16383
 960   2              //                                               |           |
 961   2              //                                           24575           -24576
 962   2              //                                               |___________|
 963   2              //                                                   49152
 964   2      
 965   2              // if we are in the right interval, take care of rotation
 966   2              // and update the variable only if the difference between
 967   2              // one measure and another is less than 1/4 of turn
 968   2      
 969   2              // Considering we are sampling at 1kHz, this means that our shaft needs
 970   2              // to go slower than 1/4 turn every ms -> 1 turn every 4ms
 971   2              // equal to 250 turn/s -> 15000 RPM
 972   2      
 973   2              if (aux > 49152)
 974   2                  g_meas.rot[index]--;
 975   2              else{ 
 976   3                  if (aux < -49152)
 977   3                      g_meas.rot[index]++;
 978   3                  else{
 979   4                      if (abs(aux) > 16384) { // if two measure are too far
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 17  

 980   5                          error[index]++;
 981   5                      if (error[index] < 10)
 982   5                          // Discard
 983   5                          return;
 984   5                      }
 985   4                  }
 986   3              }
 987   2      
 988   2              error[index] = 0;
 989   2      
 990   2              last_value_encoder[index] = value_encoder;
 991   2      
 992   2              value_encoder += (int32)g_meas.rot[index] << 16;
 993   2      
 994   2              if (c_mem.m_mult[index] != 1.0)
 995   2                  value_encoder *= c_mem.m_mult[index];
 996   2      
 997   2              g_meas.pos[index] = value_encoder;
 998   2          }
 999   1          // // velocity calculation
1000   1          // switch(i) {
1001   1          //     case 0: {
1002   1          //         g_meas.vel[i] = (int16)filter_vel_1((3*value_encoder + l_value[i] - ll_value[i] - 3*lll_val
             -ue[i]) / 10);
1003   1          //         break;
1004   1          //     }
1005   1          //     case 1: {
1006   1          //         g_meas.vel[i] = (int16)filter_vel_2((3*value_encoder + l_value[i] - ll_value[i] - 3*lll_val
             -ue[i]) / 10);
1007   1          //         break;
1008   1          //     }
1009   1          //     case 2: {
1010   1          //         g_meas.vel[i] = (int16)filter_vel_3((3*value_encoder + l_value[i] - ll_value[i] - 3*lll_val
             -ue[i]) / 10);
1011   1          //         break;
1012   1          //     }
1013   1          // }
1014   1      
1015   1          // // update old values
1016   1          // lll_value[i] = ll_value[i];
1017   1          // ll_value[i] = l_value[i];
1018   1          // l_value[i] = value_encoder;
1019   1      }
1020          
1021          
1022          //==============================================================================
1023          //                                                          CALIBRATION FUNCTION
1024          //==============================================================================
1025          
1026          void calibration()
1027          {
1028   1          static int32 old_k_p;
1029   1          static int32 old_k_i;
1030   1          static int32 old_k_d;
1031   1      
1032   1          static uint8 pause_counter = 0;
1033   1      
1034   1          switch(calibration_flag) {
1035   2              case START:
1036   2                  ISR_RS485_RX_Disable();
1037   2      
1038   2                  // save old PID values
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 18  

1039   2                  old_k_p = c_mem.k_p;
1040   2                  old_k_i = c_mem.k_i;
1041   2                  old_k_d = c_mem.k_d;
1042   2      
1043   2                  // goto to zero position
1044   2                  g_refNew.pos[0] = 0;
1045   2                  g_refNew.pos[1] = 0;
1046   2      
1047   2                  // Activate motors
1048   2                  if (!(g_refNew.onoff & 0x03)) {
1049   3                      MOTOR_ON_OFF_Write(0x03);
1050   3                  }
1051   2      
1052   2                  // wait for motors to reach zero position
1053   2                  calibration_flag = PAUSE_1;
1054   2                  break;
1055   2      
1056   2              case PAUSE_1:
1057   2                  pause_counter++;
1058   2      
1059   2                  if (pause_counter == 10) {
1060   3                      pause_counter = 0;
1061   3      
1062   3                      // set new temp values for PID parameters
1063   3                      c_mem.k_p = 0.1 * 65536;
1064   3                      c_mem.k_i = 0;
1065   3                      c_mem.k_d = 0.3 * 65536;
1066   3      
1067   3                      calibration_flag = CONTINUE_1;
1068   3                  }
1069   2                  break;
1070   2      
1071   2              case CONTINUE_1:
1072   2                  // increment of 0.5 degree
1073   2                  g_refNew.pos[0] += 65536 / 720;
1074   2                  g_refNew.pos[1] -= 65536 / 720;
1075   2      
1076   2                  // check if one of the motors reach the threashold
1077   2                  if ((g_meas.curr[0] > CALIB_CURRENT) || (g_meas.curr[1] > CALIB_CURRENT)) {
1078   3                      // save current value as MAX_STIFFNESS
1079   3                      g_mem.max_stiffness = g_ref.pos[0];
1080   3      
1081   3                      // reset old values for PID parameters
1082   3                      c_mem.k_p = old_k_p;
1083   3                      c_mem.k_i = old_k_i;
1084   3                      c_mem.k_d = old_k_d;
1085   3      
1086   3                      // go back to zero position
1087   3                      g_refNew.pos[0] = 0;
1088   3                      g_refNew.pos[1] = 0;
1089   3      
1090   3                      // wait for motors to reach zero position
1091   3                      calibration_flag = PAUSE_2;
1092   3                  }
1093   2                  break;
1094   2      
1095   2              case PAUSE_2:
1096   2                  pause_counter++;
1097   2      
1098   2                  if (pause_counter == 10) {
1099   3                      pause_counter =0;
1100   3      
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 19  

1101   3                      calibration_flag = CONTINUE_2;
1102   3                  }
1103   2                  break;
1104   2      
1105   2              case CONTINUE_2:
1106   2                  // Deactivate motors
1107   2                  if (!(g_refNew.onoff & 0x03)) {
1108   3                      MOTOR_ON_OFF_Write(0x00);
1109   3                  }
1110   2      
1111   2                  // store memory to save MAX_STIFFNESS as default value
1112   2                  memStore(DEFAULT_EEPROM_DISPLACEMENT);
1113   2                  memStore(0);
1114   2      
1115   2                  calibration_flag = STOP;
1116   2      
1117   2                  ISR_RS485_RX_Enable();
1118   2                  break;
1119   2      
1120   2              case STOP:
1121   2              default:
1122   2                  break;
1123   2          }
1124   1      }
1125          
1126          
1127          
1128          //==============================================================================
1129          //                                                              PWM_LIMIT_SEARCH
1130          //==============================================================================
1131          
1132          void pwm_limit_search() {
1133   1          dev_pwm_limit = 100;
1134   1      }
1135          
1136          
1137          /* [] END OF FILE */
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 20  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION ISR_WATCHDOG_Handler (BEGIN)
                                           ; SOURCE LINE # 56
                                           ; SOURCE LINE # 60
0000 D200        E     SETB    watchdog_flag
                                           ; SOURCE LINE # 62
0002 32                RETI    
             ; FUNCTION ISR_WATCHDOG_Handler (END)

             ; FUNCTION ISR_RS485_RX_ExInterrupt (BEGIN)
                                           ; SOURCE LINE # 68
                                           ; SOURCE LINE # 72
0000 D200        E     SETB    interrupt_flag
                                           ; SOURCE LINE # 74
0002 32                RETI    
             ; FUNCTION ISR_RS485_RX_ExInterrupt (END)

             ; FUNCTION interrupt_manager (BEGIN)
                                           ; SOURCE LINE # 91
                                           ; SOURCE LINE # 106
0000 E4                CLR     A
0001 F500        R     MOV     package_count,A
0003         ?C0003:
                                           ; SOURCE LINE # 112
0003 120000      E     LCALL   UART_RS485_GetRxBufferSize
0006 EF                MOV     A,R7
0007 7003              JNZ     $ + 5H
0009 020000      R     LJMP    ?C0026
000C E500        R     MOV     A,package_count
000E C3                CLR     C
000F 9406              SUBB    A,#06H
0011 4003              JC      $ + 5H
0013 020000      R     LJMP    ?C0026
                                           ; SOURCE LINE # 116
0016 120000      E     LCALL   UART_RS485_GetChar
0019 8F00        R     MOV     rx_data,R7
                                           ; SOURCE LINE # 118
001B E500        R     MOV     A,state
001D 14                DEC     A
001E 6049              JZ      ?C0010
0020 14                DEC     A
0021 6060              JZ      ?C0014
0023 14                DEC     A
0024 7003              JNZ     $ + 5H
0026 020000      R     LJMP    ?C0021
0029 14                DEC     A
002A 7003              JNZ     $ + 5H
002C 020000      R     LJMP    ?C0024
002F 2404              ADD     A,#04H
0031 70D0              JNZ     ?C0003
                                           ; SOURCE LINE # 120
0033         ?C0006:
                                           ; SOURCE LINE # 122
0033 850000      R     MOV     rx_queue,rx_queue+01H
                                           ; SOURCE LINE # 123
0036 850000      R     MOV     rx_queue+01H,rx_queue+02H
                                           ; SOURCE LINE # 124
0039 850000      R     MOV     rx_queue+02H,rx_data
                                           ; SOURCE LINE # 127
003C E500        R     MOV     A,rx_queue+01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 21  

003E B43A11            CJNE    A,#03AH,?C0007
0041 E500        R     MOV     A,rx_queue+02H
0043 B43A0C            CJNE    A,#03AH,?C0007
                                           ; SOURCE LINE # 128
0046 E4                CLR     A
0047 F500        R     MOV     rx_queue,A
                                           ; SOURCE LINE # 129
0049 F500        R     MOV     rx_queue+01H,A
                                           ; SOURCE LINE # 130
004B F500        R     MOV     rx_queue+02H,A
                                           ; SOURCE LINE # 131
004D 750001      R     MOV     state,#01H
                                           ; SOURCE LINE # 132
0050 80B1              SJMP    ?C0003
0052         ?C0007:
                                           ; SOURCE LINE # 133
0052 E500        R     MOV     A,rx_queue
0054 B43FAC            CJNE    A,#03FH,?C0003
0057 E500        R     MOV     A,rx_queue+01H
0059 B40DA7            CJNE    A,#0DH,?C0003
005C E500        R     MOV     A,rx_queue+02H
005E 640A              XRL     A,#0AH
0060 70A1              JNZ     ?C0003
                                           ; SOURCE LINE # 136
0062 FF                MOV     R7,A
0063 FE                MOV     R6,A
0064 120000      E     LCALL   _infoGet
                                           ; SOURCE LINE # 137
0067 809A              SJMP    ?C0003
                                           ; SOURCE LINE # 140
0069         ?C0010:
                                           ; SOURCE LINE # 143
0069 900000      E     MOV     DPTR,#c_mem+01H
006C E0                MOVX    A,@DPTR
006D 6500        R     XRL     A,rx_data
006F 6004              JZ      ?C0012
0071 E500        R     MOV     A,rx_data
0073 7004              JNZ     ?C0011
0075         ?C0012:
                                           ; SOURCE LINE # 144
0075 C200        R     CLR     rx_data_type
0077 8002              SJMP    ?C0013
0079         ?C0011:
                                           ; SOURCE LINE # 146
0079 D200        R     SETB    rx_data_type
007B         ?C0013:
                                           ; SOURCE LINE # 148
007B E4                CLR     A
007C F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 149
007E 750002      R     MOV     state,#02H
                                           ; SOURCE LINE # 150
0081 8080              SJMP    ?C0003
                                           ; SOURCE LINE # 153
0083         ?C0014:
                                           ; SOURCE LINE # 156
0083 850000      R     MOV     data_packet_length,rx_data
                                           ; SOURCE LINE # 158
0086 E500        R     MOV     A,data_packet_length
0088 D3                SETB    C
0089 9401              SUBB    A,#01H
008B 5008              JNC     ?C0015
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 22  

                                           ; SOURCE LINE # 159
008D E4                CLR     A
008E F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 160
0090 F500        R     MOV     state,A
                                           ; SOURCE LINE # 161
0092 020000      R     LJMP    ?C0003
0095         ?C0015:
0095 E500        R     MOV     A,data_packet_length
0097 D3                SETB    C
0098 9480              SUBB    A,#080H
009A 4008              JC      ?C0017
                                           ; SOURCE LINE # 162
009C E4                CLR     A
009D F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 163
009F F500        R     MOV     state,A
                                           ; SOURCE LINE # 164
00A1 020000      R     LJMP    ?C0003
00A4         ?C0017:
                                           ; SOURCE LINE # 165
00A4 E4                CLR     A
00A5 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 167
00A7 200006            JB      rx_data_type,?C0019
                                           ; SOURCE LINE # 168
00AA 750003      R     MOV     state,#03H
00AD 020000      R     LJMP    ?C0003
00B0         ?C0019:
                                           ; SOURCE LINE # 170
00B0 750004      R     MOV     state,#04H
                                           ; SOURCE LINE # 171
                                           ; SOURCE LINE # 172
00B3 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 175
00B6         ?C0021:
                                           ; SOURCE LINE # 177
00B6 7400        R     MOV     A,#LOW data_packet_buffer
00B8 2500        R     ADD     A,data_packet_index
00BA F582              MOV     DPL,A
00BC E4                CLR     A
00BD 3400        R     ADDC    A,#HIGH data_packet_buffer
00BF F583              MOV     DPH,A
00C1 E500        R     MOV     A,rx_data
00C3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 178
00C4 0500        R     INC     data_packet_index
                                           ; SOURCE LINE # 181
00C6 E500        R     MOV     A,data_packet_index
00C8 C3                CLR     C
00C9 9500        R     SUBB    A,data_packet_length
00CB 5003              JNC     $ + 5H
00CD 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 183
00D0 200025            JB      rx_data_type,?C0023
                                           ; SOURCE LINE # 185
00D3 AF00        R     MOV     R7,data_packet_length
00D5 7E00              MOV     R6,#00H
00D7 7800        E     MOV     R0,#LOW g_rx
00D9 7C00        E     MOV     R4,#HIGH g_rx
00DB 7D01              MOV     R5,#01H
00DD 7B01              MOV     R3,#01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 23  

00DF 7A00        R     MOV     R2,#HIGH data_packet_buffer
00E1 7900        R     MOV     R1,#LOW data_packet_buffer
00E3 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 186
00E6 900000      E     MOV     DPTR,#g_rx+080H
00E9 E4                CLR     A
00EA F0                MOVX    @DPTR,A
00EB A3                INC     DPTR
00EC E500        R     MOV     A,data_packet_length
00EE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 187
00EF 900000      E     MOV     DPTR,#g_rx+084H
00F2 7401              MOV     A,#01H
00F4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 188
00F5 120000      E     LCALL   commProcess
                                           ; SOURCE LINE # 189
00F8         ?C0023:
                                           ; SOURCE LINE # 191
00F8 E4                CLR     A
00F9 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 192
00FB F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 193
00FD F500        R     MOV     state,A
                                           ; SOURCE LINE # 194
00FF 0500        R     INC     package_count
                                           ; SOURCE LINE # 196
                                           ; SOURCE LINE # 197
0101 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 200
0104         ?C0024:
                                           ; SOURCE LINE # 201
0104 1500        R     DEC     data_packet_length
0106 E500        R     MOV     A,data_packet_length
0108 6003              JZ      $ + 5H
010A 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 202
010D F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 203
010F F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 204
0111 7F01              MOV     R7,#01H
0113 120000      E     LCALL   _RS485_CTS_Write
                                           ; SOURCE LINE # 205
0116 E4                CLR     A
0117 FF                MOV     R7,A
0118 120000      E     LCALL   _RS485_CTS_Write
                                           ; SOURCE LINE # 206
011B E4                CLR     A
011C F500        R     MOV     state,A
                                           ; SOURCE LINE # 207
011E 0500        R     INC     package_count
                                           ; SOURCE LINE # 208
                                           ; SOURCE LINE # 209
0120 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 210
                                           ; SOURCE LINE # 211
0123 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 212
0126         ?C0026:
0126 22                RET     
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 24  

             ; FUNCTION interrupt_manager (END)

             ; FUNCTION function_scheduler (BEGIN)
                                           ; SOURCE LINE # 221
                                           ; SOURCE LINE # 225
0000 120000      E     LCALL   MY_TIMER_ReadCounter
0003 E4                CLR     A
0004 FC                MOV     R4,A
0005 FD                MOV     R5,A
0006 900000      E     MOV     DPTR,#timer_value0
0009 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 229
000C 7F01              MOV     R7,#01H
000E 120000      E     LCALL   _ADC_SOC_Write
                                           ; SOURCE LINE # 233
0011 300005            JNB     interrupt_flag,?C0027
                                           ; SOURCE LINE # 234
0014 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 235
0016 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 236
0019         ?C0027:
                                           ; SOURCE LINE # 240
0019 E4                CLR     A
001A FF                MOV     R7,A
001B 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 244
001E 300005            JNB     interrupt_flag,?C0028
                                           ; SOURCE LINE # 245
0021 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 246
0023 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 247
0026         ?C0028:
                                           ; SOURCE LINE # 249
0026 7F01              MOV     R7,#01H
0028 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 253
002B 300005            JNB     interrupt_flag,?C0029
                                           ; SOURCE LINE # 254
002E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 255
0030 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 256
0033         ?C0029:
                                           ; SOURCE LINE # 258
0033 7F02              MOV     R7,#02H
0035 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 262
0038 300005            JNB     interrupt_flag,?C0030
                                           ; SOURCE LINE # 263
003B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 264
003D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 265
0040         ?C0030:
                                           ; SOURCE LINE # 267
0040 7F03              MOV     R7,#03H
0042 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 271
0045 300005            JNB     interrupt_flag,?C0031
                                           ; SOURCE LINE # 272
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 25  

0048 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 273
004A 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 274
004D         ?C0031:
                                           ; SOURCE LINE # 276
004D 7F04              MOV     R7,#04H
004F 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 280
0052 300005            JNB     interrupt_flag,?C0032
                                           ; SOURCE LINE # 281
0055 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 282
0057 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 283
005A         ?C0032:
                                           ; SOURCE LINE # 285
005A 7F05              MOV     R7,#05H
005C 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 289
005F 300005            JNB     interrupt_flag,?C0033
                                           ; SOURCE LINE # 290
0062 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 291
0064 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 292
0067         ?C0033:
                                           ; SOURCE LINE # 296
0067 E4                CLR     A
0068 FF                MOV     R7,A
0069 120000      R     LCALL   _motor_control
                                           ; SOURCE LINE # 300
006C 300005            JNB     interrupt_flag,?C0034
                                           ; SOURCE LINE # 301
006F C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 302
0071 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 303
0074         ?C0034:
                                           ; SOURCE LINE # 305
0074 7F01              MOV     R7,#01H
0076 120000      R     LCALL   _motor_control
                                           ; SOURCE LINE # 309
0079 300005            JNB     interrupt_flag,?C0035
                                           ; SOURCE LINE # 310
007C C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 311
007E 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 312
0081         ?C0035:
                                           ; SOURCE LINE # 316
0081 120000      R     LCALL   analog_read_end
                                           ; SOURCE LINE # 321
0084 900000      E     MOV     DPTR,#calibration_flag
0087 E0                MOVX    A,@DPTR
0088 7003              JNZ     ?C0037
008A D3                SETB    C
008B 8001              SJMP    ?C0038
008D         ?C0037:
008D C3                CLR     C
008E         ?C0038:
008E 4024              JC      ?C0036
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 26  

                                           ; SOURCE LINE # 322
0090 900000      R     MOV     DPTR,#counter_calibration
0093 E0                MOVX    A,@DPTR
0094 7004              JNZ     ?C0205
0096 A3                INC     DPTR
0097 E0                MOVX    A,@DPTR
0098 6464              XRL     A,#064H
009A         ?C0205:
009A 700A              JNZ     ?C0039
                                           ; SOURCE LINE # 323
009C 120000      R     LCALL   calibration
                                           ; SOURCE LINE # 324
009F E4                CLR     A
00A0 900000      R     MOV     DPTR,#counter_calibration
00A3 F0                MOVX    @DPTR,A
00A4 A3                INC     DPTR
00A5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 325
00A6         ?C0039:
                                           ; SOURCE LINE # 326
00A6 900000      R     MOV     DPTR,#counter_calibration+01H
00A9 E0                MOVX    A,@DPTR
00AA 04                INC     A
00AB F0                MOVX    @DPTR,A
00AC 7006              JNZ     ?C0206
00AE 900000      R     MOV     DPTR,#counter_calibration
00B1 E0                MOVX    A,@DPTR
00B2 04                INC     A
00B3 F0                MOVX    @DPTR,A
00B4         ?C0206:
                                           ; SOURCE LINE # 327
00B4         ?C0036:
                                           ; SOURCE LINE # 330
00B4 300005            JNB     interrupt_flag,?C0040
                                           ; SOURCE LINE # 331
00B7 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 332
00B9 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 333
00BC         ?C0040:
                                           ; SOURCE LINE # 338
00BC 7800        E     MOV     R0,#LOW g_measOld
00BE 7C00        E     MOV     R4,#HIGH g_measOld
00C0 7D01              MOV     R5,#01H
00C2 7B01              MOV     R3,#01H
00C4 7A00        E     MOV     R2,#HIGH g_meas
00C6 7900        E     MOV     R1,#LOW g_meas
00C8 7E00              MOV     R6,#00H
00CA 7F4A              MOV     R7,#04AH
00CC 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 339
00CF 7800        E     MOV     R0,#LOW g_refOld
00D1 7C00        E     MOV     R4,#HIGH g_refOld
00D3 7D01              MOV     R5,#01H
00D5 7B01              MOV     R3,#01H
00D7 7A00        E     MOV     R2,#HIGH g_ref
00D9 7900        E     MOV     R1,#LOW g_ref
00DB 7E00              MOV     R6,#00H
00DD 7F19              MOV     R7,#019H
00DF 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 342
00E2 7800        E     MOV     R0,#LOW g_ref
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 27  

00E4 7C00        E     MOV     R4,#HIGH g_ref
00E6 7D01              MOV     R5,#01H
00E8 7B01              MOV     R3,#01H
00EA 7A00        E     MOV     R2,#HIGH g_refNew
00EC 7900        E     MOV     R1,#LOW g_refNew
00EE 7E00              MOV     R6,#00H
00F0 7F19              MOV     R7,#019H
00F2 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 344
00F5 300005            JNB     interrupt_flag,?C0041
                                           ; SOURCE LINE # 345
00F8 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 346
00FA 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 347
00FD         ?C0041:
                                           ; SOURCE LINE # 349
00FD 120000      E     LCALL   MY_TIMER_ReadCounter
0100 E4                CLR     A
0101 FC                MOV     R4,A
0102 FD                MOV     R5,A
0103 900000      E     MOV     DPTR,#timer_value
0106 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 350
0109 7F40              MOV     R7,#040H
010B 7E4B              MOV     R6,#04BH
010D 120000      E     LCALL   _MY_TIMER_WriteCounter
                                           ; SOURCE LINE # 351
0110 22                RET     
             ; FUNCTION function_scheduler (END)

             ; FUNCTION _motor_control (BEGIN)
                                           ; SOURCE LINE # 358
;---- Variable 'idx' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 360
0000 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 364
0002 E4                CLR     A
0003 F500        R     MOV     pwm_input+03H,A
0005 F500        R     MOV     pwm_input+02H,A
0007 F500        R     MOV     pwm_input+01H,A
0009 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 370
000B 900000      E     MOV     DPTR,#c_mem+02H
000E E0                MOVX    A,@DPTR
000F FC                MOV     R4,A
0010 A3                INC     DPTR
0011 E0                MOVX    A,@DPTR
0012 FD                MOV     R5,A
0013 A3                INC     DPTR
0014 E0                MOVX    A,@DPTR
0015 FE                MOV     R6,A
0016 A3                INC     DPTR
0017 E0                MOVX    A,@DPTR
0018 F500        R     MOV     k_p+03H,A
001A 8E00        R     MOV     k_p+02H,R6
001C 8D00        R     MOV     k_p+01H,R5
001E 8C00        R     MOV     k_p,R4
                                           ; SOURCE LINE # 371
0020 A3                INC     DPTR
0021 E0                MOVX    A,@DPTR
0022 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 28  

0023 A3                INC     DPTR
0024 E0                MOVX    A,@DPTR
0025 FD                MOV     R5,A
0026 A3                INC     DPTR
0027 E0                MOVX    A,@DPTR
0028 FE                MOV     R6,A
0029 A3                INC     DPTR
002A E0                MOVX    A,@DPTR
002B F500        R     MOV     k_i+03H,A
002D 8E00        R     MOV     k_i+02H,R6
002F 8D00        R     MOV     k_i+01H,R5
0031 8C00        R     MOV     k_i,R4
                                           ; SOURCE LINE # 372
0033 A3                INC     DPTR
0034 E0                MOVX    A,@DPTR
0035 FC                MOV     R4,A
0036 A3                INC     DPTR
0037 E0                MOVX    A,@DPTR
0038 FD                MOV     R5,A
0039 A3                INC     DPTR
003A E0                MOVX    A,@DPTR
003B FE                MOV     R6,A
003C A3                INC     DPTR
003D E0                MOVX    A,@DPTR
003E F500        R     MOV     k_d+03H,A
0040 8E00        R     MOV     k_d+02H,R6
0042 8D00        R     MOV     k_d+01H,R5
0044 8C00        R     MOV     k_d,R4
                                           ; SOURCE LINE # 374
0046 A3                INC     DPTR
0047 E0                MOVX    A,@DPTR
0048 FC                MOV     R4,A
0049 A3                INC     DPTR
004A E0                MOVX    A,@DPTR
004B FD                MOV     R5,A
004C A3                INC     DPTR
004D E0                MOVX    A,@DPTR
004E FE                MOV     R6,A
004F A3                INC     DPTR
0050 E0                MOVX    A,@DPTR
0051 F500        R     MOV     k_p_c+03H,A
0053 8E00        R     MOV     k_p_c+02H,R6
0055 8D00        R     MOV     k_p_c+01H,R5
0057 8C00        R     MOV     k_p_c,R4
                                           ; SOURCE LINE # 375
0059 A3                INC     DPTR
005A E0                MOVX    A,@DPTR
005B FC                MOV     R4,A
005C A3                INC     DPTR
005D E0                MOVX    A,@DPTR
005E FD                MOV     R5,A
005F A3                INC     DPTR
0060 E0                MOVX    A,@DPTR
0061 FE                MOV     R6,A
0062 A3                INC     DPTR
0063 E0                MOVX    A,@DPTR
0064 F500        R     MOV     k_i_c+03H,A
0066 8E00        R     MOV     k_i_c+02H,R6
0068 8D00        R     MOV     k_i_c+01H,R5
006A 8C00        R     MOV     k_i_c,R4
                                           ; SOURCE LINE # 376
006C A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 29  

006D E0                MOVX    A,@DPTR
006E FC                MOV     R4,A
006F A3                INC     DPTR
0070 E0                MOVX    A,@DPTR
0071 FD                MOV     R5,A
0072 A3                INC     DPTR
0073 E0                MOVX    A,@DPTR
0074 FE                MOV     R6,A
0075 A3                INC     DPTR
0076 E0                MOVX    A,@DPTR
0077 F500        R     MOV     k_d_c+03H,A
0079 8E00        R     MOV     k_d_c+02H,R6
007B 8D00        R     MOV     k_d_c+01H,R5
007D 8C00        R     MOV     k_d_c,R4
                                           ; SOURCE LINE # 378
007F A3                INC     DPTR
0080 E0                MOVX    A,@DPTR
0081 FC                MOV     R4,A
0082 A3                INC     DPTR
0083 E0                MOVX    A,@DPTR
0084 FD                MOV     R5,A
0085 A3                INC     DPTR
0086 E0                MOVX    A,@DPTR
0087 FE                MOV     R6,A
0088 A3                INC     DPTR
0089 E0                MOVX    A,@DPTR
008A F500        R     MOV     k_p_dl+03H,A
008C 8E00        R     MOV     k_p_dl+02H,R6
008E 8D00        R     MOV     k_p_dl+01H,R5
0090 8C00        R     MOV     k_p_dl,R4
                                           ; SOURCE LINE # 379
0092 A3                INC     DPTR
0093 E0                MOVX    A,@DPTR
0094 FC                MOV     R4,A
0095 A3                INC     DPTR
0096 E0                MOVX    A,@DPTR
0097 FD                MOV     R5,A
0098 A3                INC     DPTR
0099 E0                MOVX    A,@DPTR
009A FE                MOV     R6,A
009B A3                INC     DPTR
009C E0                MOVX    A,@DPTR
009D F500        R     MOV     k_i_dl+03H,A
009F 8E00        R     MOV     k_i_dl+02H,R6
00A1 8D00        R     MOV     k_i_dl+01H,R5
00A3 8C00        R     MOV     k_i_dl,R4
                                           ; SOURCE LINE # 380
00A5 A3                INC     DPTR
00A6 E0                MOVX    A,@DPTR
00A7 FC                MOV     R4,A
00A8 A3                INC     DPTR
00A9 E0                MOVX    A,@DPTR
00AA FD                MOV     R5,A
00AB A3                INC     DPTR
00AC E0                MOVX    A,@DPTR
00AD FE                MOV     R6,A
00AE A3                INC     DPTR
00AF E0                MOVX    A,@DPTR
00B0 F500        R     MOV     k_d_dl+03H,A
00B2 8E00        R     MOV     k_d_dl+02H,R6
00B4 8D00        R     MOV     k_d_dl+01H,R5
00B6 8C00        R     MOV     k_d_dl,R4
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 30  

                                           ; SOURCE LINE # 382
00B8 A3                INC     DPTR
00B9 E0                MOVX    A,@DPTR
00BA FC                MOV     R4,A
00BB A3                INC     DPTR
00BC E0                MOVX    A,@DPTR
00BD FD                MOV     R5,A
00BE A3                INC     DPTR
00BF E0                MOVX    A,@DPTR
00C0 FE                MOV     R6,A
00C1 A3                INC     DPTR
00C2 E0                MOVX    A,@DPTR
00C3 F500        R     MOV     k_p_c_dl+03H,A
00C5 8E00        R     MOV     k_p_c_dl+02H,R6
00C7 8D00        R     MOV     k_p_c_dl+01H,R5
00C9 8C00        R     MOV     k_p_c_dl,R4
                                           ; SOURCE LINE # 383
00CB A3                INC     DPTR
00CC E0                MOVX    A,@DPTR
00CD FC                MOV     R4,A
00CE A3                INC     DPTR
00CF E0                MOVX    A,@DPTR
00D0 FD                MOV     R5,A
00D1 A3                INC     DPTR
00D2 E0                MOVX    A,@DPTR
00D3 FE                MOV     R6,A
00D4 A3                INC     DPTR
00D5 E0                MOVX    A,@DPTR
00D6 F500        R     MOV     k_i_c_dl+03H,A
00D8 8E00        R     MOV     k_i_c_dl+02H,R6
00DA 8D00        R     MOV     k_i_c_dl+01H,R5
00DC 8C00        R     MOV     k_i_c_dl,R4
                                           ; SOURCE LINE # 384
00DE A3                INC     DPTR
00DF E0                MOVX    A,@DPTR
00E0 FC                MOV     R4,A
00E1 A3                INC     DPTR
00E2 E0                MOVX    A,@DPTR
00E3 FD                MOV     R5,A
00E4 A3                INC     DPTR
00E5 E0                MOVX    A,@DPTR
00E6 FE                MOV     R6,A
00E7 A3                INC     DPTR
00E8 E0                MOVX    A,@DPTR
00E9 F500        R     MOV     k_d_c_dl+03H,A
00EB 8E00        R     MOV     k_d_c_dl+02H,R6
00ED 8D00        R     MOV     k_d_c_dl+01H,R5
00EF 8C00        R     MOV     k_d_c_dl,R4
                                           ; SOURCE LINE # 393
00F1 E500        R     MOV     A,index
00F3 C3                CLR     C
00F4 9402              SUBB    A,#02H
00F6 4003              JC      $ + 5H
00F8 020000      R     LJMP    ?C0044
00FB         ?C0043:
                                           ; SOURCE LINE # 396
00FB 900000      E     MOV     DPTR,#c_mem+035H
00FE E0                MOVX    A,@DPTR
00FF 6401              XRL     A,#01H
0101 6003              JZ      $ + 5H
0103 020000      R     LJMP    ?C0045
                                           ; SOURCE LINE # 398
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 31  

0106 900000      E     MOV     DPTR,#g_measOld+08H
0109 E0                MOVX    A,@DPTR
010A FC                MOV     R4,A
010B A3                INC     DPTR
010C E0                MOVX    A,@DPTR
010D FD                MOV     R5,A
010E A3                INC     DPTR
010F E0                MOVX    A,@DPTR
0110 FE                MOV     R6,A
0111 A3                INC     DPTR
0112 E0                MOVX    A,@DPTR
0113 FF                MOV     R7,A
0114 E500        R     MOV     A,index
0116 25E0              ADD     A,ACC
0118 25E0              ADD     A,ACC
011A 2400        E     ADD     A,#LOW g_ref
011C F582              MOV     DPL,A
011E E4                CLR     A
011F 3400        E     ADDC    A,#HIGH g_ref
0121 F583              MOV     DPH,A
0123 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 401
0126 900000      E     MOV     DPTR,#c_mem+06DH
0129 E0                MOVX    A,@DPTR
012A 7003              JNZ     $ + 5H
012C 020000      R     LJMP    ?C0045
                                           ; SOURCE LINE # 402
012F E500        R     MOV     A,index
0131 25E0              ADD     A,ACC
0133 25E0              ADD     A,ACC
0135 2400        E     ADD     A,#LOW c_mem+06EH
0137 F582              MOV     DPL,A
0139 E4                CLR     A
013A 3400        E     ADDC    A,#HIGH c_mem+06EH
013C F583              MOV     DPH,A
013E E0                MOVX    A,@DPTR
013F FC                MOV     R4,A
0140 A3                INC     DPTR
0141 E0                MOVX    A,@DPTR
0142 FD                MOV     R5,A
0143 A3                INC     DPTR
0144 E0                MOVX    A,@DPTR
0145 FE                MOV     R6,A
0146 A3                INC     DPTR
0147 E0                MOVX    A,@DPTR
0148 FF                MOV     R7,A
0149 E500        R     MOV     A,index
014B 25E0              ADD     A,ACC
014D 25E0              ADD     A,ACC
014F 2400        E     ADD     A,#LOW g_ref
0151 F582              MOV     DPL,A
0153 E4                CLR     A
0154 3400        E     ADDC    A,#HIGH g_ref
0156 F583              MOV     DPH,A
0158 E0                MOVX    A,@DPTR
0159 F8                MOV     R0,A
015A A3                INC     DPTR
015B E0                MOVX    A,@DPTR
015C F9                MOV     R1,A
015D A3                INC     DPTR
015E E0                MOVX    A,@DPTR
015F FA                MOV     R2,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 32  

0160 A3                INC     DPTR
0161 E0                MOVX    A,@DPTR
0162 FB                MOV     R3,A
0163 C3                CLR     C
0164 120000      E     LCALL   ?C?SLCMP
0167 502C              JNC     ?C0047
                                           ; SOURCE LINE # 403
0169 E500        R     MOV     A,index
016B 25E0              ADD     A,ACC
016D 25E0              ADD     A,ACC
016F 2400        E     ADD     A,#LOW c_mem+06EH
0171 F582              MOV     DPL,A
0173 E4                CLR     A
0174 3400        E     ADDC    A,#HIGH c_mem+06EH
0176 F583              MOV     DPH,A
0178 E0                MOVX    A,@DPTR
0179 FC                MOV     R4,A
017A A3                INC     DPTR
017B E0                MOVX    A,@DPTR
017C FD                MOV     R5,A
017D A3                INC     DPTR
017E E0                MOVX    A,@DPTR
017F FE                MOV     R6,A
0180 A3                INC     DPTR
0181 E0                MOVX    A,@DPTR
0182 FF                MOV     R7,A
0183 E500        R     MOV     A,index
0185 25E0              ADD     A,ACC
0187 25E0              ADD     A,ACC
0189 2400        E     ADD     A,#LOW g_ref
018B F582              MOV     DPL,A
018D E4                CLR     A
018E 3400        E     ADDC    A,#HIGH g_ref
0190 F583              MOV     DPH,A
0192 120000      E     LCALL   ?C?LSTXDATA
0195         ?C0047:
                                           ; SOURCE LINE # 404
0195 E500        R     MOV     A,index
0197 25E0              ADD     A,ACC
0199 25E0              ADD     A,ACC
019B 2400        E     ADD     A,#LOW c_mem+076H
019D F582              MOV     DPL,A
019F E4                CLR     A
01A0 3400        E     ADDC    A,#HIGH c_mem+076H
01A2 F583              MOV     DPH,A
01A4 E0                MOVX    A,@DPTR
01A5 FC                MOV     R4,A
01A6 A3                INC     DPTR
01A7 E0                MOVX    A,@DPTR
01A8 FD                MOV     R5,A
01A9 A3                INC     DPTR
01AA E0                MOVX    A,@DPTR
01AB FE                MOV     R6,A
01AC A3                INC     DPTR
01AD E0                MOVX    A,@DPTR
01AE FF                MOV     R7,A
01AF E500        R     MOV     A,index
01B1 25E0              ADD     A,ACC
01B3 25E0              ADD     A,ACC
01B5 2400        E     ADD     A,#LOW g_ref
01B7 F582              MOV     DPL,A
01B9 E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 33  

01BA 3400        E     ADDC    A,#HIGH g_ref
01BC F583              MOV     DPH,A
01BE E0                MOVX    A,@DPTR
01BF F8                MOV     R0,A
01C0 A3                INC     DPTR
01C1 E0                MOVX    A,@DPTR
01C2 F9                MOV     R1,A
01C3 A3                INC     DPTR
01C4 E0                MOVX    A,@DPTR
01C5 FA                MOV     R2,A
01C6 A3                INC     DPTR
01C7 E0                MOVX    A,@DPTR
01C8 FB                MOV     R3,A
01C9 D3                SETB    C
01CA 120000      E     LCALL   ?C?SLCMP
01CD 402C              JC      ?C0045
                                           ; SOURCE LINE # 405
01CF E500        R     MOV     A,index
01D1 25E0              ADD     A,ACC
01D3 25E0              ADD     A,ACC
01D5 2400        E     ADD     A,#LOW c_mem+076H
01D7 F582              MOV     DPL,A
01D9 E4                CLR     A
01DA 3400        E     ADDC    A,#HIGH c_mem+076H
01DC F583              MOV     DPH,A
01DE E0                MOVX    A,@DPTR
01DF FC                MOV     R4,A
01E0 A3                INC     DPTR
01E1 E0                MOVX    A,@DPTR
01E2 FD                MOV     R5,A
01E3 A3                INC     DPTR
01E4 E0                MOVX    A,@DPTR
01E5 FE                MOV     R6,A
01E6 A3                INC     DPTR
01E7 E0                MOVX    A,@DPTR
01E8 FF                MOV     R7,A
01E9 E500        R     MOV     A,index
01EB 25E0              ADD     A,ACC
01ED 25E0              ADD     A,ACC
01EF 2400        E     ADD     A,#LOW g_ref
01F1 F582              MOV     DPL,A
01F3 E4                CLR     A
01F4 3400        E     ADDC    A,#HIGH g_ref
01F6 F583              MOV     DPH,A
01F8 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 406
                                           ; SOURCE LINE # 407
01FB         ?C0045:
                                           ; SOURCE LINE # 409
01FB 900000      E     MOV     DPTR,#c_mem+036H
01FE E0                MOVX    A,@DPTR
01FF FF                MOV     R7,A
0200 14                DEC     A
0201 7003              JNZ     $ + 5H
0203 020000      R     LJMP    ?C0130
0206 14                DEC     A
0207 7003              JNZ     $ + 5H
0209 020000      R     LJMP    ?C0109
020C 14                DEC     A
020D 7003              JNZ     $ + 5H
020F 020000      R     LJMP    ?C0074
0212 14                DEC     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 34  

0213 600D              JZ      ?C0051
0215 14                DEC     A
0216 7003              JNZ     $ + 5H
0218 020000      R     LJMP    ?C0074
021B 2405              ADD     A,#05H
021D 6003              JZ      $ + 5H
021F 020000      R     LJMP    ?C0049
                                           ; SOURCE LINE # 410
                                           ; SOURCE LINE # 411
0222         ?C0051:
                                           ; SOURCE LINE # 413
0222 EF                MOV     A,R7
0223 6404              XRL     A,#04H
0225 6003              JZ      $ + 5H
0227 020000      R     LJMP    ?C0052
                                           ; SOURCE LINE # 417
022A E500        R     MOV     A,index
022C 25E0              ADD     A,ACC
022E 25E0              ADD     A,ACC
0230 2400        E     ADD     A,#LOW g_ref
0232 F582              MOV     DPL,A
0234 E4                CLR     A
0235 3400        E     ADDC    A,#HIGH g_ref
0237 F583              MOV     DPH,A
0239 E0                MOVX    A,@DPTR
023A FC                MOV     R4,A
023B A3                INC     DPTR
023C E0                MOVX    A,@DPTR
023D FD                MOV     R5,A
023E A3                INC     DPTR
023F E0                MOVX    A,@DPTR
0240 FE                MOV     R6,A
0241 A3                INC     DPTR
0242 E0                MOVX    A,@DPTR
0243 FF                MOV     R7,A
0244 900000      E     MOV     DPTR,#g_meas+08H
0247 E0                MOVX    A,@DPTR
0248 F8                MOV     R0,A
0249 A3                INC     DPTR
024A E0                MOVX    A,@DPTR
024B F9                MOV     R1,A
024C A3                INC     DPTR
024D E0                MOVX    A,@DPTR
024E FA                MOV     R2,A
024F A3                INC     DPTR
0250 E0                MOVX    A,@DPTR
0251 FB                MOV     R3,A
0252 C3                CLR     C
0253 EF                MOV     A,R7
0254 9B                SUBB    A,R3
0255 FF                MOV     R7,A
0256 EE                MOV     A,R6
0257 9A                SUBB    A,R2
0258 FE                MOV     R6,A
0259 ED                MOV     A,R5
025A 99                SUBB    A,R1
025B FD                MOV     R5,A
025C EC                MOV     A,R4
025D 98                SUBB    A,R0
025E FC                MOV     R4,A
025F 120000      E     LCALL   ?C?LNEG
0262 E500        R     MOV     A,index
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 35  

0264 25E0              ADD     A,ACC
0266 25E0              ADD     A,ACC
0268 2400        R     ADD     A,#LOW defl_input
026A F8                MOV     R0,A
026B 120000      E     LCALL   ?C?LSTIDATA
                                           ; SOURCE LINE # 418
026E E500        R     MOV     A,index
0270 25E0              ADD     A,ACC
0272 25E0              ADD     A,ACC
0274 2400        E     ADD     A,#LOW g_meas
0276 F582              MOV     DPL,A
0278 E4                CLR     A
0279 3400        E     ADDC    A,#HIGH g_meas
027B F583              MOV     DPH,A
027D E0                MOVX    A,@DPTR
027E F8                MOV     R0,A
027F A3                INC     DPTR
0280 E0                MOVX    A,@DPTR
0281 F9                MOV     R1,A
0282 A3                INC     DPTR
0283 E0                MOVX    A,@DPTR
0284 FA                MOV     R2,A
0285 A3                INC     DPTR
0286 E0                MOVX    A,@DPTR
0287 FB                MOV     R3,A
0288 C000              PUSH    AR0
028A E500        R     MOV     A,index
028C 25E0              ADD     A,ACC
028E 25E0              ADD     A,ACC
0290 2400        R     ADD     A,#LOW defl_input
0292 F8                MOV     R0,A
0293 120000      E     LCALL   ?C?LLDIDATA
0296 D000              POP     AR0
0298 C3                CLR     C
0299 EF                MOV     A,R7
029A 9B                SUBB    A,R3
029B F500        R     MOV     pos_error+03H,A
029D EE                MOV     A,R6
029E 9A                SUBB    A,R2
029F F500        R     MOV     pos_error+02H,A
02A1 ED                MOV     A,R5
02A2 99                SUBB    A,R1
02A3 F500        R     MOV     pos_error+01H,A
02A5 EC                MOV     A,R4
02A6 98                SUBB    A,R0
02A7 F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 419
02A9 8043              SJMP    ?C0053
02AB         ?C0052:
                                           ; SOURCE LINE # 422
02AB E500        R     MOV     A,index
02AD 25E0              ADD     A,ACC
02AF 25E0              ADD     A,ACC
02B1 2400        E     ADD     A,#LOW g_meas
02B3 F582              MOV     DPL,A
02B5 E4                CLR     A
02B6 3400        E     ADDC    A,#HIGH g_meas
02B8 F583              MOV     DPH,A
02BA E0                MOVX    A,@DPTR
02BB F8                MOV     R0,A
02BC A3                INC     DPTR
02BD E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 36  

02BE F9                MOV     R1,A
02BF A3                INC     DPTR
02C0 E0                MOVX    A,@DPTR
02C1 FA                MOV     R2,A
02C2 A3                INC     DPTR
02C3 E0                MOVX    A,@DPTR
02C4 FB                MOV     R3,A
02C5 E500        R     MOV     A,index
02C7 25E0              ADD     A,ACC
02C9 25E0              ADD     A,ACC
02CB 2400        E     ADD     A,#LOW g_ref
02CD F582              MOV     DPL,A
02CF E4                CLR     A
02D0 3400        E     ADDC    A,#HIGH g_ref
02D2 F583              MOV     DPH,A
02D4 E0                MOVX    A,@DPTR
02D5 FC                MOV     R4,A
02D6 A3                INC     DPTR
02D7 E0                MOVX    A,@DPTR
02D8 FD                MOV     R5,A
02D9 A3                INC     DPTR
02DA E0                MOVX    A,@DPTR
02DB FE                MOV     R6,A
02DC A3                INC     DPTR
02DD E0                MOVX    A,@DPTR
02DE C3                CLR     C
02DF 9B                SUBB    A,R3
02E0 F500        R     MOV     pos_error+03H,A
02E2 EE                MOV     A,R6
02E3 9A                SUBB    A,R2
02E4 F500        R     MOV     pos_error+02H,A
02E6 ED                MOV     A,R5
02E7 99                SUBB    A,R1
02E8 F500        R     MOV     pos_error+01H,A
02EA EC                MOV     A,R4
02EB 98                SUBB    A,R0
02EC F500        R     MOV     pos_error,A
02EE         ?C0053:
                                           ; SOURCE LINE # 425
02EE E500        R     MOV     A,index
02F0 25E0              ADD     A,ACC
02F2 25E0              ADD     A,ACC
02F4 2400        R     ADD     A,#LOW pos_error_sum
02F6 F582              MOV     DPL,A
02F8 E4                CLR     A
02F9 3400        R     ADDC    A,#HIGH pos_error_sum
02FB F583              MOV     DPH,A
02FD C083              PUSH    DPH
02FF C082              PUSH    DPL
0301 E0                MOVX    A,@DPTR
0302 FC                MOV     R4,A
0303 A3                INC     DPTR
0304 E0                MOVX    A,@DPTR
0305 FD                MOV     R5,A
0306 A3                INC     DPTR
0307 E0                MOVX    A,@DPTR
0308 FE                MOV     R6,A
0309 A3                INC     DPTR
030A E0                MOVX    A,@DPTR
030B 2500        R     ADD     A,pos_error+03H
030D FF                MOV     R7,A
030E EE                MOV     A,R6
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 37  

030F 3500        R     ADDC    A,pos_error+02H
0311 FE                MOV     R6,A
0312 ED                MOV     A,R5
0313 3500        R     ADDC    A,pos_error+01H
0315 FD                MOV     R5,A
0316 EC                MOV     A,R4
0317 3500        R     ADDC    A,pos_error
0319 FC                MOV     R4,A
031A D082              POP     DPL
031C D083              POP     DPH
031E 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 427
0321 300005            JNB     interrupt_flag,?C0054
                                           ; SOURCE LINE # 428
0324 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 429
0326 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 430
0329         ?C0054:
                                           ; SOURCE LINE # 433
0329 E500        R     MOV     A,index
032B 25E0              ADD     A,ACC
032D 25E0              ADD     A,ACC
032F 2400        R     ADD     A,#LOW pos_error_sum
0331 F582              MOV     DPL,A
0333 E4                CLR     A
0334 3400        R     ADDC    A,#HIGH pos_error_sum
0336 F583              MOV     DPH,A
0338 E0                MOVX    A,@DPTR
0339 FC                MOV     R4,A
033A A3                INC     DPTR
033B E0                MOVX    A,@DPTR
033C FD                MOV     R5,A
033D A3                INC     DPTR
033E E0                MOVX    A,@DPTR
033F FE                MOV     R6,A
0340 A3                INC     DPTR
0341 E0                MOVX    A,@DPTR
0342 FF                MOV     R7,A
0343 7BA0              MOV     R3,#0A0H
0345 7A86              MOV     R2,#086H
0347 7901              MOV     R1,#01H
0349 7800              MOV     R0,#00H
034B C3                CLR     C
034C 120000      E     LCALL   ?C?SLCMP
034F 501C              JNC     ?C0055
                                           ; SOURCE LINE # 434
0351 7FA0              MOV     R7,#0A0H
0353 7E86              MOV     R6,#086H
0355 7D01              MOV     R5,#01H
0357 7C00              MOV     R4,#00H
0359 E500        R     MOV     A,index
035B 25E0              ADD     A,ACC
035D 25E0              ADD     A,ACC
035F 2400        R     ADD     A,#LOW pos_error_sum
0361 F582              MOV     DPL,A
0363 E4                CLR     A
0364 3400        R     ADDC    A,#HIGH pos_error_sum
0366 F583              MOV     DPH,A
0368 120000      E     LCALL   ?C?LSTXDATA
036B 8042              SJMP    ?C0056
036D         ?C0055:
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 38  

                                           ; SOURCE LINE # 435
                                           ; SOURCE LINE # 436
036D E500        R     MOV     A,index
036F 25E0              ADD     A,ACC
0371 25E0              ADD     A,ACC
0373 2400        R     ADD     A,#LOW pos_error_sum
0375 F582              MOV     DPL,A
0377 E4                CLR     A
0378 3400        R     ADDC    A,#HIGH pos_error_sum
037A F583              MOV     DPH,A
037C E0                MOVX    A,@DPTR
037D FC                MOV     R4,A
037E A3                INC     DPTR
037F E0                MOVX    A,@DPTR
0380 FD                MOV     R5,A
0381 A3                INC     DPTR
0382 E0                MOVX    A,@DPTR
0383 FE                MOV     R6,A
0384 A3                INC     DPTR
0385 E0                MOVX    A,@DPTR
0386 FF                MOV     R7,A
0387 7B60              MOV     R3,#060H
0389 7A79              MOV     R2,#079H
038B 79FE              MOV     R1,#0FEH
038D 78FF              MOV     R0,#0FFH
038F D3                SETB    C
0390 120000      E     LCALL   ?C?SLCMP
0393 401A              JC      ?C0056
                                           ; SOURCE LINE # 437
0395 7F60              MOV     R7,#060H
0397 7E79              MOV     R6,#079H
0399 7DFE              MOV     R5,#0FEH
039B 7CFF              MOV     R4,#0FFH
039D E500        R     MOV     A,index
039F 25E0              ADD     A,ACC
03A1 25E0              ADD     A,ACC
03A3 2400        R     ADD     A,#LOW pos_error_sum
03A5 F582              MOV     DPL,A
03A7 E4                CLR     A
03A8 3400        R     ADDC    A,#HIGH pos_error_sum
03AA F583              MOV     DPH,A
03AC 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 438
03AF         ?C0056:
                                           ; SOURCE LINE # 440
03AF 300005            JNB     interrupt_flag,?C0058
                                           ; SOURCE LINE # 441
03B2 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 442
03B4 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 443
03B7         ?C0058:
                                           ; SOURCE LINE # 445
03B7 E4                CLR     A
03B8 F500        R     MOV     pwm_input+03H,A
03BA F500        R     MOV     pwm_input+02H,A
03BC F500        R     MOV     pwm_input+01H,A
03BE F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 447
03C0 FF                MOV     R7,A
03C1 FE                MOV     R6,A
03C2 FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 39  

03C3 FC                MOV     R4,A
03C4 AB00        R     MOV     R3,k_p+03H
03C6 AA00        R     MOV     R2,k_p+02H
03C8 A900        R     MOV     R1,k_p+01H
03CA A800        R     MOV     R0,k_p
03CC C3                CLR     C
03CD 120000      E     LCALL   ?C?SLCMP
03D0 606A              JZ      ?C0059
                                           ; SOURCE LINE # 449
03D2 E4                CLR     A
03D3 FF                MOV     R7,A
03D4 FE                MOV     R6,A
03D5 7D02              MOV     R5,#02H
03D7 FC                MOV     R4,A
03D8 AB00        R     MOV     R3,pos_error+03H
03DA AA00        R     MOV     R2,pos_error+02H
03DC A900        R     MOV     R1,pos_error+01H
03DE A800        R     MOV     R0,pos_error
03E0 D3                SETB    C
03E1 120000      E     LCALL   ?C?SLCMP
03E4 500F              JNC     ?C0061
03E6 E4                CLR     A
03E7 FF                MOV     R7,A
03E8 FE                MOV     R6,A
03E9 7DFE              MOV     R5,#0FEH
03EB 7CFF              MOV     R4,#0FFH
03ED A800        R     MOV     R0,pos_error
03EF C3                CLR     C
03F0 120000      E     LCALL   ?C?SLCMP
03F3 5027              JNC     ?C0060
03F5         ?C0061:
                                           ; SOURCE LINE # 450
03F5 AF00        R     MOV     R7,pos_error+03H
03F7 AE00        R     MOV     R6,pos_error+02H
03F9 AD00        R     MOV     R5,pos_error+01H
03FB AC00        R     MOV     R4,pos_error
03FD 7808              MOV     R0,#08H
03FF 120000      E     LCALL   ?C?SLSHR
0402 AB00        R     MOV     R3,k_p+03H
0404 AA00        R     MOV     R2,k_p+02H
0406 A900        R     MOV     R1,k_p+01H
0408 A800        R     MOV     R0,k_p
040A 120000      E     LCALL   ?C?LMUL
040D 7808              MOV     R0,#08H
040F 120000      E     LCALL   ?C?SLSHR
0412 8F00        R     MOV     pwm_input+03H,R7
0414 8E00        R     MOV     pwm_input+02H,R6
0416 8D00        R     MOV     pwm_input+01H,R5
0418 8C00        R     MOV     pwm_input,R4
041A 8020              SJMP    ?C0059
041C         ?C0060:
                                           ; SOURCE LINE # 452
041C AF00        R     MOV     R7,pos_error+03H
041E AE00        R     MOV     R6,pos_error+02H
0420 AD00        R     MOV     R5,pos_error+01H
0422 AC00        R     MOV     R4,pos_error
0424 AB00        R     MOV     R3,k_p+03H
0426 AA00        R     MOV     R2,k_p+02H
0428 A900        R     MOV     R1,k_p+01H
042A A800        R     MOV     R0,k_p
042C 120000      E     LCALL   ?C?LMUL
042F 7810              MOV     R0,#010H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 40  

0431 120000      E     LCALL   ?C?SLSHR
0434 8F00        R     MOV     pwm_input+03H,R7
0436 8E00        R     MOV     pwm_input+02H,R6
0438 8D00        R     MOV     pwm_input+01H,R5
043A 8C00        R     MOV     pwm_input,R4
                                           ; SOURCE LINE # 453
043C         ?C0059:
                                           ; SOURCE LINE # 455
043C 300005            JNB     interrupt_flag,?C0063
                                           ; SOURCE LINE # 456
043F C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 457
0441 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 458
0444         ?C0063:
                                           ; SOURCE LINE # 461
0444 E4                CLR     A
0445 FF                MOV     R7,A
0446 FE                MOV     R6,A
0447 FD                MOV     R5,A
0448 FC                MOV     R4,A
0449 AB00        R     MOV     R3,k_i+03H
044B AA00        R     MOV     R2,k_i+02H
044D A900        R     MOV     R1,k_i+01H
044F A800        R     MOV     R0,k_i
0451 C3                CLR     C
0452 120000      E     LCALL   ?C?SLCMP
0455 6043              JZ      ?C0064
                                           ; SOURCE LINE # 462
0457 AF00        R     MOV     R7,k_i+03H
0459 AE00        R     MOV     R6,k_i+02H
045B AD00        R     MOV     R5,k_i+01H
045D AC00        R     MOV     R4,k_i
045F 7806              MOV     R0,#06H
0461 120000      E     LCALL   ?C?SLSHR
0464 E500        R     MOV     A,index
0466 25E0              ADD     A,ACC
0468 25E0              ADD     A,ACC
046A 2400        R     ADD     A,#LOW pos_error_sum
046C F582              MOV     DPL,A
046E E4                CLR     A
046F 3400        R     ADDC    A,#HIGH pos_error_sum
0471 F583              MOV     DPH,A
0473 E0                MOVX    A,@DPTR
0474 F8                MOV     R0,A
0475 A3                INC     DPTR
0476 E0                MOVX    A,@DPTR
0477 F9                MOV     R1,A
0478 A3                INC     DPTR
0479 E0                MOVX    A,@DPTR
047A FA                MOV     R2,A
047B A3                INC     DPTR
047C E0                MOVX    A,@DPTR
047D FB                MOV     R3,A
047E 120000      E     LCALL   ?C?LMUL
0481 780A              MOV     R0,#0AH
0483 120000      E     LCALL   ?C?SLSHR
0486 E500        R     MOV     A,pwm_input+03H
0488 2F                ADD     A,R7
0489 F500        R     MOV     pwm_input+03H,A
048B E500        R     MOV     A,pwm_input+02H
048D 3E                ADDC    A,R6
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 41  

048E F500        R     MOV     pwm_input+02H,A
0490 E500        R     MOV     A,pwm_input+01H
0492 3D                ADDC    A,R5
0493 F500        R     MOV     pwm_input+01H,A
0495 E500        R     MOV     A,pwm_input
0497 3C                ADDC    A,R4
0498 F500        R     MOV     pwm_input,A
049A         ?C0064:
                                           ; SOURCE LINE # 465
049A E4                CLR     A
049B FF                MOV     R7,A
049C FE                MOV     R6,A
049D FD                MOV     R5,A
049E FC                MOV     R4,A
049F AB00        R     MOV     R3,k_d+03H
04A1 AA00        R     MOV     R2,k_d+02H
04A3 A900        R     MOV     R1,k_d+01H
04A5 A800        R     MOV     R0,k_d
04A7 C3                CLR     C
04A8 120000      E     LCALL   ?C?SLCMP
04AB 6063              JZ      ?C0065
                                           ; SOURCE LINE # 466
04AD E500        R     MOV     A,index
04AF 25E0              ADD     A,ACC
04B1 25E0              ADD     A,ACC
04B3 2400        E     ADD     A,#LOW g_meas
04B5 F582              MOV     DPL,A
04B7 E4                CLR     A
04B8 3400        E     ADDC    A,#HIGH g_meas
04BA F583              MOV     DPH,A
04BC E0                MOVX    A,@DPTR
04BD F8                MOV     R0,A
04BE A3                INC     DPTR
04BF E0                MOVX    A,@DPTR
04C0 F9                MOV     R1,A
04C1 A3                INC     DPTR
04C2 E0                MOVX    A,@DPTR
04C3 FA                MOV     R2,A
04C4 A3                INC     DPTR
04C5 E0                MOVX    A,@DPTR
04C6 FB                MOV     R3,A
04C7 E500        R     MOV     A,index
04C9 25E0              ADD     A,ACC
04CB 25E0              ADD     A,ACC
04CD 2400        E     ADD     A,#LOW g_measOld
04CF F582              MOV     DPL,A
04D1 E4                CLR     A
04D2 3400        E     ADDC    A,#HIGH g_measOld
04D4 F583              MOV     DPH,A
04D6 E0                MOVX    A,@DPTR
04D7 FC                MOV     R4,A
04D8 A3                INC     DPTR
04D9 E0                MOVX    A,@DPTR
04DA FD                MOV     R5,A
04DB A3                INC     DPTR
04DC E0                MOVX    A,@DPTR
04DD FE                MOV     R6,A
04DE A3                INC     DPTR
04DF E0                MOVX    A,@DPTR
04E0 C3                CLR     C
04E1 9B                SUBB    A,R3
04E2 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 42  

04E3 EE                MOV     A,R6
04E4 9A                SUBB    A,R2
04E5 FE                MOV     R6,A
04E6 ED                MOV     A,R5
04E7 99                SUBB    A,R1
04E8 FD                MOV     R5,A
04E9 EC                MOV     A,R4
04EA 98                SUBB    A,R0
04EB FC                MOV     R4,A
04EC AB00        R     MOV     R3,k_d+03H
04EE AA00        R     MOV     R2,k_d+02H
04F0 A900        R     MOV     R1,k_d+01H
04F2 A800        R     MOV     R0,k_d
04F4 120000      E     LCALL   ?C?LMUL
04F7 7810              MOV     R0,#010H
04F9 120000      E     LCALL   ?C?SLSHR
04FC E500        R     MOV     A,pwm_input+03H
04FE 2F                ADD     A,R7
04FF F500        R     MOV     pwm_input+03H,A
0501 E500        R     MOV     A,pwm_input+02H
0503 3E                ADDC    A,R6
0504 F500        R     MOV     pwm_input+02H,A
0506 E500        R     MOV     A,pwm_input+01H
0508 3D                ADDC    A,R5
0509 F500        R     MOV     pwm_input+01H,A
050B E500        R     MOV     A,pwm_input
050D 3C                ADDC    A,R4
050E F500        R     MOV     pwm_input,A
0510         ?C0065:
                                           ; SOURCE LINE # 469
0510 300005            JNB     interrupt_flag,?C0066
                                           ; SOURCE LINE # 470
0513 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 471
0515 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 472
0518         ?C0066:
                                           ; SOURCE LINE # 474
0518 E500        R     MOV     A,index
051A 701C              JNZ     ?C0067
                                           ; SOURCE LINE # 475
051C FF                MOV     R7,A
051D FE                MOV     R6,A
051E FD                MOV     R5,A
051F FC                MOV     R4,A
0520 AB00        R     MOV     R3,pwm_input+03H
0522 AA00        R     MOV     R2,pwm_input+02H
0524 A900        R     MOV     R1,pwm_input+01H
0526 A800        R     MOV     R0,pwm_input
0528 C3                CLR     C
0529 120000      E     LCALL   ?C?SLCMP
052C 4005              JC      ?C0068
                                           ; SOURCE LINE # 476
052E D200        R     SETB    dirM0
0530 020000      R     LJMP    ?C0049
0533         ?C0068:
                                           ; SOURCE LINE # 479
0533 C200        R     CLR     dirM0
                                           ; SOURCE LINE # 481
0535 020000      R     LJMP    ?C0049
0538         ?C0067:
                                           ; SOURCE LINE # 482
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 43  

0538 E4                CLR     A
0539 FF                MOV     R7,A
053A FE                MOV     R6,A
053B FD                MOV     R5,A
053C FC                MOV     R4,A
053D AB00        R     MOV     R3,pwm_input+03H
053F AA00        R     MOV     R2,pwm_input+02H
0541 A900        R     MOV     R1,pwm_input+01H
0543 A800        R     MOV     R0,pwm_input
0545 C3                CLR     C
0546 120000      E     LCALL   ?C?SLCMP
0549 4005              JC      ?C0071
                                           ; SOURCE LINE # 483
054B D200        R     SETB    dirM1
054D 020000      R     LJMP    ?C0049
0550         ?C0071:
                                           ; SOURCE LINE # 486
0550 C200        R     CLR     dirM1
                                           ; SOURCE LINE # 488
                                           ; SOURCE LINE # 490
0552 020000      R     LJMP    ?C0049
                                           ; SOURCE LINE # 492
                                           ; SOURCE LINE # 493
0555         ?C0074:
                                           ; SOURCE LINE # 495
0555 900000      E     MOV     DPTR,#c_mem+036H
0558 E0                MOVX    A,@DPTR
0559 6405              XRL     A,#05H
055B 6003              JZ      $ + 5H
055D 020000      R     LJMP    ?C0075
                                           ; SOURCE LINE # 499
0560 E500        R     MOV     A,index
0562 25E0              ADD     A,ACC
0564 25E0              ADD     A,ACC
0566 2400        E     ADD     A,#LOW g_ref
0568 F582              MOV     DPL,A
056A E4                CLR     A
056B 3400        E     ADDC    A,#HIGH g_ref
056D F583              MOV     DPH,A
056F E0                MOVX    A,@DPTR
0570 FC                MOV     R4,A
0571 A3                INC     DPTR
0572 E0                MOVX    A,@DPTR
0573 FD                MOV     R5,A
0574 A3                INC     DPTR
0575 E0                MOVX    A,@DPTR
0576 FE                MOV     R6,A
0577 A3                INC     DPTR
0578 E0                MOVX    A,@DPTR
0579 FF                MOV     R7,A
057A 900000      E     MOV     DPTR,#g_meas+08H
057D E0                MOVX    A,@DPTR
057E F8                MOV     R0,A
057F A3                INC     DPTR
0580 E0                MOVX    A,@DPTR
0581 F9                MOV     R1,A
0582 A3                INC     DPTR
0583 E0                MOVX    A,@DPTR
0584 FA                MOV     R2,A
0585 A3                INC     DPTR
0586 E0                MOVX    A,@DPTR
0587 FB                MOV     R3,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 44  

0588 C3                CLR     C
0589 EF                MOV     A,R7
058A 9B                SUBB    A,R3
058B FF                MOV     R7,A
058C EE                MOV     A,R6
058D 9A                SUBB    A,R2
058E FE                MOV     R6,A
058F ED                MOV     A,R5
0590 99                SUBB    A,R1
0591 FD                MOV     R5,A
0592 EC                MOV     A,R4
0593 98                SUBB    A,R0
0594 FC                MOV     R4,A
0595 120000      E     LCALL   ?C?LNEG
0598 E500        R     MOV     A,index
059A 25E0              ADD     A,ACC
059C 25E0              ADD     A,ACC
059E 2400        R     ADD     A,#LOW defl_input
05A0 F8                MOV     R0,A
05A1 120000      E     LCALL   ?C?LSTIDATA
                                           ; SOURCE LINE # 500
05A4 E500        R     MOV     A,index
05A6 25E0              ADD     A,ACC
05A8 25E0              ADD     A,ACC
05AA 2400        E     ADD     A,#LOW g_meas
05AC F582              MOV     DPL,A
05AE E4                CLR     A
05AF 3400        E     ADDC    A,#HIGH g_meas
05B1 F583              MOV     DPH,A
05B3 E0                MOVX    A,@DPTR
05B4 F8                MOV     R0,A
05B5 A3                INC     DPTR
05B6 E0                MOVX    A,@DPTR
05B7 F9                MOV     R1,A
05B8 A3                INC     DPTR
05B9 E0                MOVX    A,@DPTR
05BA FA                MOV     R2,A
05BB A3                INC     DPTR
05BC E0                MOVX    A,@DPTR
05BD FB                MOV     R3,A
05BE C000              PUSH    AR0
05C0 E500        R     MOV     A,index
05C2 25E0              ADD     A,ACC
05C4 25E0              ADD     A,ACC
05C6 2400        R     ADD     A,#LOW defl_input
05C8 F8                MOV     R0,A
05C9 120000      E     LCALL   ?C?LLDIDATA
05CC D000              POP     AR0
05CE C3                CLR     C
05CF EF                MOV     A,R7
05D0 9B                SUBB    A,R3
05D1 F500        R     MOV     pos_error+03H,A
05D3 EE                MOV     A,R6
05D4 9A                SUBB    A,R2
05D5 F500        R     MOV     pos_error+02H,A
05D7 ED                MOV     A,R5
05D8 99                SUBB    A,R1
05D9 F500        R     MOV     pos_error+01H,A
05DB EC                MOV     A,R4
05DC 98                SUBB    A,R0
05DD F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 501
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 45  

05DF 8043              SJMP    ?C0076
05E1         ?C0075:
                                           ; SOURCE LINE # 503
05E1 E500        R     MOV     A,index
05E3 25E0              ADD     A,ACC
05E5 25E0              ADD     A,ACC
05E7 2400        E     ADD     A,#LOW g_meas
05E9 F582              MOV     DPL,A
05EB E4                CLR     A
05EC 3400        E     ADDC    A,#HIGH g_meas
05EE F583              MOV     DPH,A
05F0 E0                MOVX    A,@DPTR
05F1 F8                MOV     R0,A
05F2 A3                INC     DPTR
05F3 E0                MOVX    A,@DPTR
05F4 F9                MOV     R1,A
05F5 A3                INC     DPTR
05F6 E0                MOVX    A,@DPTR
05F7 FA                MOV     R2,A
05F8 A3                INC     DPTR
05F9 E0                MOVX    A,@DPTR
05FA FB                MOV     R3,A
05FB E500        R     MOV     A,index
05FD 25E0              ADD     A,ACC
05FF 25E0              ADD     A,ACC
0601 2400        E     ADD     A,#LOW g_ref
0603 F582              MOV     DPL,A
0605 E4                CLR     A
0606 3400        E     ADDC    A,#HIGH g_ref
0608 F583              MOV     DPH,A
060A E0                MOVX    A,@DPTR
060B FC                MOV     R4,A
060C A3                INC     DPTR
060D E0                MOVX    A,@DPTR
060E FD                MOV     R5,A
060F A3                INC     DPTR
0610 E0                MOVX    A,@DPTR
0611 FE                MOV     R6,A
0612 A3                INC     DPTR
0613 E0                MOVX    A,@DPTR
0614 C3                CLR     C
0615 9B                SUBB    A,R3
0616 F500        R     MOV     pos_error+03H,A
0618 EE                MOV     A,R6
0619 9A                SUBB    A,R2
061A F500        R     MOV     pos_error+02H,A
061C ED                MOV     A,R5
061D 99                SUBB    A,R1
061E F500        R     MOV     pos_error+01H,A
0620 EC                MOV     A,R4
0621 98                SUBB    A,R0
0622 F500        R     MOV     pos_error,A
0624         ?C0076:
                                           ; SOURCE LINE # 505
0624 300005            JNB     interrupt_flag,?C0077
                                           ; SOURCE LINE # 506
0627 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 507
0629 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 508
062C         ?C0077:
                                           ; SOURCE LINE # 510
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 46  

062C E500        R     MOV     A,index
062E 25E0              ADD     A,ACC
0630 25E0              ADD     A,ACC
0632 2400        R     ADD     A,#LOW pos_error_sum
0634 F582              MOV     DPL,A
0636 E4                CLR     A
0637 3400        R     ADDC    A,#HIGH pos_error_sum
0639 F583              MOV     DPH,A
063B C083              PUSH    DPH
063D C082              PUSH    DPL
063F E0                MOVX    A,@DPTR
0640 FC                MOV     R4,A
0641 A3                INC     DPTR
0642 E0                MOVX    A,@DPTR
0643 FD                MOV     R5,A
0644 A3                INC     DPTR
0645 E0                MOVX    A,@DPTR
0646 FE                MOV     R6,A
0647 A3                INC     DPTR
0648 E0                MOVX    A,@DPTR
0649 2500        R     ADD     A,pos_error+03H
064B FF                MOV     R7,A
064C EE                MOV     A,R6
064D 3500        R     ADDC    A,pos_error+02H
064F FE                MOV     R6,A
0650 ED                MOV     A,R5
0651 3500        R     ADDC    A,pos_error+01H
0653 FD                MOV     R5,A
0654 EC                MOV     A,R4
0655 3500        R     ADDC    A,pos_error
0657 FC                MOV     R4,A
0658 D082              POP     DPL
065A D083              POP     DPH
065C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 512
065F E500        R     MOV     A,index
0661 25E0              ADD     A,ACC
0663 25E0              ADD     A,ACC
0665 2400        R     ADD     A,#LOW pos_error_sum
0667 F582              MOV     DPL,A
0669 E4                CLR     A
066A 3400        R     ADDC    A,#HIGH pos_error_sum
066C F583              MOV     DPH,A
066E E0                MOVX    A,@DPTR
066F FC                MOV     R4,A
0670 A3                INC     DPTR
0671 E0                MOVX    A,@DPTR
0672 FD                MOV     R5,A
0673 A3                INC     DPTR
0674 E0                MOVX    A,@DPTR
0675 FE                MOV     R6,A
0676 A3                INC     DPTR
0677 E0                MOVX    A,@DPTR
0678 FF                MOV     R7,A
0679 7BA0              MOV     R3,#0A0H
067B 7A86              MOV     R2,#086H
067D 7901              MOV     R1,#01H
067F 7800              MOV     R0,#00H
0681 C3                CLR     C
0682 120000      E     LCALL   ?C?SLCMP
0685 501C              JNC     ?C0078
                                           ; SOURCE LINE # 513
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 47  

0687 7FA0              MOV     R7,#0A0H
0689 7E86              MOV     R6,#086H
068B 7D01              MOV     R5,#01H
068D 7C00              MOV     R4,#00H
068F E500        R     MOV     A,index
0691 25E0              ADD     A,ACC
0693 25E0              ADD     A,ACC
0695 2400        R     ADD     A,#LOW pos_error_sum
0697 F582              MOV     DPL,A
0699 E4                CLR     A
069A 3400        R     ADDC    A,#HIGH pos_error_sum
069C F583              MOV     DPH,A
069E 120000      E     LCALL   ?C?LSTXDATA
06A1 8042              SJMP    ?C0079
06A3         ?C0078:
                                           ; SOURCE LINE # 514
                                           ; SOURCE LINE # 515
06A3 E500        R     MOV     A,index
06A5 25E0              ADD     A,ACC
06A7 25E0              ADD     A,ACC
06A9 2400        R     ADD     A,#LOW pos_error_sum
06AB F582              MOV     DPL,A
06AD E4                CLR     A
06AE 3400        R     ADDC    A,#HIGH pos_error_sum
06B0 F583              MOV     DPH,A
06B2 E0                MOVX    A,@DPTR
06B3 FC                MOV     R4,A
06B4 A3                INC     DPTR
06B5 E0                MOVX    A,@DPTR
06B6 FD                MOV     R5,A
06B7 A3                INC     DPTR
06B8 E0                MOVX    A,@DPTR
06B9 FE                MOV     R6,A
06BA A3                INC     DPTR
06BB E0                MOVX    A,@DPTR
06BC FF                MOV     R7,A
06BD 7B60              MOV     R3,#060H
06BF 7A79              MOV     R2,#079H
06C1 79FE              MOV     R1,#0FEH
06C3 78FF              MOV     R0,#0FFH
06C5 D3                SETB    C
06C6 120000      E     LCALL   ?C?SLCMP
06C9 401A              JC      ?C0079
                                           ; SOURCE LINE # 516
06CB 7F60              MOV     R7,#060H
06CD 7E79              MOV     R6,#079H
06CF 7DFE              MOV     R5,#0FEH
06D1 7CFF              MOV     R4,#0FFH
06D3 E500        R     MOV     A,index
06D5 25E0              ADD     A,ACC
06D7 25E0              ADD     A,ACC
06D9 2400        R     ADD     A,#LOW pos_error_sum
06DB F582              MOV     DPL,A
06DD E4                CLR     A
06DE 3400        R     ADDC    A,#HIGH pos_error_sum
06E0 F583              MOV     DPH,A
06E2 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 517
06E5         ?C0079:
                                           ; SOURCE LINE # 521
06E5 E4                CLR     A
06E6 F500        R     MOV     curr_ref+03H,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 48  

06E8 F500        R     MOV     curr_ref+02H,A
06EA F500        R     MOV     curr_ref+01H,A
06EC F500        R     MOV     curr_ref,A
                                           ; SOURCE LINE # 524
06EE FF                MOV     R7,A
06EF FE                MOV     R6,A
06F0 FD                MOV     R5,A
06F1 FC                MOV     R4,A
06F2 AB00        R     MOV     R3,k_p_dl+03H
06F4 AA00        R     MOV     R2,k_p_dl+02H
06F6 A900        R     MOV     R1,k_p_dl+01H
06F8 A800        R     MOV     R0,k_p_dl
06FA C3                CLR     C
06FB 120000      E     LCALL   ?C?SLCMP
06FE 7003              JNZ     $ + 5H
0700 020000      R     LJMP    ?C0081
                                           ; SOURCE LINE # 525
0703 E4                CLR     A
0704 FF                MOV     R7,A
0705 FE                MOV     R6,A
0706 7D02              MOV     R5,#02H
0708 FC                MOV     R4,A
0709 AB00        R     MOV     R3,pos_error+03H
070B AA00        R     MOV     R2,pos_error+02H
070D A900        R     MOV     R1,pos_error+01H
070F A800        R     MOV     R0,pos_error
0711 D3                SETB    C
0712 120000      E     LCALL   ?C?SLCMP
0715 500F              JNC     ?C0083
0717 E4                CLR     A
0718 FF                MOV     R7,A
0719 FE                MOV     R6,A
071A 7DFE              MOV     R5,#0FEH
071C 7CFF              MOV     R4,#0FFH
071E A800        R     MOV     R0,pos_error
0720 C3                CLR     C
0721 120000      E     LCALL   ?C?SLCMP
0724 5033              JNC     ?C0082
0726         ?C0083:
                                           ; SOURCE LINE # 526
0726 AF00        R     MOV     R7,pos_error+03H
0728 AE00        R     MOV     R6,pos_error+02H
072A AD00        R     MOV     R5,pos_error+01H
072C AC00        R     MOV     R4,pos_error
072E 7808              MOV     R0,#08H
0730 120000      E     LCALL   ?C?SLSHR
0733 AB00        R     MOV     R3,k_p_dl+03H
0735 AA00        R     MOV     R2,k_p_dl+02H
0737 A900        R     MOV     R1,k_p_dl+01H
0739 A800        R     MOV     R0,k_p_dl
073B 120000      E     LCALL   ?C?LMUL
073E 7808              MOV     R0,#08H
0740 120000      E     LCALL   ?C?SLSHR
0743 E500        R     MOV     A,curr_ref+03H
0745 2F                ADD     A,R7
0746 F500        R     MOV     curr_ref+03H,A
0748 E500        R     MOV     A,curr_ref+02H
074A 3E                ADDC    A,R6
074B F500        R     MOV     curr_ref+02H,A
074D E500        R     MOV     A,curr_ref+01H
074F 3D                ADDC    A,R5
0750 F500        R     MOV     curr_ref+01H,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 49  

0752 E500        R     MOV     A,curr_ref
0754 3C                ADDC    A,R4
0755 F500        R     MOV     curr_ref,A
0757 802C              SJMP    ?C0081
0759         ?C0082:
                                           ; SOURCE LINE # 528
0759 AF00        R     MOV     R7,pos_error+03H
075B AE00        R     MOV     R6,pos_error+02H
075D AD00        R     MOV     R5,pos_error+01H
075F AC00        R     MOV     R4,pos_error
0761 AB00        R     MOV     R3,k_p_dl+03H
0763 AA00        R     MOV     R2,k_p_dl+02H
0765 A900        R     MOV     R1,k_p_dl+01H
0767 A800        R     MOV     R0,k_p_dl
0769 120000      E     LCALL   ?C?LMUL
076C 7810              MOV     R0,#010H
076E 120000      E     LCALL   ?C?SLSHR
0771 E500        R     MOV     A,curr_ref+03H
0773 2F                ADD     A,R7
0774 F500        R     MOV     curr_ref+03H,A
0776 E500        R     MOV     A,curr_ref+02H
0778 3E                ADDC    A,R6
0779 F500        R     MOV     curr_ref+02H,A
077B E500        R     MOV     A,curr_ref+01H
077D 3D                ADDC    A,R5
077E F500        R     MOV     curr_ref+01H,A
0780 E500        R     MOV     A,curr_ref
0782 3C                ADDC    A,R4
0783 F500        R     MOV     curr_ref,A
                                           ; SOURCE LINE # 529
0785         ?C0081:
                                           ; SOURCE LINE # 532
0785 E4                CLR     A
0786 FF                MOV     R7,A
0787 FE                MOV     R6,A
0788 FD                MOV     R5,A
0789 FC                MOV     R4,A
078A AB00        R     MOV     R3,k_i_dl+03H
078C AA00        R     MOV     R2,k_i_dl+02H
078E A900        R     MOV     R1,k_i_dl+01H
0790 A800        R     MOV     R0,k_i_dl
0792 C3                CLR     C
0793 120000      E     LCALL   ?C?SLCMP
0796 6038              JZ      ?C0085
                                           ; SOURCE LINE # 533
0798 E500        R     MOV     A,index
079A 25E0              ADD     A,ACC
079C 25E0              ADD     A,ACC
079E 2400        R     ADD     A,#LOW pos_error_sum
07A0 F582              MOV     DPL,A
07A2 E4                CLR     A
07A3 3400        R     ADDC    A,#HIGH pos_error_sum
07A5 F583              MOV     DPH,A
07A7 E0                MOVX    A,@DPTR
07A8 FC                MOV     R4,A
07A9 A3                INC     DPTR
07AA E0                MOVX    A,@DPTR
07AB FD                MOV     R5,A
07AC A3                INC     DPTR
07AD E0                MOVX    A,@DPTR
07AE FE                MOV     R6,A
07AF A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 50  

07B0 E0                MOVX    A,@DPTR
07B1 FF                MOV     R7,A
07B2 A800        R     MOV     R0,k_i_dl
07B4 120000      E     LCALL   ?C?LMUL
07B7 7810              MOV     R0,#010H
07B9 120000      E     LCALL   ?C?SLSHR
07BC E500        R     MOV     A,curr_ref+03H
07BE 2F                ADD     A,R7
07BF F500        R     MOV     curr_ref+03H,A
07C1 E500        R     MOV     A,curr_ref+02H
07C3 3E                ADDC    A,R6
07C4 F500        R     MOV     curr_ref+02H,A
07C6 E500        R     MOV     A,curr_ref+01H
07C8 3D                ADDC    A,R5
07C9 F500        R     MOV     curr_ref+01H,A
07CB E500        R     MOV     A,curr_ref
07CD 3C                ADDC    A,R4
07CE F500        R     MOV     curr_ref,A
07D0         ?C0085:
                                           ; SOURCE LINE # 536
07D0 E4                CLR     A
07D1 FF                MOV     R7,A
07D2 FE                MOV     R6,A
07D3 FD                MOV     R5,A
07D4 FC                MOV     R4,A
07D5 AB00        R     MOV     R3,k_d_dl+03H
07D7 AA00        R     MOV     R2,k_d_dl+02H
07D9 A900        R     MOV     R1,k_d_dl+01H
07DB A800        R     MOV     R0,k_d_dl
07DD C3                CLR     C
07DE 120000      E     LCALL   ?C?SLCMP
07E1 6063              JZ      ?C0086
                                           ; SOURCE LINE # 537
07E3 E500        R     MOV     A,index
07E5 25E0              ADD     A,ACC
07E7 25E0              ADD     A,ACC
07E9 2400        E     ADD     A,#LOW g_meas
07EB F582              MOV     DPL,A
07ED E4                CLR     A
07EE 3400        E     ADDC    A,#HIGH g_meas
07F0 F583              MOV     DPH,A
07F2 E0                MOVX    A,@DPTR
07F3 F8                MOV     R0,A
07F4 A3                INC     DPTR
07F5 E0                MOVX    A,@DPTR
07F6 F9                MOV     R1,A
07F7 A3                INC     DPTR
07F8 E0                MOVX    A,@DPTR
07F9 FA                MOV     R2,A
07FA A3                INC     DPTR
07FB E0                MOVX    A,@DPTR
07FC FB                MOV     R3,A
07FD E500        R     MOV     A,index
07FF 25E0              ADD     A,ACC
0801 25E0              ADD     A,ACC
0803 2400        E     ADD     A,#LOW g_measOld
0805 F582              MOV     DPL,A
0807 E4                CLR     A
0808 3400        E     ADDC    A,#HIGH g_measOld
080A F583              MOV     DPH,A
080C E0                MOVX    A,@DPTR
080D FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 51  

080E A3                INC     DPTR
080F E0                MOVX    A,@DPTR
0810 FD                MOV     R5,A
0811 A3                INC     DPTR
0812 E0                MOVX    A,@DPTR
0813 FE                MOV     R6,A
0814 A3                INC     DPTR
0815 E0                MOVX    A,@DPTR
0816 C3                CLR     C
0817 9B                SUBB    A,R3
0818 FF                MOV     R7,A
0819 EE                MOV     A,R6
081A 9A                SUBB    A,R2
081B FE                MOV     R6,A
081C ED                MOV     A,R5
081D 99                SUBB    A,R1
081E FD                MOV     R5,A
081F EC                MOV     A,R4
0820 98                SUBB    A,R0
0821 FC                MOV     R4,A
0822 AB00        R     MOV     R3,k_d_dl+03H
0824 AA00        R     MOV     R2,k_d_dl+02H
0826 A900        R     MOV     R1,k_d_dl+01H
0828 A800        R     MOV     R0,k_d_dl
082A 120000      E     LCALL   ?C?LMUL
082D 7810              MOV     R0,#010H
082F 120000      E     LCALL   ?C?SLSHR
0832 E500        R     MOV     A,curr_ref+03H
0834 2F                ADD     A,R7
0835 F500        R     MOV     curr_ref+03H,A
0837 E500        R     MOV     A,curr_ref+02H
0839 3E                ADDC    A,R6
083A F500        R     MOV     curr_ref+02H,A
083C E500        R     MOV     A,curr_ref+01H
083E 3D                ADDC    A,R5
083F F500        R     MOV     curr_ref+01H,A
0841 E500        R     MOV     A,curr_ref
0843 3C                ADDC    A,R4
0844 F500        R     MOV     curr_ref,A
0846         ?C0086:
                                           ; SOURCE LINE # 539
0846 300005            JNB     interrupt_flag,?C0087
                                           ; SOURCE LINE # 540
0849 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 541
084B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 542
084E         ?C0087:
                                           ; SOURCE LINE # 545
084E 900000      E     MOV     DPTR,#c_mem+032H
0851 E0                MOVX    A,@DPTR
0852 FE                MOV     R6,A
0853 A3                INC     DPTR
0854 E0                MOVX    A,@DPTR
0855 FF                MOV     R7,A
0856 EE                MOV     A,R6
0857 33                RLC     A
0858 95E0              SUBB    A,ACC
085A FD                MOV     R5,A
085B FC                MOV     R4,A
085C AB00        R     MOV     R3,curr_ref+03H
085E AA00        R     MOV     R2,curr_ref+02H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 52  

0860 A900        R     MOV     R1,curr_ref+01H
0862 A800        R     MOV     R0,curr_ref
0864 D3                SETB    C
0865 120000      E     LCALL   ?C?SLCMP
0868 4016              JC      ?C0088
                                           ; SOURCE LINE # 546
086A 900000      E     MOV     DPTR,#c_mem+032H
086D E0                MOVX    A,@DPTR
086E FE                MOV     R6,A
086F A3                INC     DPTR
0870 E0                MOVX    A,@DPTR
0871 FF                MOV     R7,A
0872 EE                MOV     A,R6
0873 33                RLC     A
0874 95E0              SUBB    A,ACC
0876 8F00        R     MOV     curr_ref+03H,R7
0878 8E00        R     MOV     curr_ref+02H,R6
087A F500        R     MOV     curr_ref+01H,A
087C F500        R     MOV     curr_ref,A
087E 803C              SJMP    ?C0089
0880         ?C0088:
                                           ; SOURCE LINE # 547
                                           ; SOURCE LINE # 548
0880 900000      E     MOV     DPTR,#c_mem+032H
0883 E0                MOVX    A,@DPTR
0884 FE                MOV     R6,A
0885 A3                INC     DPTR
0886 E0                MOVX    A,@DPTR
0887 FF                MOV     R7,A
0888 C3                CLR     C
0889 E4                CLR     A
088A 9F                SUBB    A,R7
088B FF                MOV     R7,A
088C E4                CLR     A
088D 9E                SUBB    A,R6
088E FE                MOV     R6,A
088F 33                RLC     A
0890 95E0              SUBB    A,ACC
0892 FD                MOV     R5,A
0893 FC                MOV     R4,A
0894 AB00        R     MOV     R3,curr_ref+03H
0896 AA00        R     MOV     R2,curr_ref+02H
0898 A900        R     MOV     R1,curr_ref+01H
089A A800        R     MOV     R0,curr_ref
089C C3                CLR     C
089D 120000      E     LCALL   ?C?SLCMP
08A0 501A              JNC     ?C0089
                                           ; SOURCE LINE # 549
08A2 900000      E     MOV     DPTR,#c_mem+032H
08A5 E0                MOVX    A,@DPTR
08A6 FE                MOV     R6,A
08A7 A3                INC     DPTR
08A8 E0                MOVX    A,@DPTR
08A9 FF                MOV     R7,A
08AA C3                CLR     C
08AB E4                CLR     A
08AC 9F                SUBB    A,R7
08AD FF                MOV     R7,A
08AE E4                CLR     A
08AF 9E                SUBB    A,R6
08B0 FE                MOV     R6,A
08B1 33                RLC     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 53  

08B2 95E0              SUBB    A,ACC
08B4 8F00        R     MOV     curr_ref+03H,R7
08B6 8E00        R     MOV     curr_ref+02H,R6
08B8 F500        R     MOV     curr_ref+01H,A
08BA F500        R     MOV     curr_ref,A
                                           ; SOURCE LINE # 550
08BC         ?C0089:
                                           ; SOURCE LINE # 553
08BC E500        R     MOV     A,index
08BE 25E0              ADD     A,ACC
08C0 25E0              ADD     A,ACC
08C2 2400        E     ADD     A,#LOW g_meas+018H
08C4 F582              MOV     DPL,A
08C6 E4                CLR     A
08C7 3400        E     ADDC    A,#HIGH g_meas+018H
08C9 F583              MOV     DPH,A
08CB E0                MOVX    A,@DPTR
08CC F8                MOV     R0,A
08CD A3                INC     DPTR
08CE E0                MOVX    A,@DPTR
08CF F9                MOV     R1,A
08D0 A3                INC     DPTR
08D1 E0                MOVX    A,@DPTR
08D2 FA                MOV     R2,A
08D3 A3                INC     DPTR
08D4 E0                MOVX    A,@DPTR
08D5 FB                MOV     R3,A
08D6 C3                CLR     C
08D7 E500        R     MOV     A,curr_ref+03H
08D9 9B                SUBB    A,R3
08DA F500        R     MOV     curr_error+03H,A
08DC E500        R     MOV     A,curr_ref+02H
08DE 9A                SUBB    A,R2
08DF F500        R     MOV     curr_error+02H,A
08E1 E500        R     MOV     A,curr_ref+01H
08E3 99                SUBB    A,R1
08E4 F500        R     MOV     curr_error+01H,A
08E6 E500        R     MOV     A,curr_ref
08E8 98                SUBB    A,R0
08E9 F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 554
08EB E500        R     MOV     A,index
08ED 25E0              ADD     A,ACC
08EF 25E0              ADD     A,ACC
08F1 2400        R     ADD     A,#LOW curr_error_sum
08F3 F582              MOV     DPL,A
08F5 E4                CLR     A
08F6 3400        R     ADDC    A,#HIGH curr_error_sum
08F8 F583              MOV     DPH,A
08FA C083              PUSH    DPH
08FC C082              PUSH    DPL
08FE E0                MOVX    A,@DPTR
08FF FC                MOV     R4,A
0900 A3                INC     DPTR
0901 E0                MOVX    A,@DPTR
0902 FD                MOV     R5,A
0903 A3                INC     DPTR
0904 E0                MOVX    A,@DPTR
0905 FE                MOV     R6,A
0906 A3                INC     DPTR
0907 E0                MOVX    A,@DPTR
0908 2500        R     ADD     A,curr_error+03H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 54  

090A FF                MOV     R7,A
090B EE                MOV     A,R6
090C 3500        R     ADDC    A,curr_error+02H
090E FE                MOV     R6,A
090F ED                MOV     A,R5
0910 3500        R     ADDC    A,curr_error+01H
0912 FD                MOV     R5,A
0913 EC                MOV     A,R4
0914 3500        R     ADDC    A,curr_error
0916 FC                MOV     R4,A
0917 D082              POP     DPL
0919 D083              POP     DPH
091B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 556
091E E500        R     MOV     A,index
0920 25E0              ADD     A,ACC
0922 25E0              ADD     A,ACC
0924 2400        R     ADD     A,#LOW curr_error_sum
0926 F582              MOV     DPL,A
0928 E4                CLR     A
0929 3400        R     ADDC    A,#HIGH curr_error_sum
092B F583              MOV     DPH,A
092D E0                MOVX    A,@DPTR
092E FC                MOV     R4,A
092F A3                INC     DPTR
0930 E0                MOVX    A,@DPTR
0931 FD                MOV     R5,A
0932 A3                INC     DPTR
0933 E0                MOVX    A,@DPTR
0934 FE                MOV     R6,A
0935 A3                INC     DPTR
0936 E0                MOVX    A,@DPTR
0937 FF                MOV     R7,A
0938 7BA0              MOV     R3,#0A0H
093A 7A86              MOV     R2,#086H
093C 7901              MOV     R1,#01H
093E 7800              MOV     R0,#00H
0940 C3                CLR     C
0941 120000      E     LCALL   ?C?SLCMP
0944 501C              JNC     ?C0091
                                           ; SOURCE LINE # 557
0946 7FA0              MOV     R7,#0A0H
0948 7E86              MOV     R6,#086H
094A 7D01              MOV     R5,#01H
094C 7C00              MOV     R4,#00H
094E E500        R     MOV     A,index
0950 25E0              ADD     A,ACC
0952 25E0              ADD     A,ACC
0954 2400        R     ADD     A,#LOW curr_error_sum
0956 F582              MOV     DPL,A
0958 E4                CLR     A
0959 3400        R     ADDC    A,#HIGH curr_error_sum
095B F583              MOV     DPH,A
095D 120000      E     LCALL   ?C?LSTXDATA
0960 8042              SJMP    ?C0092
0962         ?C0091:
                                           ; SOURCE LINE # 558
                                           ; SOURCE LINE # 559
0962 E500        R     MOV     A,index
0964 25E0              ADD     A,ACC
0966 25E0              ADD     A,ACC
0968 2400        R     ADD     A,#LOW curr_error_sum
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 55  

096A F582              MOV     DPL,A
096C E4                CLR     A
096D 3400        R     ADDC    A,#HIGH curr_error_sum
096F F583              MOV     DPH,A
0971 E0                MOVX    A,@DPTR
0972 FC                MOV     R4,A
0973 A3                INC     DPTR
0974 E0                MOVX    A,@DPTR
0975 FD                MOV     R5,A
0976 A3                INC     DPTR
0977 E0                MOVX    A,@DPTR
0978 FE                MOV     R6,A
0979 A3                INC     DPTR
097A E0                MOVX    A,@DPTR
097B FF                MOV     R7,A
097C 7B60              MOV     R3,#060H
097E 7A79              MOV     R2,#079H
0980 79FE              MOV     R1,#0FEH
0982 78FF              MOV     R0,#0FFH
0984 D3                SETB    C
0985 120000      E     LCALL   ?C?SLCMP
0988 401A              JC      ?C0092
                                           ; SOURCE LINE # 560
098A 7F60              MOV     R7,#060H
098C 7E79              MOV     R6,#079H
098E 7DFE              MOV     R5,#0FEH
0990 7CFF              MOV     R4,#0FFH
0992 E500        R     MOV     A,index
0994 25E0              ADD     A,ACC
0996 25E0              ADD     A,ACC
0998 2400        R     ADD     A,#LOW curr_error_sum
099A F582              MOV     DPL,A
099C E4                CLR     A
099D 3400        R     ADDC    A,#HIGH curr_error_sum
099F F583              MOV     DPH,A
09A1 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 561
09A4         ?C0092:
                                           ; SOURCE LINE # 563
09A4 300005            JNB     interrupt_flag,?C0094
                                           ; SOURCE LINE # 564
09A7 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 565
09A9 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 566
09AC         ?C0094:
                                           ; SOURCE LINE # 570
09AC E4                CLR     A
09AD F500        R     MOV     pwm_input+03H,A
09AF F500        R     MOV     pwm_input+02H,A
09B1 F500        R     MOV     pwm_input+01H,A
09B3 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 573
09B5 FF                MOV     R7,A
09B6 FE                MOV     R6,A
09B7 FD                MOV     R5,A
09B8 FC                MOV     R4,A
09B9 AB00        R     MOV     R3,k_p_c_dl+03H
09BB AA00        R     MOV     R2,k_p_c_dl+02H
09BD A900        R     MOV     R1,k_p_c_dl+01H
09BF A800        R     MOV     R0,k_p_c_dl
09C1 C3                CLR     C
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 56  

09C2 120000      E     LCALL   ?C?SLCMP
09C5 6026              JZ      ?C0095
                                           ; SOURCE LINE # 574
09C7 AF00        R     MOV     R7,curr_error+03H
09C9 AE00        R     MOV     R6,curr_error+02H
09CB AD00        R     MOV     R5,curr_error+01H
09CD AC00        R     MOV     R4,curr_error
09CF A800        R     MOV     R0,k_p_c_dl
09D1 120000      E     LCALL   ?C?LMUL
09D4 7810              MOV     R0,#010H
09D6 120000      E     LCALL   ?C?SLSHR
09D9 E500        R     MOV     A,pwm_input+03H
09DB 2F                ADD     A,R7
09DC F500        R     MOV     pwm_input+03H,A
09DE E500        R     MOV     A,pwm_input+02H
09E0 3E                ADDC    A,R6
09E1 F500        R     MOV     pwm_input+02H,A
09E3 E500        R     MOV     A,pwm_input+01H
09E5 3D                ADDC    A,R5
09E6 F500        R     MOV     pwm_input+01H,A
09E8 E500        R     MOV     A,pwm_input
09EA 3C                ADDC    A,R4
09EB F500        R     MOV     pwm_input,A
09ED         ?C0095:
                                           ; SOURCE LINE # 577
09ED E4                CLR     A
09EE FF                MOV     R7,A
09EF FE                MOV     R6,A
09F0 FD                MOV     R5,A
09F1 FC                MOV     R4,A
09F2 AB00        R     MOV     R3,k_i_c_dl+03H
09F4 AA00        R     MOV     R2,k_i_c_dl+02H
09F6 A900        R     MOV     R1,k_i_c_dl+01H
09F8 A800        R     MOV     R0,k_i_c_dl
09FA C3                CLR     C
09FB 120000      E     LCALL   ?C?SLCMP
09FE 6038              JZ      ?C0096
                                           ; SOURCE LINE # 578
0A00 E500        R     MOV     A,index
0A02 25E0              ADD     A,ACC
0A04 25E0              ADD     A,ACC
0A06 2400        R     ADD     A,#LOW curr_error_sum
0A08 F582              MOV     DPL,A
0A0A E4                CLR     A
0A0B 3400        R     ADDC    A,#HIGH curr_error_sum
0A0D F583              MOV     DPH,A
0A0F E0                MOVX    A,@DPTR
0A10 FC                MOV     R4,A
0A11 A3                INC     DPTR
0A12 E0                MOVX    A,@DPTR
0A13 FD                MOV     R5,A
0A14 A3                INC     DPTR
0A15 E0                MOVX    A,@DPTR
0A16 FE                MOV     R6,A
0A17 A3                INC     DPTR
0A18 E0                MOVX    A,@DPTR
0A19 FF                MOV     R7,A
0A1A A800        R     MOV     R0,k_i_c_dl
0A1C 120000      E     LCALL   ?C?LMUL
0A1F 7810              MOV     R0,#010H
0A21 120000      E     LCALL   ?C?SLSHR
0A24 E500        R     MOV     A,pwm_input+03H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 57  

0A26 2F                ADD     A,R7
0A27 F500        R     MOV     pwm_input+03H,A
0A29 E500        R     MOV     A,pwm_input+02H
0A2B 3E                ADDC    A,R6
0A2C F500        R     MOV     pwm_input+02H,A
0A2E E500        R     MOV     A,pwm_input+01H
0A30 3D                ADDC    A,R5
0A31 F500        R     MOV     pwm_input+01H,A
0A33 E500        R     MOV     A,pwm_input
0A35 3C                ADDC    A,R4
0A36 F500        R     MOV     pwm_input,A
0A38         ?C0096:
                                           ; SOURCE LINE # 581
0A38 E4                CLR     A
0A39 FF                MOV     R7,A
0A3A FE                MOV     R6,A
0A3B FD                MOV     R5,A
0A3C FC                MOV     R4,A
0A3D AB00        R     MOV     R3,k_d_c_dl+03H
0A3F AA00        R     MOV     R2,k_d_c_dl+02H
0A41 A900        R     MOV     R1,k_d_c_dl+01H
0A43 A800        R     MOV     R0,k_d_c_dl
0A45 C3                CLR     C
0A46 120000      E     LCALL   ?C?SLCMP
0A49 6063              JZ      ?C0097
                                           ; SOURCE LINE # 582
0A4B E500        R     MOV     A,index
0A4D 25E0              ADD     A,ACC
0A4F 25E0              ADD     A,ACC
0A51 2400        E     ADD     A,#LOW g_meas+018H
0A53 F582              MOV     DPL,A
0A55 E4                CLR     A
0A56 3400        E     ADDC    A,#HIGH g_meas+018H
0A58 F583              MOV     DPH,A
0A5A E0                MOVX    A,@DPTR
0A5B F8                MOV     R0,A
0A5C A3                INC     DPTR
0A5D E0                MOVX    A,@DPTR
0A5E F9                MOV     R1,A
0A5F A3                INC     DPTR
0A60 E0                MOVX    A,@DPTR
0A61 FA                MOV     R2,A
0A62 A3                INC     DPTR
0A63 E0                MOVX    A,@DPTR
0A64 FB                MOV     R3,A
0A65 E500        R     MOV     A,index
0A67 25E0              ADD     A,ACC
0A69 25E0              ADD     A,ACC
0A6B 2400        E     ADD     A,#LOW g_measOld+018H
0A6D F582              MOV     DPL,A
0A6F E4                CLR     A
0A70 3400        E     ADDC    A,#HIGH g_measOld+018H
0A72 F583              MOV     DPH,A
0A74 E0                MOVX    A,@DPTR
0A75 FC                MOV     R4,A
0A76 A3                INC     DPTR
0A77 E0                MOVX    A,@DPTR
0A78 FD                MOV     R5,A
0A79 A3                INC     DPTR
0A7A E0                MOVX    A,@DPTR
0A7B FE                MOV     R6,A
0A7C A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 58  

0A7D E0                MOVX    A,@DPTR
0A7E C3                CLR     C
0A7F 9B                SUBB    A,R3
0A80 FF                MOV     R7,A
0A81 EE                MOV     A,R6
0A82 9A                SUBB    A,R2
0A83 FE                MOV     R6,A
0A84 ED                MOV     A,R5
0A85 99                SUBB    A,R1
0A86 FD                MOV     R5,A
0A87 EC                MOV     A,R4
0A88 98                SUBB    A,R0
0A89 FC                MOV     R4,A
0A8A AB00        R     MOV     R3,k_d_c_dl+03H
0A8C AA00        R     MOV     R2,k_d_c_dl+02H
0A8E A900        R     MOV     R1,k_d_c_dl+01H
0A90 A800        R     MOV     R0,k_d_c_dl
0A92 120000      E     LCALL   ?C?LMUL
0A95 7810              MOV     R0,#010H
0A97 120000      E     LCALL   ?C?SLSHR
0A9A E500        R     MOV     A,pwm_input+03H
0A9C 2F                ADD     A,R7
0A9D F500        R     MOV     pwm_input+03H,A
0A9F E500        R     MOV     A,pwm_input+02H
0AA1 3E                ADDC    A,R6
0AA2 F500        R     MOV     pwm_input+02H,A
0AA4 E500        R     MOV     A,pwm_input+01H
0AA6 3D                ADDC    A,R5
0AA7 F500        R     MOV     pwm_input+01H,A
0AA9 E500        R     MOV     A,pwm_input
0AAB 3C                ADDC    A,R4
0AAC F500        R     MOV     pwm_input,A
0AAE         ?C0097:
                                           ; SOURCE LINE # 584
0AAE 300005            JNB     interrupt_flag,?C0098
                                           ; SOURCE LINE # 585
0AB1 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 586
0AB3 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 587
0AB6         ?C0098:
                                           ; SOURCE LINE # 590
0AB6 E500        R     MOV     A,index
0AB8 701A              JNZ     ?C0099
                                           ; SOURCE LINE # 591
0ABA FF                MOV     R7,A
0ABB FE                MOV     R6,A
0ABC FD                MOV     R5,A
0ABD FC                MOV     R4,A
0ABE AB00        R     MOV     R3,pwm_input+03H
0AC0 AA00        R     MOV     R2,pwm_input+02H
0AC2 A900        R     MOV     R1,pwm_input+01H
0AC4 A800        R     MOV     R0,pwm_input
0AC6 C3                CLR     C
0AC7 120000      E     LCALL   ?C?SLCMP
0ACA 4004              JC      ?C0100
                                           ; SOURCE LINE # 592
0ACC D200        R     SETB    dirM0
0ACE 801D              SJMP    ?C0102
0AD0         ?C0100:
                                           ; SOURCE LINE # 595
0AD0 C200        R     CLR     dirM0
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 59  

                                           ; SOURCE LINE # 597
0AD2 8019              SJMP    ?C0102
0AD4         ?C0099:
                                           ; SOURCE LINE # 598
                                           ; SOURCE LINE # 599
0AD4 E4                CLR     A
0AD5 FF                MOV     R7,A
0AD6 FE                MOV     R6,A
0AD7 FD                MOV     R5,A
0AD8 FC                MOV     R4,A
0AD9 AB00        R     MOV     R3,pwm_input+03H
0ADB AA00        R     MOV     R2,pwm_input+02H
0ADD A900        R     MOV     R1,pwm_input+01H
0ADF A800        R     MOV     R0,pwm_input
0AE1 C3                CLR     C
0AE2 120000      E     LCALL   ?C?SLCMP
0AE5 4004              JC      ?C0103
                                           ; SOURCE LINE # 600
0AE7 D200        R     SETB    dirM1
0AE9 8002              SJMP    ?C0102
0AEB         ?C0103:
                                           ; SOURCE LINE # 603
0AEB C200        R     CLR     dirM1
                                           ; SOURCE LINE # 605
0AED         ?C0102:
                                           ; SOURCE LINE # 607
0AED 300005            JNB     interrupt_flag,?C0105
                                           ; SOURCE LINE # 608
0AF0 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 609
0AF2 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 610
0AF5         ?C0105:
                                           ; SOURCE LINE # 613
0AF5 74FF              MOV     A,#0FFH
0AF7 7F9C              MOV     R7,#09CH
0AF9 FE                MOV     R6,A
0AFA FD                MOV     R5,A
0AFB FC                MOV     R4,A
0AFC AB00        R     MOV     R3,pwm_input+03H
0AFE AA00        R     MOV     R2,pwm_input+02H
0B00 A900        R     MOV     R1,pwm_input+01H
0B02 A800        R     MOV     R0,pwm_input
0B04 C3                CLR     C
0B05 120000      E     LCALL   ?C?SLCMP
0B08 500E              JNC     ?C0106
                                           ; SOURCE LINE # 614
0B0A 74FF              MOV     A,#0FFH
0B0C 75009C      R     MOV     pwm_input+03H,#09CH
0B0F F500        R     MOV     pwm_input+02H,A
0B11 F500        R     MOV     pwm_input+01H,A
0B13 F500        R     MOV     pwm_input,A
0B15 020000      R     LJMP    ?C0049
0B18         ?C0106:
                                           ; SOURCE LINE # 615
                                           ; SOURCE LINE # 616
0B18 E4                CLR     A
0B19 7F64              MOV     R7,#064H
0B1B FE                MOV     R6,A
0B1C FD                MOV     R5,A
0B1D FC                MOV     R4,A
0B1E AB00        R     MOV     R3,pwm_input+03H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 60  

0B20 AA00        R     MOV     R2,pwm_input+02H
0B22 A900        R     MOV     R1,pwm_input+01H
0B24 A800        R     MOV     R0,pwm_input
0B26 D3                SETB    C
0B27 120000      E     LCALL   ?C?SLCMP
0B2A 5003              JNC     $ + 5H
0B2C 020000      R     LJMP    ?C0049
                                           ; SOURCE LINE # 617
0B2F E4                CLR     A
0B30 750064      R     MOV     pwm_input+03H,#064H
0B33 F500        R     MOV     pwm_input+02H,A
0B35 F500        R     MOV     pwm_input+01H,A
0B37 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 618
                                           ; SOURCE LINE # 620
0B39 020000      R     LJMP    ?C0049
                                           ; SOURCE LINE # 622
0B3C         ?C0109:
                                           ; SOURCE LINE # 624
0B3C 900000      E     MOV     DPTR,#g_ref+018H
0B3F E0                MOVX    A,@DPTR
0B40 7003              JNZ     $ + 5H
0B42 020000      R     LJMP    ?C0049
0B45 200003      E     JB      tension_valid,$ + 6H
0B48 020000      R     LJMP    ?C0049
                                           ; SOURCE LINE # 627
0B4B E500        R     MOV     A,index
0B4D 25E0              ADD     A,ACC
0B4F 25E0              ADD     A,ACC
0B51 2400        E     ADD     A,#LOW g_ref+08H
0B53 F582              MOV     DPL,A
0B55 E4                CLR     A
0B56 3400        E     ADDC    A,#HIGH g_ref+08H
0B58 F583              MOV     DPH,A
0B5A E0                MOVX    A,@DPTR
0B5B FC                MOV     R4,A
0B5C A3                INC     DPTR
0B5D E0                MOVX    A,@DPTR
0B5E FD                MOV     R5,A
0B5F A3                INC     DPTR
0B60 E0                MOVX    A,@DPTR
0B61 FE                MOV     R6,A
0B62 A3                INC     DPTR
0B63 E0                MOVX    A,@DPTR
0B64 F500        R     MOV     curr_ref+03H,A
0B66 8E00        R     MOV     curr_ref+02H,R6
0B68 8D00        R     MOV     curr_ref+01H,R5
0B6A 8C00        R     MOV     curr_ref,R4
                                           ; SOURCE LINE # 630
0B6C 900000      E     MOV     DPTR,#c_mem+032H
0B6F E0                MOVX    A,@DPTR
0B70 FE                MOV     R6,A
0B71 A3                INC     DPTR
0B72 E0                MOVX    A,@DPTR
0B73 FF                MOV     R7,A
0B74 EE                MOV     A,R6
0B75 33                RLC     A
0B76 95E0              SUBB    A,ACC
0B78 FD                MOV     R5,A
0B79 FC                MOV     R4,A
0B7A AB00        R     MOV     R3,curr_ref+03H
0B7C AA00        R     MOV     R2,curr_ref+02H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 61  

0B7E A900        R     MOV     R1,curr_ref+01H
0B80 A800        R     MOV     R0,curr_ref
0B82 D3                SETB    C
0B83 120000      E     LCALL   ?C?SLCMP
0B86 4016              JC      ?C0111
                                           ; SOURCE LINE # 631
0B88 900000      E     MOV     DPTR,#c_mem+032H
0B8B E0                MOVX    A,@DPTR
0B8C FE                MOV     R6,A
0B8D A3                INC     DPTR
0B8E E0                MOVX    A,@DPTR
0B8F FF                MOV     R7,A
0B90 EE                MOV     A,R6
0B91 33                RLC     A
0B92 95E0              SUBB    A,ACC
0B94 8F00        R     MOV     curr_ref+03H,R7
0B96 8E00        R     MOV     curr_ref+02H,R6
0B98 F500        R     MOV     curr_ref+01H,A
0B9A F500        R     MOV     curr_ref,A
                                           ; SOURCE LINE # 632
0B9C 803C              SJMP    ?C0112
0B9E         ?C0111:
                                           ; SOURCE LINE # 633
                                           ; SOURCE LINE # 634
0B9E 900000      E     MOV     DPTR,#c_mem+032H
0BA1 E0                MOVX    A,@DPTR
0BA2 FE                MOV     R6,A
0BA3 A3                INC     DPTR
0BA4 E0                MOVX    A,@DPTR
0BA5 FF                MOV     R7,A
0BA6 C3                CLR     C
0BA7 E4                CLR     A
0BA8 9F                SUBB    A,R7
0BA9 FF                MOV     R7,A
0BAA E4                CLR     A
0BAB 9E                SUBB    A,R6
0BAC FE                MOV     R6,A
0BAD 33                RLC     A
0BAE 95E0              SUBB    A,ACC
0BB0 FD                MOV     R5,A
0BB1 FC                MOV     R4,A
0BB2 AB00        R     MOV     R3,curr_ref+03H
0BB4 AA00        R     MOV     R2,curr_ref+02H
0BB6 A900        R     MOV     R1,curr_ref+01H
0BB8 A800        R     MOV     R0,curr_ref
0BBA C3                CLR     C
0BBB 120000      E     LCALL   ?C?SLCMP
0BBE 501A              JNC     ?C0112
                                           ; SOURCE LINE # 635
0BC0 900000      E     MOV     DPTR,#c_mem+032H
0BC3 E0                MOVX    A,@DPTR
0BC4 FE                MOV     R6,A
0BC5 A3                INC     DPTR
0BC6 E0                MOVX    A,@DPTR
0BC7 FF                MOV     R7,A
0BC8 C3                CLR     C
0BC9 E4                CLR     A
0BCA 9F                SUBB    A,R7
0BCB FF                MOV     R7,A
0BCC E4                CLR     A
0BCD 9E                SUBB    A,R6
0BCE FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 62  

0BCF 33                RLC     A
0BD0 95E0              SUBB    A,ACC
0BD2 8F00        R     MOV     curr_ref+03H,R7
0BD4 8E00        R     MOV     curr_ref+02H,R6
0BD6 F500        R     MOV     curr_ref+01H,A
0BD8 F500        R     MOV     curr_ref,A
                                           ; SOURCE LINE # 636
0BDA         ?C0112:
                                           ; SOURCE LINE # 638
0BDA 300005            JNB     interrupt_flag,?C0114
                                           ; SOURCE LINE # 639
0BDD C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 640
0BDF 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 641
0BE2         ?C0114:
                                           ; SOURCE LINE # 644
0BE2 E500        R     MOV     A,index
0BE4 25E0              ADD     A,ACC
0BE6 25E0              ADD     A,ACC
0BE8 2400        E     ADD     A,#LOW g_meas+018H
0BEA F582              MOV     DPL,A
0BEC E4                CLR     A
0BED 3400        E     ADDC    A,#HIGH g_meas+018H
0BEF F583              MOV     DPH,A
0BF1 E0                MOVX    A,@DPTR
0BF2 F8                MOV     R0,A
0BF3 A3                INC     DPTR
0BF4 E0                MOVX    A,@DPTR
0BF5 F9                MOV     R1,A
0BF6 A3                INC     DPTR
0BF7 E0                MOVX    A,@DPTR
0BF8 FA                MOV     R2,A
0BF9 A3                INC     DPTR
0BFA E0                MOVX    A,@DPTR
0BFB FB                MOV     R3,A
0BFC C3                CLR     C
0BFD E500        R     MOV     A,curr_ref+03H
0BFF 9B                SUBB    A,R3
0C00 F500        R     MOV     curr_error+03H,A
0C02 E500        R     MOV     A,curr_ref+02H
0C04 9A                SUBB    A,R2
0C05 F500        R     MOV     curr_error+02H,A
0C07 E500        R     MOV     A,curr_ref+01H
0C09 99                SUBB    A,R1
0C0A F500        R     MOV     curr_error+01H,A
0C0C E500        R     MOV     A,curr_ref
0C0E 98                SUBB    A,R0
0C0F F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 647
0C11 E500        R     MOV     A,index
0C13 25E0              ADD     A,ACC
0C15 25E0              ADD     A,ACC
0C17 2400        R     ADD     A,#LOW curr_error_sum
0C19 F582              MOV     DPL,A
0C1B E4                CLR     A
0C1C 3400        R     ADDC    A,#HIGH curr_error_sum
0C1E F583              MOV     DPH,A
0C20 C083              PUSH    DPH
0C22 C082              PUSH    DPL
0C24 E0                MOVX    A,@DPTR
0C25 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 63  

0C26 A3                INC     DPTR
0C27 E0                MOVX    A,@DPTR
0C28 FD                MOV     R5,A
0C29 A3                INC     DPTR
0C2A E0                MOVX    A,@DPTR
0C2B FE                MOV     R6,A
0C2C A3                INC     DPTR
0C2D E0                MOVX    A,@DPTR
0C2E 2500        R     ADD     A,curr_error+03H
0C30 FF                MOV     R7,A
0C31 EE                MOV     A,R6
0C32 3500        R     ADDC    A,curr_error+02H
0C34 FE                MOV     R6,A
0C35 ED                MOV     A,R5
0C36 3500        R     ADDC    A,curr_error+01H
0C38 FD                MOV     R5,A
0C39 EC                MOV     A,R4
0C3A 3500        R     ADDC    A,curr_error
0C3C FC                MOV     R4,A
0C3D D082              POP     DPL
0C3F D083              POP     DPH
0C41 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 650
0C44 E500        R     MOV     A,index
0C46 25E0              ADD     A,ACC
0C48 25E0              ADD     A,ACC
0C4A 2400        R     ADD     A,#LOW curr_error_sum
0C4C F582              MOV     DPL,A
0C4E E4                CLR     A
0C4F 3400        R     ADDC    A,#HIGH curr_error_sum
0C51 F583              MOV     DPH,A
0C53 E0                MOVX    A,@DPTR
0C54 FC                MOV     R4,A
0C55 A3                INC     DPTR
0C56 E0                MOVX    A,@DPTR
0C57 FD                MOV     R5,A
0C58 A3                INC     DPTR
0C59 E0                MOVX    A,@DPTR
0C5A FE                MOV     R6,A
0C5B A3                INC     DPTR
0C5C E0                MOVX    A,@DPTR
0C5D FF                MOV     R7,A
0C5E 7BA0              MOV     R3,#0A0H
0C60 7A86              MOV     R2,#086H
0C62 7901              MOV     R1,#01H
0C64 7800              MOV     R0,#00H
0C66 C3                CLR     C
0C67 120000      E     LCALL   ?C?SLCMP
0C6A 501C              JNC     ?C0115
                                           ; SOURCE LINE # 651
0C6C 7FA0              MOV     R7,#0A0H
0C6E 7E86              MOV     R6,#086H
0C70 7D01              MOV     R5,#01H
0C72 7C00              MOV     R4,#00H
0C74 E500        R     MOV     A,index
0C76 25E0              ADD     A,ACC
0C78 25E0              ADD     A,ACC
0C7A 2400        R     ADD     A,#LOW curr_error_sum
0C7C F582              MOV     DPL,A
0C7E E4                CLR     A
0C7F 3400        R     ADDC    A,#HIGH curr_error_sum
0C81 F583              MOV     DPH,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 64  

0C83 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 652
0C86 8042              SJMP    ?C0116
0C88         ?C0115:
                                           ; SOURCE LINE # 653
                                           ; SOURCE LINE # 654
0C88 E500        R     MOV     A,index
0C8A 25E0              ADD     A,ACC
0C8C 25E0              ADD     A,ACC
0C8E 2400        R     ADD     A,#LOW curr_error_sum
0C90 F582              MOV     DPL,A
0C92 E4                CLR     A
0C93 3400        R     ADDC    A,#HIGH curr_error_sum
0C95 F583              MOV     DPH,A
0C97 E0                MOVX    A,@DPTR
0C98 FC                MOV     R4,A
0C99 A3                INC     DPTR
0C9A E0                MOVX    A,@DPTR
0C9B FD                MOV     R5,A
0C9C A3                INC     DPTR
0C9D E0                MOVX    A,@DPTR
0C9E FE                MOV     R6,A
0C9F A3                INC     DPTR
0CA0 E0                MOVX    A,@DPTR
0CA1 FF                MOV     R7,A
0CA2 7B60              MOV     R3,#060H
0CA4 7A79              MOV     R2,#079H
0CA6 79FE              MOV     R1,#0FEH
0CA8 78FF              MOV     R0,#0FFH
0CAA D3                SETB    C
0CAB 120000      E     LCALL   ?C?SLCMP
0CAE 401A              JC      ?C0116
                                           ; SOURCE LINE # 655
0CB0 7F60              MOV     R7,#060H
0CB2 7E79              MOV     R6,#079H
0CB4 7DFE              MOV     R5,#0FEH
0CB6 7CFF              MOV     R4,#0FFH
0CB8 E500        R     MOV     A,index
0CBA 25E0              ADD     A,ACC
0CBC 25E0              ADD     A,ACC
0CBE 2400        R     ADD     A,#LOW curr_error_sum
0CC0 F582              MOV     DPL,A
0CC2 E4                CLR     A
0CC3 3400        R     ADDC    A,#HIGH curr_error_sum
0CC5 F583              MOV     DPH,A
0CC7 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 656
0CCA         ?C0116:
                                           ; SOURCE LINE # 658
0CCA 300005            JNB     interrupt_flag,?C0118
                                           ; SOURCE LINE # 659
0CCD C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 660
0CCF 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 661
0CD2         ?C0118:
                                           ; SOURCE LINE # 664
0CD2 E4                CLR     A
0CD3 F500        R     MOV     pwm_input+03H,A
0CD5 F500        R     MOV     pwm_input+02H,A
0CD7 F500        R     MOV     pwm_input+01H,A
0CD9 F500        R     MOV     pwm_input,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 65  

                                           ; SOURCE LINE # 667
0CDB FF                MOV     R7,A
0CDC FE                MOV     R6,A
0CDD FD                MOV     R5,A
0CDE FC                MOV     R4,A
0CDF AB00        R     MOV     R3,k_p_c+03H
0CE1 AA00        R     MOV     R2,k_p_c+02H
0CE3 A900        R     MOV     R1,k_p_c+01H
0CE5 A800        R     MOV     R0,k_p_c
0CE7 C3                CLR     C
0CE8 120000      E     LCALL   ?C?SLCMP
0CEB 6026              JZ      ?C0119
                                           ; SOURCE LINE # 668
0CED AF00        R     MOV     R7,curr_error+03H
0CEF AE00        R     MOV     R6,curr_error+02H
0CF1 AD00        R     MOV     R5,curr_error+01H
0CF3 AC00        R     MOV     R4,curr_error
0CF5 A800        R     MOV     R0,k_p_c
0CF7 120000      E     LCALL   ?C?LMUL
0CFA 7810              MOV     R0,#010H
0CFC 120000      E     LCALL   ?C?SLSHR
0CFF E500        R     MOV     A,pwm_input+03H
0D01 2F                ADD     A,R7
0D02 F500        R     MOV     pwm_input+03H,A
0D04 E500        R     MOV     A,pwm_input+02H
0D06 3E                ADDC    A,R6
0D07 F500        R     MOV     pwm_input+02H,A
0D09 E500        R     MOV     A,pwm_input+01H
0D0B 3D                ADDC    A,R5
0D0C F500        R     MOV     pwm_input+01H,A
0D0E E500        R     MOV     A,pwm_input
0D10 3C                ADDC    A,R4
0D11 F500        R     MOV     pwm_input,A
0D13         ?C0119:
                                           ; SOURCE LINE # 671
0D13 E4                CLR     A
0D14 FF                MOV     R7,A
0D15 FE                MOV     R6,A
0D16 FD                MOV     R5,A
0D17 FC                MOV     R4,A
0D18 AB00        R     MOV     R3,k_i_c+03H
0D1A AA00        R     MOV     R2,k_i_c+02H
0D1C A900        R     MOV     R1,k_i_c+01H
0D1E A800        R     MOV     R0,k_i_c
0D20 C3                CLR     C
0D21 120000      E     LCALL   ?C?SLCMP
0D24 603D              JZ      ?C0120
                                           ; SOURCE LINE # 672
0D26 E500        R     MOV     A,index
0D28 25E0              ADD     A,ACC
0D2A 25E0              ADD     A,ACC
0D2C 2400        R     ADD     A,#LOW curr_error_sum
0D2E F582              MOV     DPL,A
0D30 E4                CLR     A
0D31 3400        R     ADDC    A,#HIGH curr_error_sum
0D33 F583              MOV     DPH,A
0D35 E0                MOVX    A,@DPTR
0D36 FC                MOV     R4,A
0D37 A3                INC     DPTR
0D38 E0                MOVX    A,@DPTR
0D39 FD                MOV     R5,A
0D3A A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 66  

0D3B E0                MOVX    A,@DPTR
0D3C FE                MOV     R6,A
0D3D A3                INC     DPTR
0D3E E0                MOVX    A,@DPTR
0D3F FF                MOV     R7,A
0D40 7806              MOV     R0,#06H
0D42 120000      E     LCALL   ?C?SLSHR
0D45 A800        R     MOV     R0,k_i_c
0D47 120000      E     LCALL   ?C?LMUL
0D4A 780A              MOV     R0,#0AH
0D4C 120000      E     LCALL   ?C?SLSHR
0D4F E500        R     MOV     A,pwm_input+03H
0D51 2F                ADD     A,R7
0D52 F500        R     MOV     pwm_input+03H,A
0D54 E500        R     MOV     A,pwm_input+02H
0D56 3E                ADDC    A,R6
0D57 F500        R     MOV     pwm_input+02H,A
0D59 E500        R     MOV     A,pwm_input+01H
0D5B 3D                ADDC    A,R5
0D5C F500        R     MOV     pwm_input+01H,A
0D5E E500        R     MOV     A,pwm_input
0D60 3C                ADDC    A,R4
0D61 F500        R     MOV     pwm_input,A
0D63         ?C0120:
                                           ; SOURCE LINE # 675
0D63 E4                CLR     A
0D64 FF                MOV     R7,A
0D65 FE                MOV     R6,A
0D66 FD                MOV     R5,A
0D67 FC                MOV     R4,A
0D68 AB00        R     MOV     R3,k_d_c+03H
0D6A AA00        R     MOV     R2,k_d_c+02H
0D6C A900        R     MOV     R1,k_d_c+01H
0D6E A800        R     MOV     R0,k_d_c
0D70 C3                CLR     C
0D71 120000      E     LCALL   ?C?SLCMP
0D74 604F              JZ      ?C0121
                                           ; SOURCE LINE # 676
0D76 E500        R     MOV     A,index
0D78 25E0              ADD     A,ACC
0D7A 25E0              ADD     A,ACC
0D7C 2400        R     ADD     A,#LOW prev_curr_err
0D7E F582              MOV     DPL,A
0D80 E4                CLR     A
0D81 3400        R     ADDC    A,#HIGH prev_curr_err
0D83 F583              MOV     DPH,A
0D85 E0                MOVX    A,@DPTR
0D86 F8                MOV     R0,A
0D87 A3                INC     DPTR
0D88 E0                MOVX    A,@DPTR
0D89 F9                MOV     R1,A
0D8A A3                INC     DPTR
0D8B E0                MOVX    A,@DPTR
0D8C FA                MOV     R2,A
0D8D A3                INC     DPTR
0D8E E0                MOVX    A,@DPTR
0D8F FB                MOV     R3,A
0D90 C3                CLR     C
0D91 E500        R     MOV     A,curr_error+03H
0D93 9B                SUBB    A,R3
0D94 FF                MOV     R7,A
0D95 E500        R     MOV     A,curr_error+02H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 67  

0D97 9A                SUBB    A,R2
0D98 FE                MOV     R6,A
0D99 E500        R     MOV     A,curr_error+01H
0D9B 99                SUBB    A,R1
0D9C FD                MOV     R5,A
0D9D E500        R     MOV     A,curr_error
0D9F 98                SUBB    A,R0
0DA0 FC                MOV     R4,A
0DA1 AB00        R     MOV     R3,k_d_c+03H
0DA3 AA00        R     MOV     R2,k_d_c+02H
0DA5 A900        R     MOV     R1,k_d_c+01H
0DA7 A800        R     MOV     R0,k_d_c
0DA9 120000      E     LCALL   ?C?LMUL
0DAC 7810              MOV     R0,#010H
0DAE 120000      E     LCALL   ?C?SLSHR
0DB1 E500        R     MOV     A,pwm_input+03H
0DB3 2F                ADD     A,R7
0DB4 F500        R     MOV     pwm_input+03H,A
0DB6 E500        R     MOV     A,pwm_input+02H
0DB8 3E                ADDC    A,R6
0DB9 F500        R     MOV     pwm_input+02H,A
0DBB E500        R     MOV     A,pwm_input+01H
0DBD 3D                ADDC    A,R5
0DBE F500        R     MOV     pwm_input+01H,A
0DC0 E500        R     MOV     A,pwm_input
0DC2 3C                ADDC    A,R4
0DC3 F500        R     MOV     pwm_input,A
0DC5         ?C0121:
                                           ; SOURCE LINE # 678
0DC5 300005            JNB     interrupt_flag,?C0122
                                           ; SOURCE LINE # 679
0DC8 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 680
0DCA 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 681
0DCD         ?C0122:
                                           ; SOURCE LINE # 684
0DCD AF00        R     MOV     R7,curr_error+03H
0DCF AE00        R     MOV     R6,curr_error+02H
0DD1 AD00        R     MOV     R5,curr_error+01H
0DD3 AC00        R     MOV     R4,curr_error
0DD5 E500        R     MOV     A,index
0DD7 25E0              ADD     A,ACC
0DD9 25E0              ADD     A,ACC
0DDB 2400        R     ADD     A,#LOW prev_curr_err
0DDD F582              MOV     DPL,A
0DDF E4                CLR     A
0DE0 3400        R     ADDC    A,#HIGH prev_curr_err
0DE2 F583              MOV     DPH,A
0DE4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 686
0DE7 E500        R     MOV     A,index
0DE9 701A              JNZ     ?C0123
                                           ; SOURCE LINE # 687
0DEB FF                MOV     R7,A
0DEC FE                MOV     R6,A
0DED FD                MOV     R5,A
0DEE FC                MOV     R4,A
0DEF AB00        R     MOV     R3,pwm_input+03H
0DF1 AA00        R     MOV     R2,pwm_input+02H
0DF3 A900        R     MOV     R1,pwm_input+01H
0DF5 A800        R     MOV     R0,pwm_input
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 68  

0DF7 C3                CLR     C
0DF8 120000      E     LCALL   ?C?SLCMP
0DFB 4004              JC      ?C0124
                                           ; SOURCE LINE # 688
0DFD D200        R     SETB    dirM0
0DFF 801D              SJMP    ?C0126
0E01         ?C0124:
                                           ; SOURCE LINE # 691
0E01 C200        R     CLR     dirM0
                                           ; SOURCE LINE # 693
0E03 8019              SJMP    ?C0126
0E05         ?C0123:
                                           ; SOURCE LINE # 694
                                           ; SOURCE LINE # 695
0E05 E4                CLR     A
0E06 FF                MOV     R7,A
0E07 FE                MOV     R6,A
0E08 FD                MOV     R5,A
0E09 FC                MOV     R4,A
0E0A AB00        R     MOV     R3,pwm_input+03H
0E0C AA00        R     MOV     R2,pwm_input+02H
0E0E A900        R     MOV     R1,pwm_input+01H
0E10 A800        R     MOV     R0,pwm_input
0E12 C3                CLR     C
0E13 120000      E     LCALL   ?C?SLCMP
0E16 4004              JC      ?C0127
                                           ; SOURCE LINE # 696
0E18 D200        R     SETB    dirM1
0E1A 8002              SJMP    ?C0126
0E1C         ?C0127:
                                           ; SOURCE LINE # 699
0E1C C200        R     CLR     dirM1
                                           ; SOURCE LINE # 701
0E1E         ?C0126:
                                           ; SOURCE LINE # 703
0E1E 30005F            JNB     interrupt_flag,?C0049
                                           ; SOURCE LINE # 704
0E21 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 705
0E23 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 706
                                           ; SOURCE LINE # 707
                                           ; SOURCE LINE # 709
0E26 8058              SJMP    ?C0049
                                           ; SOURCE LINE # 711
0E28         ?C0130:
                                           ; SOURCE LINE # 713
0E28 E500        R     MOV     A,index
0E2A 25E0              ADD     A,ACC
0E2C 25E0              ADD     A,ACC
0E2E 2400        E     ADD     A,#LOW g_ref+010H
0E30 F582              MOV     DPL,A
0E32 E4                CLR     A
0E33 3400        E     ADDC    A,#HIGH g_ref+010H
0E35 F583              MOV     DPH,A
0E37 E0                MOVX    A,@DPTR
0E38 FC                MOV     R4,A
0E39 A3                INC     DPTR
0E3A E0                MOVX    A,@DPTR
0E3B FD                MOV     R5,A
0E3C A3                INC     DPTR
0E3D E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 69  

0E3E FE                MOV     R6,A
0E3F A3                INC     DPTR
0E40 E0                MOVX    A,@DPTR
0E41 F500        R     MOV     pwm_input+03H,A
0E43 8E00        R     MOV     pwm_input+02H,R6
0E45 8D00        R     MOV     pwm_input+01H,R5
0E47 8C00        R     MOV     pwm_input,R4
                                           ; SOURCE LINE # 716
0E49 E500        R     MOV     A,index
0E4B 701A              JNZ     ?C0131
                                           ; SOURCE LINE # 717
0E4D FF                MOV     R7,A
0E4E FE                MOV     R6,A
0E4F FD                MOV     R5,A
0E50 FC                MOV     R4,A
0E51 AB00        R     MOV     R3,pwm_input+03H
0E53 AA00        R     MOV     R2,pwm_input+02H
0E55 A900        R     MOV     R1,pwm_input+01H
0E57 A800        R     MOV     R0,pwm_input
0E59 C3                CLR     C
0E5A 120000      E     LCALL   ?C?SLCMP
0E5D 4004              JC      ?C0132
                                           ; SOURCE LINE # 718
0E5F D200        R     SETB    dirM0
0E61 801D              SJMP    ?C0049
0E63         ?C0132:
                                           ; SOURCE LINE # 721
0E63 C200        R     CLR     dirM0
                                           ; SOURCE LINE # 723
0E65 8019              SJMP    ?C0049
0E67         ?C0131:
                                           ; SOURCE LINE # 724
                                           ; SOURCE LINE # 725
0E67 E4                CLR     A
0E68 FF                MOV     R7,A
0E69 FE                MOV     R6,A
0E6A FD                MOV     R5,A
0E6B FC                MOV     R4,A
0E6C AB00        R     MOV     R3,pwm_input+03H
0E6E AA00        R     MOV     R2,pwm_input+02H
0E70 A900        R     MOV     R1,pwm_input+01H
0E72 A800        R     MOV     R0,pwm_input
0E74 C3                CLR     C
0E75 120000      E     LCALL   ?C?SLCMP
0E78 4004              JC      ?C0135
                                           ; SOURCE LINE # 726
0E7A D200        R     SETB    dirM1
0E7C 8002              SJMP    ?C0049
0E7E         ?C0135:
                                           ; SOURCE LINE # 729
0E7E C200        R     CLR     dirM1
                                           ; SOURCE LINE # 731
                                           ; SOURCE LINE # 733
                                           ; SOURCE LINE # 734
                                           ; SOURCE LINE # 735
                                           ; SOURCE LINE # 736
0E80         ?C0049:
                                           ; SOURCE LINE # 738
0E80 300005            JNB     interrupt_flag,?C0138
                                           ; SOURCE LINE # 739
0E83 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 740
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 70  

0E85 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 741
0E88         ?C0138:
                                           ; SOURCE LINE # 744
0E88 E4                CLR     A
0E89 7F64              MOV     R7,#064H
0E8B FE                MOV     R6,A
0E8C FD                MOV     R5,A
0E8D FC                MOV     R4,A
0E8E AB00        R     MOV     R3,pwm_input+03H
0E90 AA00        R     MOV     R2,pwm_input+02H
0E92 A900        R     MOV     R1,pwm_input+01H
0E94 A800        R     MOV     R0,pwm_input
0E96 D3                SETB    C
0E97 120000      E     LCALL   ?C?SLCMP
0E9A 400A              JC      ?C0139
                                           ; SOURCE LINE # 745
0E9C E4                CLR     A
0E9D 750064      R     MOV     pwm_input+03H,#064H
0EA0 F500        R     MOV     pwm_input+02H,A
0EA2 F500        R     MOV     pwm_input+01H,A
0EA4 F500        R     MOV     pwm_input,A
0EA6         ?C0139:
                                           ; SOURCE LINE # 746
0EA6 74FF              MOV     A,#0FFH
0EA8 7F9C              MOV     R7,#09CH
0EAA FE                MOV     R6,A
0EAB FD                MOV     R5,A
0EAC FC                MOV     R4,A
0EAD AB00        R     MOV     R3,pwm_input+03H
0EAF AA00        R     MOV     R2,pwm_input+02H
0EB1 A900        R     MOV     R1,pwm_input+01H
0EB3 A800        R     MOV     R0,pwm_input
0EB5 C3                CLR     C
0EB6 120000      E     LCALL   ?C?SLCMP
0EB9 500B              JNC     ?C0140
                                           ; SOURCE LINE # 747
0EBB 74FF              MOV     A,#0FFH
0EBD 75009C      R     MOV     pwm_input+03H,#09CH
0EC0 F500        R     MOV     pwm_input+02H,A
0EC2 F500        R     MOV     pwm_input+01H,A
0EC4 F500        R     MOV     pwm_input,A
0EC6         ?C0140:
                                           ; SOURCE LINE # 749
0EC6 300005            JNB     interrupt_flag,?C0141
                                           ; SOURCE LINE # 750
0EC9 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 751
0ECB 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 752
0ECE         ?C0141:
                                           ; SOURCE LINE # 755
0ECE 900000      E     MOV     DPTR,#c_mem+036H
0ED1 E0                MOVX    A,@DPTR
0ED2 6401              XRL     A,#01H
0ED4 6037              JZ      ?C0142
                                           ; SOURCE LINE # 756
0ED6 AF00        R     MOV     R7,pwm_input+03H
0ED8 AE00        R     MOV     R6,pwm_input+02H
0EDA AD00        R     MOV     R5,pwm_input+01H
0EDC AC00        R     MOV     R4,pwm_input
0EDE 780A              MOV     R0,#0AH
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 71  

0EE0 120000      E     LCALL   ?C?LSHL
0EE3 E4                CLR     A
0EE4 7B64              MOV     R3,#064H
0EE6 FA                MOV     R2,A
0EE7 F9                MOV     R1,A
0EE8 F8                MOV     R0,A
0EE9 120000      E     LCALL   ?C?SLDIV
0EEC A804              MOV     R0,AR4
0EEE A905              MOV     R1,AR5
0EF0 AA06              MOV     R2,AR6
0EF2 AB07              MOV     R3,AR7
0EF4 900000      E     MOV     DPTR,#dev_pwm_limit
0EF7 E0                MOVX    A,@DPTR
0EF8 FF                MOV     R7,A
0EF9 E4                CLR     A
0EFA FC                MOV     R4,A
0EFB FD                MOV     R5,A
0EFC FE                MOV     R6,A
0EFD 120000      E     LCALL   ?C?LMUL
0F00 780A              MOV     R0,#0AH
0F02 120000      E     LCALL   ?C?SLSHR
0F05 8F00        R     MOV     pwm_input+03H,R7
0F07 8E00        R     MOV     pwm_input+02H,R6
0F09 8D00        R     MOV     pwm_input+01H,R5
0F0B 8C00        R     MOV     pwm_input,R4
0F0D         ?C0142:
                                           ; SOURCE LINE # 760
0F0D 300011            JNB     dirM0,?C0143
                                           ; SOURCE LINE # 761
0F10 300007            JNB     dirM1,?C0144
                                           ; SOURCE LINE # 762
0F13 7F03              MOV     R7,#03H
0F15 120000      E     LCALL   _MOTOR_DIR_Write
0F18 8016              SJMP    ?C0146
0F1A         ?C0144:
                                           ; SOURCE LINE # 764
0F1A 7F01              MOV     R7,#01H
0F1C 120000      E     LCALL   _MOTOR_DIR_Write
                                           ; SOURCE LINE # 765
0F1F 800F              SJMP    ?C0146
0F21         ?C0143:
                                           ; SOURCE LINE # 766
                                           ; SOURCE LINE # 767
0F21 300007            JNB     dirM1,?C0147
                                           ; SOURCE LINE # 768
0F24 7F02              MOV     R7,#02H
0F26 120000      E     LCALL   _MOTOR_DIR_Write
0F29 8005              SJMP    ?C0146
0F2B         ?C0147:
                                           ; SOURCE LINE # 770
0F2B E4                CLR     A
0F2C FF                MOV     R7,A
0F2D 120000      E     LCALL   _MOTOR_DIR_Write
                                           ; SOURCE LINE # 771
0F30         ?C0146:
                                           ; SOURCE LINE # 773
0F30 300005            JNB     interrupt_flag,?C0149
                                           ; SOURCE LINE # 774
0F33 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 775
0F35 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 776
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 72  

0F38         ?C0149:
                                           ; SOURCE LINE # 778
0F38 E500        R     MOV     A,index
0F3A 7029              JNZ     ?C0150
                                           ; SOURCE LINE # 779
0F3C FF                MOV     R7,A
0F3D FE                MOV     R6,A
0F3E FD                MOV     R5,A
0F3F FC                MOV     R4,A
0F40 AB00        R     MOV     R3,pwm_input+03H
0F42 AA00        R     MOV     R2,pwm_input+02H
0F44 A900        R     MOV     R1,pwm_input+01H
0F46 A800        R     MOV     R0,pwm_input
0F48 C3                CLR     C
0F49 120000      E     LCALL   ?C?SLCMP
0F4C 4004              JC      ?C0151
0F4E 7F01              MOV     R7,#01H
0F50 8002              SJMP    ?C0152
0F52         ?C0151:
0F52 7FFF              MOV     R7,#0FFH
0F54         ?C0152:
0F54 900000      E     MOV     DPTR,#pwm_sign
0F57 EF                MOV     A,R7
0F58 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 780
0F59 AE00        R     MOV     R6,pwm_input+02H
0F5B AF00        R     MOV     R7,pwm_input+03H
0F5D 120000      E     LCALL   _abs
0F60 120000      E     LCALL   _PWM_MOTORS_WriteCompare1
                                           ; SOURCE LINE # 781
0F63 8028              SJMP    ?C0153
0F65         ?C0150:
                                           ; SOURCE LINE # 782
                                           ; SOURCE LINE # 783
0F65 E4                CLR     A
0F66 FF                MOV     R7,A
0F67 FE                MOV     R6,A
0F68 FD                MOV     R5,A
0F69 FC                MOV     R4,A
0F6A AB00        R     MOV     R3,pwm_input+03H
0F6C AA00        R     MOV     R2,pwm_input+02H
0F6E A900        R     MOV     R1,pwm_input+01H
0F70 A800        R     MOV     R0,pwm_input
0F72 C3                CLR     C
0F73 120000      E     LCALL   ?C?SLCMP
0F76 4004              JC      ?C0154
0F78 7F01              MOV     R7,#01H
0F7A 8002              SJMP    ?C0155
0F7C         ?C0154:
0F7C 7FFF              MOV     R7,#0FFH
0F7E         ?C0155:
0F7E 900000      E     MOV     DPTR,#pwm_sign+01H
0F81 EF                MOV     A,R7
0F82 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 784
0F83 AE00        R     MOV     R6,pwm_input+02H
0F85 AF00        R     MOV     R7,pwm_input+03H
0F87 120000      E     LCALL   _abs
0F8A 120000      E     LCALL   _PWM_MOTORS_WriteCompare2
                                           ; SOURCE LINE # 785
0F8D         ?C0153:
                                           ; SOURCE LINE # 787
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 73  

0F8D 300005            JNB     interrupt_flag,?C0044
                                           ; SOURCE LINE # 788
0F90 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 789
0F92 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 790
                                           ; SOURCE LINE # 791
0F95         ?C0044:
0F95 22                RET     
             ; FUNCTION _motor_control (END)

             ; FUNCTION analog_read_end (BEGIN)
                                           ; SOURCE LINE # 797
0000         ?C0157:
                                           ; SOURCE LINE # 818
0000 120000      E     LCALL   ADC_STATUS_Read
0003 EF                MOV     A,R7
0004 700A              JNZ     ?C0158
                                           ; SOURCE LINE # 819
0006 3000F7            JNB     interrupt_flag,?C0157
                                           ; SOURCE LINE # 820
0009 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 821
000B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 822
                                           ; SOURCE LINE # 823
000E 80F0              SJMP    ?C0157
0010         ?C0158:
                                           ; SOURCE LINE # 826
0010 900000      E     MOV     DPTR,#ADC_buf+01H
0013 E0                MOVX    A,@DPTR
0014 249A              ADD     A,#09AH
0016 FF                MOV     R7,A
0017 900000      E     MOV     DPTR,#ADC_buf
001A E0                MOVX    A,@DPTR
001B 34F9              ADDC    A,#0F9H
001D FE                MOV     R6,A
001E 33                RLC     A
001F 95E0              SUBB    A,ACC
0021 FD                MOV     R5,A
0022 FC                MOV     R4,A
0023 E4                CLR     A
0024 7BA0              MOV     R3,#0A0H
0026 7A07              MOV     R2,#07H
0028 F9                MOV     R1,A
0029 F8                MOV     R0,A
002A 120000      E     LCALL   ?C?LMUL
002D 7807              MOV     R0,#07H
002F 120000      E     LCALL   ?C?SLSHR
0032 900000      E     MOV     DPTR,#dev_tension
0035 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 828
0038 300005            JNB     interrupt_flag,?C0160
                                           ; SOURCE LINE # 829
003B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 830
003D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 831
0040         ?C0160:
                                           ; SOURCE LINE # 835
0040 E4                CLR     A
0041 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 74  

0042 FE                MOV     R6,A
0043 FD                MOV     R5,A
0044 FC                MOV     R4,A
0045 900000      E     MOV     DPTR,#dev_tension
0048 E0                MOVX    A,@DPTR
0049 F8                MOV     R0,A
004A A3                INC     DPTR
004B E0                MOVX    A,@DPTR
004C F9                MOV     R1,A
004D A3                INC     DPTR
004E E0                MOVX    A,@DPTR
004F FA                MOV     R2,A
0050 A3                INC     DPTR
0051 E0                MOVX    A,@DPTR
0052 FB                MOV     R3,A
0053 D3                SETB    C
0054 120000      E     LCALL   ?C?SLCMP
0057 5003              JNC     $ + 5H
0059 020000      R     LJMP    ?C0161
                                           ; SOURCE LINE # 837
005C 7F01              MOV     R7,#01H
005E 120000      E     LCALL   _POWER_ON_LED_REG_Write
                                           ; SOURCE LINE # 840
0061 120000      R     LCALL   pwm_limit_search
                                           ; SOURCE LINE # 844
0064 300005            JNB     interrupt_flag,?C0162
                                           ; SOURCE LINE # 845
0067 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 846
0069 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 847
006C         ?C0162:
                                           ; SOURCE LINE # 850
006C 900000      E     MOV     DPTR,#ADC_buf+03H
006F E0                MOVX    A,@DPTR
0070 249A              ADD     A,#09AH
0072 FF                MOV     R7,A
0073 900000      E     MOV     DPTR,#ADC_buf+02H
0076 E0                MOVX    A,@DPTR
0077 34F9              ADDC    A,#0F9H
0079 FE                MOV     R6,A
007A 33                RLC     A
007B 95E0              SUBB    A,ACC
007D FD                MOV     R5,A
007E FC                MOV     R4,A
007F E4                CLR     A
0080 7BAB              MOV     R3,#0ABH
0082 7A64              MOV     R2,#064H
0084 F9                MOV     R1,A
0085 F8                MOV     R0,A
0086 120000      E     LCALL   ?C?LMUL
0089 780D              MOV     R0,#0DH
008B 120000      E     LCALL   ?C?SLSHR
008E A804              MOV     R0,AR4
0090 A905              MOV     R1,AR5
0092 AA06              MOV     R2,AR6
0094 AB07              MOV     R3,AR7
0096 900000      E     MOV     DPTR,#pwm_sign
0099 E0                MOVX    A,@DPTR
009A FF                MOV     R7,A
009B 33                RLC     A
009C 95E0              SUBB    A,ACC
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 75  

009E FE                MOV     R6,A
009F FD                MOV     R5,A
00A0 FC                MOV     R4,A
00A1 120000      E     LCALL   ?C?LMUL
00A4 120000      E     LCALL   _filter_i1
00A7 900000      E     MOV     DPTR,#g_meas+018H
00AA 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 854
00AD 300005            JNB     interrupt_flag,?C0163
                                           ; SOURCE LINE # 855
00B0 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 856
00B2 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 857
00B5         ?C0163:
                                           ; SOURCE LINE # 858
00B5 900000      E     MOV     DPTR,#ADC_buf+05H
00B8 E0                MOVX    A,@DPTR
00B9 249A              ADD     A,#09AH
00BB FF                MOV     R7,A
00BC 900000      E     MOV     DPTR,#ADC_buf+04H
00BF E0                MOVX    A,@DPTR
00C0 34F9              ADDC    A,#0F9H
00C2 FE                MOV     R6,A
00C3 33                RLC     A
00C4 95E0              SUBB    A,ACC
00C6 FD                MOV     R5,A
00C7 FC                MOV     R4,A
00C8 E4                CLR     A
00C9 7BAB              MOV     R3,#0ABH
00CB 7A64              MOV     R2,#064H
00CD F9                MOV     R1,A
00CE F8                MOV     R0,A
00CF 120000      E     LCALL   ?C?LMUL
00D2 780D              MOV     R0,#0DH
00D4 120000      E     LCALL   ?C?SLSHR
00D7 A804              MOV     R0,AR4
00D9 A905              MOV     R1,AR5
00DB AA06              MOV     R2,AR6
00DD AB07              MOV     R3,AR7
00DF 900000      E     MOV     DPTR,#pwm_sign+01H
00E2 E0                MOVX    A,@DPTR
00E3 FF                MOV     R7,A
00E4 33                RLC     A
00E5 95E0              SUBB    A,ACC
00E7 FE                MOV     R6,A
00E8 FD                MOV     R5,A
00E9 FC                MOV     R4,A
00EA 120000      E     LCALL   ?C?LMUL
00ED 120000      E     LCALL   _filter_i2
00F0 900000      E     MOV     DPTR,#g_meas+01CH
00F3 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 862
00F6 300005            JNB     interrupt_flag,?C0164
                                           ; SOURCE LINE # 863
00F9 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 864
00FB 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 865
00FE         ?C0164:
                                           ; SOURCE LINE # 866
00FE D200        E     SETB    tension_valid
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 76  

                                           ; SOURCE LINE # 867
0100 22                RET     
0101         ?C0161:
                                           ; SOURCE LINE # 868
                                           ; SOURCE LINE # 870
0101 E4                CLR     A
0102 FF                MOV     R7,A
0103 120000      E     LCALL   _POWER_ON_LED_REG_Write
                                           ; SOURCE LINE # 872
0106 E4                CLR     A
0107 FF                MOV     R7,A
0108 FE                MOV     R6,A
0109 FD                MOV     R5,A
010A FC                MOV     R4,A
010B 900000      E     MOV     DPTR,#g_meas+018H
010E 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 873
0111 E4                CLR     A
0112 FF                MOV     R7,A
0113 FE                MOV     R6,A
0114 FD                MOV     R5,A
0115 FC                MOV     R4,A
0116 900000      E     MOV     DPTR,#g_meas+01CH
0119 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 874
                                           ; SOURCE LINE # 875
011C         ?C0166:
011C 22                RET     
             ; FUNCTION analog_read_end (END)

             ; FUNCTION _encoder_reading (BEGIN)
                                           ; SOURCE LINE # 882
;---- Variable 'idx' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 883
                                           ; SOURCE LINE # 884
0000 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 902
0002 E500        R     MOV     A,index
0004 C3                CLR     C
0005 9406              SUBB    A,#06H
0007 4003              JC      $ + 5H
0009 020000      R     LJMP    ?C0168
000C         ?C0167:
                                           ; SOURCE LINE # 905
000C 300022            JNB     reset_last_value_flag,?C0169
                                           ; SOURCE LINE # 906
;---- Variable 'jj' assigned to Register 'R3' ----
000F 7B06              MOV     R3,#06H
0011         ?C0170:
0011 AF03              MOV     R7,AR3
0013 1B                DEC     R3
0014 EF                MOV     A,R7
0015 6018              JZ      ?C0171
                                           ; SOURCE LINE # 907
0017 E4                CLR     A
0018 FF                MOV     R7,A
0019 FE                MOV     R6,A
001A FD                MOV     R5,A
001B FC                MOV     R4,A
001C EB                MOV     A,R3
001D 25E0              ADD     A,ACC
001F 25E0              ADD     A,ACC
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 77  

0021 2400        R     ADD     A,#LOW last_value_encoder
0023 F582              MOV     DPL,A
0025 E4                CLR     A
0026 3400        R     ADDC    A,#HIGH last_value_encoder
0028 F583              MOV     DPH,A
002A 120000      E     LCALL   ?C?LSTXDATA
002D 80E2              SJMP    ?C0170
002F         ?C0171:
                                           ; SOURCE LINE # 908
002F C200        E     CLR     reset_last_value_flag
                                           ; SOURCE LINE # 909
0031         ?C0169:
                                           ; SOURCE LINE # 915
0031 E500        R     MOV     A,index
0033 14                DEC     A
0034 602B              JZ      ?C0174
0036 14                DEC     A
0037 6040              JZ      ?C0175
0039 14                DEC     A
003A 6055              JZ      ?C0176
003C 14                DEC     A
003D 606A              JZ      ?C0177
003F 14                DEC     A
0040 607F              JZ      ?C0178
0042 2405              ADD     A,#05H
0044 6003              JZ      $ + 5H
0046 020000      R     LJMP    ?C0172
                                           ; SOURCE LINE # 916
0049         ?C0173:
                                           ; SOURCE LINE # 917
0049 120000      E     LCALL   SHIFTREG_ENC_1_ReadData
004C 7801              MOV     R0,#01H
004E 120000      E     LCALL   ?C?ULSHR
0051 EF                MOV     A,R7
0052 EE                MOV     A,R6
0053 ED                MOV     A,R5
0054 5403              ANL     A,#03H
0056 FD                MOV     R5,A
0057 E4                CLR     A
0058 FC                MOV     R4,A
0059 900000      R     MOV     DPTR,#data_encoder
005C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 918
005F 8076              SJMP    ?C0172
                                           ; SOURCE LINE # 919
0061         ?C0174:
                                           ; SOURCE LINE # 920
0061 120000      E     LCALL   SHIFTREG_ENC_2_ReadData
0064 7801              MOV     R0,#01H
0066 120000      E     LCALL   ?C?ULSHR
0069 EF                MOV     A,R7
006A EE                MOV     A,R6
006B ED                MOV     A,R5
006C 5403              ANL     A,#03H
006E FD                MOV     R5,A
006F E4                CLR     A
0070 FC                MOV     R4,A
0071 900000      R     MOV     DPTR,#data_encoder
0074 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 921
0077 805E              SJMP    ?C0172
                                           ; SOURCE LINE # 922
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 78  

0079         ?C0175:
                                           ; SOURCE LINE # 923
0079 120000      E     LCALL   SHIFTREG_ENC_3_ReadData
007C 7801              MOV     R0,#01H
007E 120000      E     LCALL   ?C?ULSHR
0081 EF                MOV     A,R7
0082 EE                MOV     A,R6
0083 ED                MOV     A,R5
0084 5403              ANL     A,#03H
0086 FD                MOV     R5,A
0087 E4                CLR     A
0088 FC                MOV     R4,A
0089 900000      R     MOV     DPTR,#data_encoder
008C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 924
008F 8046              SJMP    ?C0172
                                           ; SOURCE LINE # 925
0091         ?C0176:
                                           ; SOURCE LINE # 926
0091 120000      E     LCALL   SHIFTREG_ENC_4_ReadData
0094 7801              MOV     R0,#01H
0096 120000      E     LCALL   ?C?ULSHR
0099 EF                MOV     A,R7
009A EE                MOV     A,R6
009B ED                MOV     A,R5
009C 5403              ANL     A,#03H
009E FD                MOV     R5,A
009F E4                CLR     A
00A0 FC                MOV     R4,A
00A1 900000      R     MOV     DPTR,#data_encoder
00A4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 927
00A7 802E              SJMP    ?C0172
                                           ; SOURCE LINE # 928
00A9         ?C0177:
                                           ; SOURCE LINE # 929
00A9 120000      E     LCALL   SHIFTREG_ENC_5_ReadData
00AC 7801              MOV     R0,#01H
00AE 120000      E     LCALL   ?C?ULSHR
00B1 EF                MOV     A,R7
00B2 EE                MOV     A,R6
00B3 ED                MOV     A,R5
00B4 5403              ANL     A,#03H
00B6 FD                MOV     R5,A
00B7 E4                CLR     A
00B8 FC                MOV     R4,A
00B9 900000      R     MOV     DPTR,#data_encoder
00BC 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 930
00BF 8016              SJMP    ?C0172
                                           ; SOURCE LINE # 931
00C1         ?C0178:
                                           ; SOURCE LINE # 932
00C1 120000      E     LCALL   SHIFTREG_ENC_6_ReadData
00C4 7801              MOV     R0,#01H
00C6 120000      E     LCALL   ?C?ULSHR
00C9 EF                MOV     A,R7
00CA EE                MOV     A,R6
00CB ED                MOV     A,R5
00CC 5403              ANL     A,#03H
00CE FD                MOV     R5,A
00CF E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 79  

00D0 FC                MOV     R4,A
00D1 900000      R     MOV     DPTR,#data_encoder
00D4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 933
                                           ; SOURCE LINE # 934
00D7         ?C0172:
                                           ; SOURCE LINE # 937
00D7 7B01              MOV     R3,#01H
00D9 7A00        R     MOV     R2,#HIGH data_encoder
00DB 7900        R     MOV     R1,#LOW data_encoder
00DD 120000      E     LCALL   _check_enc_data
00E0 4003              JC      $ + 5H
00E2 020000      R     LJMP    ?C0168
                                           ; SOURCE LINE # 939
00E5 900000      R     MOV     DPTR,#data_encoder
00E8 E0                MOVX    A,@DPTR
00E9 FC                MOV     R4,A
00EA A3                INC     DPTR
00EB E0                MOVX    A,@DPTR
00EC FD                MOV     R5,A
00ED A3                INC     DPTR
00EE E0                MOVX    A,@DPTR
00EF FE                MOV     R6,A
00F0 A3                INC     DPTR
00F1 E0                MOVX    A,@DPTR
00F2 54C0              ANL     A,#0C0H
00F4 FF                MOV     R7,A
00F5 EE                MOV     A,R6
00F6 ED                MOV     A,R5
00F7 5403              ANL     A,#03H
00F9 FD                MOV     R5,A
00FA E4                CLR     A
00FB 2F                ADD     A,R7
00FC FF                MOV     R7,A
00FD E4                CLR     A
00FE 3E                ADDC    A,R6
00FF FE                MOV     R6,A
0100 ED                MOV     A,R5
0101 34FE              ADDC    A,#0FEH
0103 FD                MOV     R5,A
0104 E4                CLR     A
0105 34FF              ADDC    A,#0FFH
0107 FC                MOV     R4,A
0108 7802              MOV     R0,#02H
010A 120000      E     LCALL   ?C?ULSHR
010D A3                INC     DPTR
010E 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 942
0111 E500        R     MOV     A,index
0113 25E0              ADD     A,ACC
0115 25E0              ADD     A,ACC
0117 2400        E     ADD     A,#LOW g_mem+03DH
0119 F582              MOV     DPL,A
011B E4                CLR     A
011C 3400        E     ADDC    A,#HIGH g_mem+03DH
011E F583              MOV     DPH,A
0120 E0                MOVX    A,@DPTR
0121 A3                INC     DPTR
0122 E0                MOVX    A,@DPTR
0123 A3                INC     DPTR
0124 E0                MOVX    A,@DPTR
0125 FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 80  

0126 A3                INC     DPTR
0127 E0                MOVX    A,@DPTR
0128 FB                MOV     R3,A
0129 AA06              MOV     R2,AR6
012B 900000      R     MOV     DPTR,#value_encoder
012E E0                MOVX    A,@DPTR
012F A3                INC     DPTR
0130 E0                MOVX    A,@DPTR
0131 A3                INC     DPTR
0132 E0                MOVX    A,@DPTR
0133 FE                MOV     R6,A
0134 A3                INC     DPTR
0135 E0                MOVX    A,@DPTR
0136 2B                ADD     A,R3
0137 FF                MOV     R7,A
0138 EE                MOV     A,R6
0139 3A                ADDC    A,R2
013A FE                MOV     R6,A
013B 33                RLC     A
013C 95E0              SUBB    A,ACC
013E FD                MOV     R5,A
013F FC                MOV     R4,A
0140 900000      R     MOV     DPTR,#value_encoder
0143 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 945
0146 300027            JNB     only_first_time,?C0180
                                           ; SOURCE LINE # 946
0149 900000      R     MOV     DPTR,#value_encoder
014C E0                MOVX    A,@DPTR
014D FC                MOV     R4,A
014E A3                INC     DPTR
014F E0                MOVX    A,@DPTR
0150 FD                MOV     R5,A
0151 A3                INC     DPTR
0152 E0                MOVX    A,@DPTR
0153 FE                MOV     R6,A
0154 A3                INC     DPTR
0155 E0                MOVX    A,@DPTR
0156 FF                MOV     R7,A
0157 E500        R     MOV     A,index
0159 25E0              ADD     A,ACC
015B 25E0              ADD     A,ACC
015D 2400        R     ADD     A,#LOW last_value_encoder
015F F582              MOV     DPL,A
0161 E4                CLR     A
0162 3400        R     ADDC    A,#HIGH last_value_encoder
0164 F583              MOV     DPH,A
0166 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 948
0169 E500        R     MOV     A,index
016B B40502            CJNE    A,#05H,?C0180
                                           ; SOURCE LINE # 949
016E C200        R     CLR     only_first_time
                                           ; SOURCE LINE # 950
0170         ?C0180:
                                           ; SOURCE LINE # 953
0170 E500        R     MOV     A,index
0172 25E0              ADD     A,ACC
0174 25E0              ADD     A,ACC
0176 2400        R     ADD     A,#LOW last_value_encoder
0178 F582              MOV     DPL,A
017A E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 81  

017B 3400        R     ADDC    A,#HIGH last_value_encoder
017D F583              MOV     DPH,A
017F E0                MOVX    A,@DPTR
0180 F8                MOV     R0,A
0181 A3                INC     DPTR
0182 E0                MOVX    A,@DPTR
0183 F9                MOV     R1,A
0184 A3                INC     DPTR
0185 E0                MOVX    A,@DPTR
0186 FA                MOV     R2,A
0187 A3                INC     DPTR
0188 E0                MOVX    A,@DPTR
0189 FB                MOV     R3,A
018A 900000      R     MOV     DPTR,#value_encoder
018D E0                MOVX    A,@DPTR
018E FC                MOV     R4,A
018F A3                INC     DPTR
0190 E0                MOVX    A,@DPTR
0191 FD                MOV     R5,A
0192 A3                INC     DPTR
0193 E0                MOVX    A,@DPTR
0194 FE                MOV     R6,A
0195 A3                INC     DPTR
0196 E0                MOVX    A,@DPTR
0197 C3                CLR     C
0198 9B                SUBB    A,R3
0199 FF                MOV     R7,A
019A EE                MOV     A,R6
019B 9A                SUBB    A,R2
019C FE                MOV     R6,A
019D ED                MOV     A,R5
019E 99                SUBB    A,R1
019F FD                MOV     R5,A
01A0 EC                MOV     A,R4
01A1 98                SUBB    A,R0
01A2 FC                MOV     R4,A
01A3 A3                INC     DPTR
01A4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 973
01A7 E4                CLR     A
01A8 FF                MOV     R7,A
01A9 7EC0              MOV     R6,#0C0H
01AB FD                MOV     R5,A
01AC FC                MOV     R4,A
01AD 900000      R     MOV     DPTR,#aux
01B0 E0                MOVX    A,@DPTR
01B1 F8                MOV     R0,A
01B2 A3                INC     DPTR
01B3 E0                MOVX    A,@DPTR
01B4 F9                MOV     R1,A
01B5 A3                INC     DPTR
01B6 E0                MOVX    A,@DPTR
01B7 FA                MOV     R2,A
01B8 A3                INC     DPTR
01B9 E0                MOVX    A,@DPTR
01BA FB                MOV     R3,A
01BB D3                SETB    C
01BC 120000      E     LCALL   ?C?SLCMP
01BF 4010              JC      ?C0182
                                           ; SOURCE LINE # 974
01C1 7400        E     MOV     A,#LOW g_meas+020H
01C3 2500        R     ADD     A,index
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 82  

01C5 F582              MOV     DPL,A
01C7 E4                CLR     A
01C8 3400        E     ADDC    A,#HIGH g_meas+020H
01CA F583              MOV     DPH,A
01CC E0                MOVX    A,@DPTR
01CD 14                DEC     A
01CE F0                MOVX    @DPTR,A
01CF 8068              SJMP    ?C0183
01D1         ?C0182:
                                           ; SOURCE LINE # 975
                                           ; SOURCE LINE # 976
01D1 7F00              MOV     R7,#00H
01D3 7E40              MOV     R6,#040H
01D5 7DFF              MOV     R5,#0FFH
01D7 7CFF              MOV     R4,#0FFH
01D9 900000      R     MOV     DPTR,#aux
01DC E0                MOVX    A,@DPTR
01DD F8                MOV     R0,A
01DE A3                INC     DPTR
01DF E0                MOVX    A,@DPTR
01E0 F9                MOV     R1,A
01E1 A3                INC     DPTR
01E2 E0                MOVX    A,@DPTR
01E3 FA                MOV     R2,A
01E4 A3                INC     DPTR
01E5 E0                MOVX    A,@DPTR
01E6 FB                MOV     R3,A
01E7 C3                CLR     C
01E8 120000      E     LCALL   ?C?SLCMP
01EB 5010              JNC     ?C0184
                                           ; SOURCE LINE # 977
01ED 7400        E     MOV     A,#LOW g_meas+020H
01EF 2500        R     ADD     A,index
01F1 F582              MOV     DPL,A
01F3 E4                CLR     A
01F4 3400        E     ADDC    A,#HIGH g_meas+020H
01F6 F583              MOV     DPH,A
01F8 E0                MOVX    A,@DPTR
01F9 04                INC     A
01FA F0                MOVX    @DPTR,A
01FB 803C              SJMP    ?C0183
01FD         ?C0184:
                                           ; SOURCE LINE # 978
                                           ; SOURCE LINE # 979
01FD 900000      R     MOV     DPTR,#aux
0200 E0                MOVX    A,@DPTR
0201 A3                INC     DPTR
0202 E0                MOVX    A,@DPTR
0203 A3                INC     DPTR
0204 E0                MOVX    A,@DPTR
0205 FE                MOV     R6,A
0206 A3                INC     DPTR
0207 E0                MOVX    A,@DPTR
0208 FF                MOV     R7,A
0209 120000      E     LCALL   _abs
020C D3                SETB    C
020D EF                MOV     A,R7
020E 9400              SUBB    A,#00H
0210 EE                MOV     A,R6
0211 6480              XRL     A,#080H
0213 94C0              SUBB    A,#0C0H
0215 4022              JC      ?C0183
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 83  

                                           ; SOURCE LINE # 980
0217 7400        R     MOV     A,#LOW error
0219 2500        R     ADD     A,index
021B F582              MOV     DPL,A
021D E4                CLR     A
021E 3400        R     ADDC    A,#HIGH error
0220 F583              MOV     DPH,A
0222 E0                MOVX    A,@DPTR
0223 04                INC     A
0224 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 981
0225 7400        R     MOV     A,#LOW error
0227 2500        R     ADD     A,index
0229 F582              MOV     DPL,A
022B E4                CLR     A
022C 3400        R     ADDC    A,#HIGH error
022E F583              MOV     DPH,A
0230 E0                MOVX    A,@DPTR
0231 C3                CLR     C
0232 940A              SUBB    A,#0AH
0234 5003              JNC     $ + 5H
0236 020000      R     LJMP    ?C0168
0239         ?C0187:
                                           ; SOURCE LINE # 984
                                           ; SOURCE LINE # 985
                                           ; SOURCE LINE # 986
0239         ?C0183:
                                           ; SOURCE LINE # 988
0239 7400        R     MOV     A,#LOW error
023B 2500        R     ADD     A,index
023D F582              MOV     DPL,A
023F E4                CLR     A
0240 3400        R     ADDC    A,#HIGH error
0242 F583              MOV     DPH,A
0244 E4                CLR     A
0245 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 990
0246 900000      R     MOV     DPTR,#value_encoder
0249 E0                MOVX    A,@DPTR
024A FC                MOV     R4,A
024B A3                INC     DPTR
024C E0                MOVX    A,@DPTR
024D FD                MOV     R5,A
024E A3                INC     DPTR
024F E0                MOVX    A,@DPTR
0250 FE                MOV     R6,A
0251 A3                INC     DPTR
0252 E0                MOVX    A,@DPTR
0253 FF                MOV     R7,A
0254 E500        R     MOV     A,index
0256 25E0              ADD     A,ACC
0258 25E0              ADD     A,ACC
025A 2400        R     ADD     A,#LOW last_value_encoder
025C F582              MOV     DPL,A
025E E4                CLR     A
025F 3400        R     ADDC    A,#HIGH last_value_encoder
0261 F583              MOV     DPH,A
0263 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 992
0266 900000      R     MOV     DPTR,#value_encoder
0269 E0                MOVX    A,@DPTR
026A F8                MOV     R0,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 84  

026B A3                INC     DPTR
026C E0                MOVX    A,@DPTR
026D F9                MOV     R1,A
026E A3                INC     DPTR
026F E0                MOVX    A,@DPTR
0270 FA                MOV     R2,A
0271 A3                INC     DPTR
0272 E0                MOVX    A,@DPTR
0273 FB                MOV     R3,A
0274 C000              PUSH    AR0
0276 7400        E     MOV     A,#LOW g_meas+020H
0278 2500        R     ADD     A,index
027A F582              MOV     DPL,A
027C E4                CLR     A
027D 3400        E     ADDC    A,#HIGH g_meas+020H
027F F583              MOV     DPH,A
0281 E0                MOVX    A,@DPTR
0282 FF                MOV     R7,A
0283 33                RLC     A
0284 95E0              SUBB    A,ACC
0286 FE                MOV     R6,A
0287 FD                MOV     R5,A
0288 FC                MOV     R4,A
0289 7810              MOV     R0,#010H
028B 120000      E     LCALL   ?C?LSHL
028E D000              POP     AR0
0290 EB                MOV     A,R3
0291 2F                ADD     A,R7
0292 FF                MOV     R7,A
0293 EA                MOV     A,R2
0294 3E                ADDC    A,R6
0295 FE                MOV     R6,A
0296 E9                MOV     A,R1
0297 3D                ADDC    A,R5
0298 FD                MOV     R5,A
0299 E8                MOV     A,R0
029A 3C                ADDC    A,R4
029B FC                MOV     R4,A
029C 900000      R     MOV     DPTR,#value_encoder
029F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 994
02A2 E500        R     MOV     A,index
02A4 25E0              ADD     A,ACC
02A6 25E0              ADD     A,ACC
02A8 2400        E     ADD     A,#LOW c_mem+055H
02AA F582              MOV     DPL,A
02AC E4                CLR     A
02AD 3400        E     ADDC    A,#HIGH c_mem+055H
02AF F583              MOV     DPH,A
02B1 E0                MOVX    A,@DPTR
02B2 FC                MOV     R4,A
02B3 A3                INC     DPTR
02B4 E0                MOVX    A,@DPTR
02B5 FD                MOV     R5,A
02B6 A3                INC     DPTR
02B7 E0                MOVX    A,@DPTR
02B8 FE                MOV     R6,A
02B9 A3                INC     DPTR
02BA E0                MOVX    A,@DPTR
02BB FF                MOV     R7,A
02BC E4                CLR     A
02BD FB                MOV     R3,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 85  

02BE FA                MOV     R2,A
02BF 7980              MOV     R1,#080H
02C1 783F              MOV     R0,#03FH
02C3 120000      E     LCALL   ?C?FPCMP3
02C6 6038              JZ      ?C0188
                                           ; SOURCE LINE # 995
02C8 900000      R     MOV     DPTR,#value_encoder
02CB E0                MOVX    A,@DPTR
02CC FC                MOV     R4,A
02CD A3                INC     DPTR
02CE E0                MOVX    A,@DPTR
02CF FD                MOV     R5,A
02D0 A3                INC     DPTR
02D1 E0                MOVX    A,@DPTR
02D2 FE                MOV     R6,A
02D3 A3                INC     DPTR
02D4 E0                MOVX    A,@DPTR
02D5 FF                MOV     R7,A
02D6 EC                MOV     A,R4
02D7 120000      E     LCALL   ?C?FCASTL
02DA E500        R     MOV     A,index
02DC 25E0              ADD     A,ACC
02DE 25E0              ADD     A,ACC
02E0 2400        E     ADD     A,#LOW c_mem+055H
02E2 F582              MOV     DPL,A
02E4 E4                CLR     A
02E5 3400        E     ADDC    A,#HIGH c_mem+055H
02E7 F583              MOV     DPH,A
02E9 E0                MOVX    A,@DPTR
02EA F8                MOV     R0,A
02EB A3                INC     DPTR
02EC E0                MOVX    A,@DPTR
02ED F9                MOV     R1,A
02EE A3                INC     DPTR
02EF E0                MOVX    A,@DPTR
02F0 FA                MOV     R2,A
02F1 A3                INC     DPTR
02F2 E0                MOVX    A,@DPTR
02F3 FB                MOV     R3,A
02F4 120000      E     LCALL   ?C?FPMUL
02F7 120000      E     LCALL   ?C?CASTF
02FA 900000      R     MOV     DPTR,#value_encoder
02FD 120000      E     LCALL   ?C?LSTXDATA
0300         ?C0188:
                                           ; SOURCE LINE # 997
0300 900000      R     MOV     DPTR,#value_encoder
0303 E0                MOVX    A,@DPTR
0304 FC                MOV     R4,A
0305 A3                INC     DPTR
0306 E0                MOVX    A,@DPTR
0307 FD                MOV     R5,A
0308 A3                INC     DPTR
0309 E0                MOVX    A,@DPTR
030A FE                MOV     R6,A
030B A3                INC     DPTR
030C E0                MOVX    A,@DPTR
030D FF                MOV     R7,A
030E E500        R     MOV     A,index
0310 25E0              ADD     A,ACC
0312 25E0              ADD     A,ACC
0314 2400        E     ADD     A,#LOW g_meas
0316 F582              MOV     DPL,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 86  

0318 E4                CLR     A
0319 3400        E     ADDC    A,#HIGH g_meas
031B F583              MOV     DPH,A
031D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 998
                                           ; SOURCE LINE # 1019
0320         ?C0168:
0320 22                RET     
             ; FUNCTION _encoder_reading (END)

             ; FUNCTION calibration (BEGIN)
                                           ; SOURCE LINE # 1026
                                           ; SOURCE LINE # 1027
                                           ; SOURCE LINE # 1034
0000 900000      E     MOV     DPTR,#calibration_flag
0003 E0                MOVX    A,@DPTR
0004 24FE              ADD     A,#0FEH
0006 7003              JNZ     $ + 5H
0008 020000      R     LJMP    ?C0194
000B 14                DEC     A
000C 7003              JNZ     $ + 5H
000E 020000      R     LJMP    ?C0199
0011 14                DEC     A
0012 6076              JZ      ?C0192
0014 14                DEC     A
0015 7003              JNZ     $ + 5H
0017 020000      R     LJMP    ?C0197
001A 2404              ADD     A,#04H
001C 6003              JZ      $ + 5H
001E 020000      R     LJMP    ?C0203
                                           ; SOURCE LINE # 1035
0021         ?C0190:
                                           ; SOURCE LINE # 1036
0021 120000      E     LCALL   ISR_RS485_RX_Disable
                                           ; SOURCE LINE # 1039
0024 900000      E     MOV     DPTR,#c_mem+02H
0027 E0                MOVX    A,@DPTR
0028 FC                MOV     R4,A
0029 A3                INC     DPTR
002A E0                MOVX    A,@DPTR
002B FD                MOV     R5,A
002C A3                INC     DPTR
002D E0                MOVX    A,@DPTR
002E FE                MOV     R6,A
002F A3                INC     DPTR
0030 E0                MOVX    A,@DPTR
0031 FF                MOV     R7,A
0032 900000      R     MOV     DPTR,#old_k_p
0035 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1040
0038 900000      E     MOV     DPTR,#c_mem+06H
003B E0                MOVX    A,@DPTR
003C FC                MOV     R4,A
003D A3                INC     DPTR
003E E0                MOVX    A,@DPTR
003F FD                MOV     R5,A
0040 A3                INC     DPTR
0041 E0                MOVX    A,@DPTR
0042 FE                MOV     R6,A
0043 A3                INC     DPTR
0044 E0                MOVX    A,@DPTR
0045 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 87  

0046 900000      R     MOV     DPTR,#old_k_i
0049 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1041
004C 900000      E     MOV     DPTR,#c_mem+0AH
004F E0                MOVX    A,@DPTR
0050 FC                MOV     R4,A
0051 A3                INC     DPTR
0052 E0                MOVX    A,@DPTR
0053 FD                MOV     R5,A
0054 A3                INC     DPTR
0055 E0                MOVX    A,@DPTR
0056 FE                MOV     R6,A
0057 A3                INC     DPTR
0058 E0                MOVX    A,@DPTR
0059 FF                MOV     R7,A
005A 900000      R     MOV     DPTR,#old_k_d
005D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1044
0060 E4                CLR     A
0061 FF                MOV     R7,A
0062 FE                MOV     R6,A
0063 FD                MOV     R5,A
0064 FC                MOV     R4,A
0065 900000      E     MOV     DPTR,#g_refNew
0068 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1045
006B E4                CLR     A
006C FF                MOV     R7,A
006D FE                MOV     R6,A
006E FD                MOV     R5,A
006F FC                MOV     R4,A
0070 900000      E     MOV     DPTR,#g_refNew+04H
0073 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1048
0076 900000      E     MOV     DPTR,#g_refNew+018H
0079 E0                MOVX    A,@DPTR
007A 5403              ANL     A,#03H
007C 7005              JNZ     ?C0191
                                           ; SOURCE LINE # 1049
007E 7F03              MOV     R7,#03H
0080 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1050
0083         ?C0191:
                                           ; SOURCE LINE # 1053
0083 900000      E     MOV     DPTR,#calibration_flag
0086 7404              MOV     A,#04H
0088 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1054
0089 22                RET     
                                           ; SOURCE LINE # 1056
008A         ?C0192:
                                           ; SOURCE LINE # 1057
008A 900000      R     MOV     DPTR,#pause_counter
008D E0                MOVX    A,@DPTR
008E 04                INC     A
008F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1059
0090 E0                MOVX    A,@DPTR
0091 640A              XRL     A,#0AH
0093 6003              JZ      $ + 5H
0095 020000      R     LJMP    ?C0203
                                           ; SOURCE LINE # 1060
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 88  

0098 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1063
0099 7F99              MOV     R7,#099H
009B 7E19              MOV     R6,#019H
009D FD                MOV     R5,A
009E FC                MOV     R4,A
009F 900000      E     MOV     DPTR,#c_mem+02H
00A2 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1064
00A5 E4                CLR     A
00A6 FF                MOV     R7,A
00A7 FE                MOV     R6,A
00A8 FD                MOV     R5,A
00A9 FC                MOV     R4,A
00AA 900000      E     MOV     DPTR,#c_mem+06H
00AD 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1065
00B0 E4                CLR     A
00B1 7FCC              MOV     R7,#0CCH
00B3 7E4C              MOV     R6,#04CH
00B5 FD                MOV     R5,A
00B6 FC                MOV     R4,A
00B7 900000      E     MOV     DPTR,#c_mem+0AH
00BA 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1067
00BD 900000      E     MOV     DPTR,#calibration_flag
00C0 7402              MOV     A,#02H
00C2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1068
                                           ; SOURCE LINE # 1069
00C3 22                RET     
                                           ; SOURCE LINE # 1071
00C4         ?C0194:
                                           ; SOURCE LINE # 1073
00C4 900000      E     MOV     DPTR,#g_refNew
00C7 E0                MOVX    A,@DPTR
00C8 FC                MOV     R4,A
00C9 A3                INC     DPTR
00CA E0                MOVX    A,@DPTR
00CB FD                MOV     R5,A
00CC A3                INC     DPTR
00CD E0                MOVX    A,@DPTR
00CE FE                MOV     R6,A
00CF A3                INC     DPTR
00D0 E0                MOVX    A,@DPTR
00D1 245B              ADD     A,#05BH
00D3 FF                MOV     R7,A
00D4 E4                CLR     A
00D5 3E                ADDC    A,R6
00D6 FE                MOV     R6,A
00D7 E4                CLR     A
00D8 3D                ADDC    A,R5
00D9 FD                MOV     R5,A
00DA E4                CLR     A
00DB 3C                ADDC    A,R4
00DC FC                MOV     R4,A
00DD 900000      E     MOV     DPTR,#g_refNew
00E0 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1074
00E3 900000      E     MOV     DPTR,#g_refNew+04H
00E6 E0                MOVX    A,@DPTR
00E7 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 89  

00E8 A3                INC     DPTR
00E9 E0                MOVX    A,@DPTR
00EA FD                MOV     R5,A
00EB A3                INC     DPTR
00EC E0                MOVX    A,@DPTR
00ED FE                MOV     R6,A
00EE A3                INC     DPTR
00EF E0                MOVX    A,@DPTR
00F0 C3                CLR     C
00F1 945B              SUBB    A,#05BH
00F3 FF                MOV     R7,A
00F4 EE                MOV     A,R6
00F5 9400              SUBB    A,#00H
00F7 FE                MOV     R6,A
00F8 ED                MOV     A,R5
00F9 9400              SUBB    A,#00H
00FB FD                MOV     R5,A
00FC EC                MOV     A,R4
00FD 9400              SUBB    A,#00H
00FF FC                MOV     R4,A
0100 900000      E     MOV     DPTR,#g_refNew+04H
0103 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1077
0106 E4                CLR     A
0107 7FE8              MOV     R7,#0E8H
0109 7E03              MOV     R6,#03H
010B FD                MOV     R5,A
010C FC                MOV     R4,A
010D 900000      E     MOV     DPTR,#g_meas+018H
0110 E0                MOVX    A,@DPTR
0111 F8                MOV     R0,A
0112 A3                INC     DPTR
0113 E0                MOVX    A,@DPTR
0114 F9                MOV     R1,A
0115 A3                INC     DPTR
0116 E0                MOVX    A,@DPTR
0117 FA                MOV     R2,A
0118 A3                INC     DPTR
0119 E0                MOVX    A,@DPTR
011A FB                MOV     R3,A
011B D3                SETB    C
011C 120000      E     LCALL   ?C?SLCMP
011F 501D              JNC     ?C0196
0121 E4                CLR     A
0122 7FE8              MOV     R7,#0E8H
0124 7E03              MOV     R6,#03H
0126 FD                MOV     R5,A
0127 FC                MOV     R4,A
0128 900000      E     MOV     DPTR,#g_meas+01CH
012B E0                MOVX    A,@DPTR
012C F8                MOV     R0,A
012D A3                INC     DPTR
012E E0                MOVX    A,@DPTR
012F F9                MOV     R1,A
0130 A3                INC     DPTR
0131 E0                MOVX    A,@DPTR
0132 FA                MOV     R2,A
0133 A3                INC     DPTR
0134 E0                MOVX    A,@DPTR
0135 FB                MOV     R3,A
0136 120000      E     LCALL   ?C?SLCMP
0139 5003              JNC     $ + 5H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 90  

013B 020000      R     LJMP    ?C0203
013E         ?C0196:
                                           ; SOURCE LINE # 1079
013E 900000      E     MOV     DPTR,#g_ref
0141 E0                MOVX    A,@DPTR
0142 A3                INC     DPTR
0143 E0                MOVX    A,@DPTR
0144 A3                INC     DPTR
0145 E0                MOVX    A,@DPTR
0146 FF                MOV     R7,A
0147 A3                INC     DPTR
0148 E0                MOVX    A,@DPTR
0149 900000      E     MOV     DPTR,#g_mem+07EH
014C CF                XCH     A,R7
014D F0                MOVX    @DPTR,A
014E A3                INC     DPTR
014F EF                MOV     A,R7
0150 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1082
0151 900000      R     MOV     DPTR,#old_k_p
0154 E0                MOVX    A,@DPTR
0155 FC                MOV     R4,A
0156 A3                INC     DPTR
0157 E0                MOVX    A,@DPTR
0158 FD                MOV     R5,A
0159 A3                INC     DPTR
015A E0                MOVX    A,@DPTR
015B FE                MOV     R6,A
015C A3                INC     DPTR
015D E0                MOVX    A,@DPTR
015E FF                MOV     R7,A
015F 900000      E     MOV     DPTR,#c_mem+02H
0162 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1083
0165 900000      R     MOV     DPTR,#old_k_i
0168 E0                MOVX    A,@DPTR
0169 FC                MOV     R4,A
016A A3                INC     DPTR
016B E0                MOVX    A,@DPTR
016C FD                MOV     R5,A
016D A3                INC     DPTR
016E E0                MOVX    A,@DPTR
016F FE                MOV     R6,A
0170 A3                INC     DPTR
0171 E0                MOVX    A,@DPTR
0172 FF                MOV     R7,A
0173 900000      E     MOV     DPTR,#c_mem+06H
0176 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1084
0179 900000      R     MOV     DPTR,#old_k_d
017C E0                MOVX    A,@DPTR
017D FC                MOV     R4,A
017E A3                INC     DPTR
017F E0                MOVX    A,@DPTR
0180 FD                MOV     R5,A
0181 A3                INC     DPTR
0182 E0                MOVX    A,@DPTR
0183 FE                MOV     R6,A
0184 A3                INC     DPTR
0185 E0                MOVX    A,@DPTR
0186 FF                MOV     R7,A
0187 900000      E     MOV     DPTR,#c_mem+0AH
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 91  

018A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1087
018D E4                CLR     A
018E FF                MOV     R7,A
018F FE                MOV     R6,A
0190 FD                MOV     R5,A
0191 FC                MOV     R4,A
0192 900000      E     MOV     DPTR,#g_refNew
0195 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1088
0198 E4                CLR     A
0199 FF                MOV     R7,A
019A FE                MOV     R6,A
019B FD                MOV     R5,A
019C FC                MOV     R4,A
019D 900000      E     MOV     DPTR,#g_refNew+04H
01A0 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1091
01A3 900000      E     MOV     DPTR,#calibration_flag
01A6 7405              MOV     A,#05H
01A8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1092
                                           ; SOURCE LINE # 1093
01A9 22                RET     
                                           ; SOURCE LINE # 1095
01AA         ?C0197:
                                           ; SOURCE LINE # 1096
01AA 900000      R     MOV     DPTR,#pause_counter
01AD E0                MOVX    A,@DPTR
01AE 04                INC     A
01AF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1098
01B0 E0                MOVX    A,@DPTR
01B1 640A              XRL     A,#0AH
01B3 7029              JNZ     ?C0203
                                           ; SOURCE LINE # 1099
01B5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1101
01B6 900000      E     MOV     DPTR,#calibration_flag
01B9 7403              MOV     A,#03H
01BB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1102
                                           ; SOURCE LINE # 1103
01BC 22                RET     
                                           ; SOURCE LINE # 1105
01BD         ?C0199:
                                           ; SOURCE LINE # 1107
01BD 900000      E     MOV     DPTR,#g_refNew+018H
01C0 E0                MOVX    A,@DPTR
01C1 5403              ANL     A,#03H
01C3 7004              JNZ     ?C0200
                                           ; SOURCE LINE # 1108
01C5 FF                MOV     R7,A
01C6 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1109
01C9         ?C0200:
                                           ; SOURCE LINE # 1112
01C9 7F08              MOV     R7,#08H
01CB 7E00              MOV     R6,#00H
01CD 120000      E     LCALL   _memStore
                                           ; SOURCE LINE # 1113
01D0 E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/22/2017 09:03:56 PAGE 92  

01D1 FF                MOV     R7,A
01D2 FE                MOV     R6,A
01D3 120000      E     LCALL   _memStore
                                           ; SOURCE LINE # 1115
01D6 E4                CLR     A
01D7 900000      E     MOV     DPTR,#calibration_flag
01DA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1117
01DB 120000      E     LCALL   ISR_RS485_RX_Enable
                                           ; SOURCE LINE # 1118
                                           ; SOURCE LINE # 1120
                                           ; SOURCE LINE # 1121
                                           ; SOURCE LINE # 1122
                                           ; SOURCE LINE # 1123
                                           ; SOURCE LINE # 1124
01DE         ?C0203:
01DE 22                RET     
             ; FUNCTION calibration (END)

             ; FUNCTION pwm_limit_search (BEGIN)
                                           ; SOURCE LINE # 1132
                                           ; SOURCE LINE # 1133
0000 900000      E     MOV     DPTR,#dev_pwm_limit
0003 7464              MOV     A,#064H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1134
0006 22                RET     
             ; FUNCTION pwm_limit_search (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   6136    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =    197      12
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      6      76
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3       1
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
